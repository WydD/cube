<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
    <title>Simple WCA-Approved Scrambler</title>
    <meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
    <script type="text/javascript">var Prototype={Version:"1.6.0.3",Browser:{IE:!!(window.attachEvent&&navigator.userAgent.indexOf("Opera")===-1),Opera:navigator.userAgent.indexOf("Opera")>-1,WebKit:navigator.userAgent.indexOf("AppleWebKit/")>-1,Gecko:navigator.userAgent.indexOf("Gecko")>-1&&navigator.userAgent.indexOf("KHTML")===-1,MobileSafari:!!navigator.userAgent.match(/Apple.*Mobile.*Safari/)},BrowserFeatures:{XPath:!!document.evaluate,SelectorsAPI:!!document.querySelector,ElementExtensions:!!window.HTMLElement,SpecificElementExtensions:document.createElement("div")["__proto__"]&&document.createElement("div")["__proto__"]!==document.createElement("form")["__proto__"]},ScriptFragment:"<script[^>]*>([\\S\\s]*?)<\/script>",JSONFilter:/^\/\*-secure-([\s\S]*)\*\/\s*$/,emptyFunction:function(){},K:function(B){return B;}};if(Prototype.Browser.MobileSafari){Prototype.BrowserFeatures.SpecificElementExtensions=false;}var Class={create:function(){var G=null,H=$A(arguments);if(Object.isFunction(H[0])){G=H.shift();}function F(){this.initialize.apply(this,arguments);}Object.extend(F,Class.Methods);F.superclass=G;F.subclasses=[];if(G){var J=function(){};J.prototype=G.prototype;F.prototype=new J;G.subclasses.push(F);}for(var I=0;I<H.length;I++){F.addMethods(H[I]);}if(!F.prototype.initialize){F.prototype.initialize=Prototype.emptyFunction;}F.prototype.constructor=F;return F;}};Class.Methods={addMethods:function(K){var O=this.superclass&&this.superclass.prototype;var P=Object.keys(K);if(!Object.keys({toString:true}).length){P.push("toString","valueOf");}for(var I=0,N=P.length;I<N;I++){var L=P[I],M=K[L];if(O&&Object.isFunction(M)&&M.argumentNames().first()=="$super"){var J=M;M=(function(A){return function(){return O[A].apply(this,arguments);};})(L).wrap(J);M.valueOf=J.valueOf.bind(J);M.toString=J.toString.bind(J);}this.prototype[L]=M;}return this;}};var Abstract={};Object.extend=function(D,E){for(var F in E){D[F]=E[F];}return D;};Object.extend(Object,{inspect:function(C){try{if(Object.isUndefined(C)){return"undefined";}if(C===null){return"null";}return C.inspect?C.inspect():String(C);}catch(D){if(D instanceof RangeError){return"...";}throw D;}},toJSON:function(F){var I=typeof F;switch(I){case"undefined":case"function":case"unknown":return;case"boolean":return F.toString();}if(F===null){return"null";}if(F.toJSON){return F.toJSON();}if(Object.isElement(F)){return;}var J=[];for(var G in F){var H=Object.toJSON(F[G]);if(!Object.isUndefined(H)){J.push(G.toJSON()+": "+H);}}return"{"+J.join(", ")+"}";},toQueryString:function(B){return $H(B).toQueryString();},toHTML:function(B){return B&&B.toHTML?B.toHTML():String.interpret(B);},keys:function(D){var F=[];for(var E in D){F.push(E);}return F;},values:function(F){var D=[];for(var E in F){D.push(F[E]);}return D;},clone:function(B){return Object.extend({},B);},isElement:function(B){return !!(B&&B.nodeType==1);},isArray:function(B){return B!=null&&typeof B=="object"&&"splice" in B&&"join" in B;},isHash:function(B){return B instanceof Hash;},isFunction:function(B){return typeof B=="function";},isString:function(B){return typeof B=="string";},isNumber:function(B){return typeof B=="number";},isUndefined:function(B){return typeof B=="undefined";}});Object.extend(Function.prototype,{argumentNames:function(){var B=this.toString().match(/^[\s\(]*function[^(]*\(([^\)]*)\)/)[1].replace(/\s+/g,"").split(",");return B.length==1&&!B[0]?[]:B;},bind:function(){if(arguments.length<2&&Object.isUndefined(arguments[0])){return this;}var D=this,E=$A(arguments),F=E.shift();return function(){return D.apply(F,E.concat($A(arguments)));};},bindAsEventListener:function(){var D=this,E=$A(arguments),F=E.shift();return function(A){return D.apply(F,[A||window.event].concat(E));};},curry:function(){if(!arguments.length){return this;}var C=this,D=$A(arguments);return function(){return C.apply(this,D.concat($A(arguments)));};},delay:function(){var D=this,F=$A(arguments),E=F.shift()*1000;return window.setTimeout(function(){return D.apply(D,F);},E);},defer:function(){var B=[0.01].concat($A(arguments));return this.delay.apply(this,B);},wrap:function(D){var C=this;return function(){return D.apply(this,[C.bind(this)].concat($A(arguments)));};},methodize:function(){if(this._methodized){return this._methodized;}var B=this;return this._methodized=function(){return B.apply(null,[this].concat($A(arguments)));};}});Date.prototype.toJSON=function(){return'"'+this.getUTCFullYear()+"-"+(this.getUTCMonth()+1).toPaddedString(2)+"-"+this.getUTCDate().toPaddedString(2)+"T"+this.getUTCHours().toPaddedString(2)+":"+this.getUTCMinutes().toPaddedString(2)+":"+this.getUTCSeconds().toPaddedString(2)+'Z"';};var Try={these:function(){var I;for(var J=0,H=arguments.length;J<H;J++){var F=arguments[J];try{I=F();break;}catch(G){}}return I;}};RegExp.prototype.match=RegExp.prototype.test;RegExp.escape=function(B){return String(B).replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1");};var PeriodicalExecuter=Class.create({initialize:function(D,C){this.callback=D;this.frequency=C;this.currentlyExecuting=false;this.registerCallback();},registerCallback:function(){this.timer=setInterval(this.onTimerEvent.bind(this),this.frequency*1000);},execute:function(){this.callback(this);},stop:function(){if(!this.timer){return;}clearInterval(this.timer);this.timer=null;},onTimerEvent:function(){if(!this.currentlyExecuting){try{this.currentlyExecuting=true;this.execute();}finally{this.currentlyExecuting=false;}}}});Object.extend(String,{interpret:function(B){return B==null?"":String(B);},specialChar:{"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r","\\":"\\\\"}});Object.extend(String.prototype,{gsub:function(G,I){var F="",H=this,J;I=arguments.callee.prepareReplacement(I);while(H.length>0){if(J=H.match(G)){F+=H.slice(0,J.index);F+=String.interpret(I(J));H=H.slice(J.index+J[0].length);}else{F+=H,H="";}}return F;},sub:function(E,D,F){D=this.gsub.prepareReplacement(D);F=Object.isUndefined(F)?1:F;return this.gsub(E,function(A){if(--F<0){return A[0];}return D(A);});},scan:function(D,C){this.gsub(D,C);return String(this);},truncate:function(D,C){D=D||30;C=Object.isUndefined(C)?"...":C;return this.length>D?this.slice(0,D-C.length)+C:String(this);},strip:function(){return this.replace(/^\s+/,"").replace(/\s+$/,"");},stripTags:function(){return this.replace(/<\/?[^>]+>/gi,"");},stripScripts:function(){return this.replace(new RegExp(Prototype.ScriptFragment,"img"),"");},extractScripts:function(){var D=new RegExp(Prototype.ScriptFragment,"img");var C=new RegExp(Prototype.ScriptFragment,"im");return(this.match(D)||[]).map(function(A){return(A.match(C)||["",""])[1];});},evalScripts:function(){return this.extractScripts().map(function(script){return eval(script);});},escapeHTML:function(){var B=arguments.callee;B.text.data=this;return B.div.innerHTML;},unescapeHTML:function(){var B=new Element("div");B.innerHTML=this.stripTags();return B.childNodes[0]?(B.childNodes.length>1?$A(B.childNodes).inject("",function(D,A){return D+A.nodeValue;}):B.childNodes[0].nodeValue):"";},toQueryParams:function(D){var C=this.strip().match(/([^?#]*)(#.*)?$/);if(!C){return{};}return C[1].split(D||"&").inject({},function(B,A){if((A=A.split("="))[0]){var H=decodeURIComponent(A.shift());var G=A.length>1?A.join("="):A[0];if(G!=undefined){G=decodeURIComponent(G);}if(H in B){if(!Object.isArray(B[H])){B[H]=[B[H]];}B[H].push(G);}else{B[H]=G;}}return B;});},toArray:function(){return this.split("");},succ:function(){return this.slice(0,this.length-1)+String.fromCharCode(this.charCodeAt(this.length-1)+1);},times:function(B){return B<1?"":new Array(B+1).join(this);},camelize:function(){var F=this.split("-"),E=F.length;if(E==1){return F[0];}var G=this.charAt(0)=="-"?F[0].charAt(0).toUpperCase()+F[0].substring(1):F[0];for(var H=1;H<E;H++){G+=F[H].charAt(0).toUpperCase()+F[H].substring(1);}return G;},capitalize:function(){return this.charAt(0).toUpperCase()+this.substring(1).toLowerCase();},underscore:function(){return this.gsub(/::/,"/").gsub(/([A-Z]+)([A-Z][a-z])/,"#{1}_#{2}").gsub(/([a-z\d])([A-Z])/,"#{1}_#{2}").gsub(/-/,"_").toLowerCase();},dasherize:function(){return this.gsub(/_/,"-");},inspect:function(D){var C=this.gsub(/[\x00-\x1f\\]/,function(B){var A=String.specialChar[B[0]];return A?A:"\\u00"+B[0].charCodeAt().toPaddedString(2,16);});if(D){return'"'+C.replace(/"/g,'\\"')+'"';}return"'"+C.replace(/'/g,"\\'")+"'";},toJSON:function(){return this.inspect(true);},unfilterJSON:function(B){return this.sub(B||Prototype.JSONFilter,"#{1}");},isJSON:function(){var B=this;if(B.blank()){return false;}B=this.replace(/\\./g,"@").replace(/"[^"\\\n\r]*"/g,"");return(/^[,:{}\[\]0-9.\-+Eaeflnr-u \n\r\t]*$/).test(B);},evalJSON:function(sanitize){var json=this.unfilterJSON();try{if(!sanitize||json.isJSON()){return eval("("+json+")");}}catch(e){}throw new SyntaxError("Badly formed JSON string: "+this.inspect());},load:function(B){return this.indexOf(B)>-1;},startsWith:function(B){return this.indexOf(B)===0;},endsWith:function(C){var D=this.length-C.length;return D>=0&&this.lastIndexOf(C)===D;},empty:function(){return this=="";},blank:function(){return/^\s*$/.test(this);},interpolate:function(C,D){return new Template(this,D).evaluate(C);}});if(Prototype.Browser.WebKit||Prototype.Browser.IE){Object.extend(String.prototype,{escapeHTML:function(){return this.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");},unescapeHTML:function(){return this.stripTags().replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">");}});}String.prototype.gsub.prepareReplacement=function(D){if(Object.isFunction(D)){return D;}var C=new Template(D);return function(A){return C.evaluate(A);};};String.prototype.parseQuery=String.prototype.toQueryParams;Object.extend(String.prototype.escapeHTML,{div:document.createElement("div"),text:document.createTextNode("")});String.prototype.escapeHTML.div.appendChild(String.prototype.escapeHTML.text);var Template=Class.create({initialize:function(C,D){this.template=C.toString();this.pattern=D||Template.Pattern;},evaluate:function(B){if(Object.isFunction(B.toTemplateReplacements)){B=B.toTemplateReplacements();}return this.template.gsub(this.pattern,function(J){if(B==null){return"";}var H=J[1]||"";if(H=="\\"){return J[2];}var L=B,A=J[3];var I=/^([^.[]+|\[((?:.*?[^\\])?)\])(\.|\[|$)/;J=I.exec(A);if(J==null){return H;}while(J!=null){var K=J[1].startsWith("[")?J[2].gsub("\\\\]","]"):J[1];L=L[K];if(null==L||""==J[3]){break;}A=A.substring("["==J[3]?J[1].length:J[0].length);J=I.exec(A);}return H+String.interpret(L);});}});Template.Pattern=/(^|.|\r|\n)(#\{(.*?)\})/;var $break={};var Enumerable={each:function(G,H){var E=0;try{this._each(function(A){G.call(H,A,E++);});}catch(F){if(F!=$break){throw F;}}return this;},eachSlice:function(J,K,L){var G=-J,I=[],H=this.toArray();if(J<1){return H;}while((G+=J)<H.length){I.push(H.slice(G,G+J));}return I.collect(K,L);},all:function(E,F){E=E||Prototype.K;var D=true;this.each(function(A,B){D=D&&!!E.call(F,A,B);if(!D){throw $break;}});return D;},any:function(E,F){E=E||Prototype.K;var D=false;this.each(function(A,B){if(D=!!E.call(F,A,B)){throw $break;}});return D;},collect:function(E,F){E=E||Prototype.K;var D=[];this.each(function(A,B){D.push(E.call(F,A,B));});return D;},detect:function(E,F){var D;this.each(function(A,B){if(E.call(F,A,B)){D=A;throw $break;}});return D;},findAll:function(E,F){var D=[];this.each(function(A,B){if(E.call(F,A,B)){D.push(A);}});return D;},grep:function(F,G,H){G=G||Prototype.K;var E=[];if(Object.isString(F)){F=new RegExp(F);}this.each(function(A,B){if(F.match(A)){E.push(G.call(H,A,B));}});return E;},load:function(C){if(Object.isFunction(this.indexOf)){if(this.indexOf(C)!=-1){return true;}}var D=false;this.each(function(A){if(A==C){D=true;throw $break;}});return D;},inGroupsOf:function(D,C){C=Object.isUndefined(C)?null:C;return this.eachSlice(D,function(A){while(A.length<D){A.push(C);}return A;});},inject:function(D,E,F){this.each(function(A,B){D=E.call(F,D,A,B);});return D;},invoke:function(D){var C=$A(arguments).slice(1);return this.map(function(A){return A[D].apply(A,C);});},max:function(E,F){E=E||Prototype.K;var D;this.each(function(A,B){A=E.call(F,A,B);if(D==null||A>=D){D=A;}});return D;},min:function(E,F){E=E||Prototype.K;var D;this.each(function(A,B){A=E.call(F,A,B);if(D==null||A<D){D=A;}});return D;},partition:function(F,H){F=F||Prototype.K;var G=[],E=[];this.each(function(A,B){(F.call(H,A,B)?G:E).push(A);});return[G,E];},pluck:function(D){var C=[];this.each(function(A){C.push(A[D]);});return C;},reject:function(E,F){var D=[];this.each(function(A,B){if(!E.call(F,A,B)){D.push(A);}});return D;},sortBy:function(D,C){return this.map(function(A,B){return{value:A,criteria:D.call(C,A,B)};}).sort(function(A,B){var G=A.criteria,H=B.criteria;return G<H?-1:G>H?1:0;}).pluck("value");},toArray:function(){return this.map();},zip:function(){var F=Prototype.K,D=$A(arguments);if(Object.isFunction(D.last())){F=D.pop();}var E=[this].concat(D).map($A);return this.map(function(A,B){return F(E.pluck(B));});},size:function(){return this.toArray().length;},inspect:function(){return"#<Enumerable:"+this.toArray().inspect()+">";}};Object.extend(Enumerable,{map:Enumerable.collect,find:Enumerable.detect,select:Enumerable.findAll,filter:Enumerable.findAll,member:Enumerable.load,entries:Enumerable.toArray,every:Enumerable.all,some:Enumerable.any});function $A(E){if(!E){return[];}if(E.toArray){return E.toArray();}var F=E.length||0,D=new Array(F);while(F--){D[F]=E[F];}return D;}if(Prototype.Browser.WebKit){$A=function(E){if(!E){return[];}if(!(typeof E==="function"&&typeof E.length==="number"&&typeof E.item==="function")&&E.toArray){return E.toArray();}var F=E.length||0,D=new Array(F);while(F--){D[F]=E[F];}return D;};}Array.from=$A;Object.extend(Array.prototype,Enumerable);if(!Array.prototype._reverse){Array.prototype._reverse=Array.prototype.reverse;}Object.extend(Array.prototype,{_each:function(F){for(var D=0,E=this.length;D<E;D++){F(this[D]);}},clear:function(){this.length=0;return this;},first:function(){return this[0];},last:function(){return this[this.length-1];},compact:function(){return this.select(function(B){return B!=null;});},flatten:function(){return this.inject([],function(D,C){return D.concat(Object.isArray(C)?C.flatten():[C]);});},without:function(){var B=$A(arguments);return this.select(function(A){return !B.load(A);});},reverse:function(B){return(B!==false?this:this.toArray())._reverse();},reduce:function(){return this.length>1?this:this[0];},uniq:function(B){return this.inject([],function(A,E,F){if(0==F||(B?A.last()!=E:!A.load(E))){A.push(E);}return A;});},intersect:function(B){return this.uniq().findAll(function(A){return B.detect(function(D){return A===D;});});},clone:function(){return[].concat(this);},size:function(){return this.length;},inspect:function(){return"["+this.map(Object.inspect).join(", ")+"]";},toJSON:function(){var B=[];this.each(function(D){var A=Object.toJSON(D);if(!Object.isUndefined(A)){B.push(A);}});return"["+B.join(", ")+"]";}});if(Object.isFunction(Array.prototype.forEach)){Array.prototype._each=Array.prototype.forEach;}if(!Array.prototype.indexOf){Array.prototype.indexOf=function(E,D){D||(D=0);var F=this.length;if(D<0){D=F+D;}for(;D<F;D++){if(this[D]===E){return D;}}return -1;};}if(!Array.prototype.lastIndexOf){Array.prototype.lastIndexOf=function(F,D){D=isNaN(D)?this.length:(D<0?this.length+D:D)+1;var E=this.slice(0,D).reverse().indexOf(F);return(E<0)?E:D-E-1;};}Array.prototype.toArray=Array.prototype.clone;function $w(B){if(!Object.isString(B)){return[];}B=B.strip();return B?B.split(/\s+/):[];}if(Prototype.Browser.Opera){Array.prototype.concat=function(){var G=[];for(var J=0,I=this.length;J<I;J++){G.push(this[J]);}for(var J=0,I=arguments.length;J<I;J++){if(Object.isArray(arguments[J])){for(var F=0,H=arguments[J].length;F<H;F++){G.push(arguments[J][F]);}}else{G.push(arguments[J]);}}return G;};}Object.extend(Number.prototype,{toColorPart:function(){return this.toPaddedString(2,16);},succ:function(){return this+1;},times:function(D,C){$R(0,this,true).each(D,C);return this;},toPaddedString:function(E,F){var D=this.toString(F||10);return"0".times(E-D.length)+D;},toJSON:function(){return isFinite(this)?this.toString():"null";}});$w("abs round ceil floor").each(function(B){Number.prototype[B]=Math[B].methodize();});function $H(B){return new Hash(B);}var Hash=Class.create(Enumerable,(function(){function B(D,A){if(Object.isUndefined(A)){return D;}return D+"="+encodeURIComponent(String.interpret(A));}return{initialize:function(A){this._object=Object.isHash(A)?A.toObject():Object.clone(A);},_each:function(G){for(var H in this._object){var F=this._object[H],A=[H,F];A.key=H;A.value=F;G(A);}},set:function(D,A){return this._object[D]=A;},get:function(A){if(this._object[A]!==Object.prototype[A]){return this._object[A];}},unset:function(D){var A=this._object[D];delete this._object[D];return A;},toObject:function(){return Object.clone(this._object);},keys:function(){return this.pluck("key");},values:function(){return this.pluck("value");},index:function(A){var D=this.detect(function(C){return C.value===A;});return D&&D.key;},merge:function(A){return this.clone().update(A);},update:function(A){return new Hash(A).inject(this,function(F,E){F.set(E.key,E.value);return F;});},toQueryString:function(){return this.inject([],function(F,A){var G=encodeURIComponent(A.key),H=A.value;if(H&&typeof H=="object"){if(Object.isArray(H)){return F.concat(H.map(B.curry(G)));}}else{F.push(B(G,H));}return F;}).join("&");},inspect:function(){return"#<Hash:{"+this.map(function(A){return A.map(Object.inspect).join(": ");}).join(", ")+"}>";},toJSON:function(){return Object.toJSON(this.toObject());},clone:function(){return new Hash(this);}};})());Hash.prototype.toTemplateReplacements=Hash.prototype.toObject;Hash.from=$H;var ObjectRange=Class.create(Enumerable,{initialize:function(E,D,F){this.start=E;this.end=D;this.exclusive=F;},_each:function(C){var D=this.start;while(this.load(D)){C(D);D=D.succ();}},load:function(B){if(B<this.start){return false;}if(this.exclusive){return B<this.end;}return B<=this.end;}});var $R=function(E,D,F){return new ObjectRange(E,D,F);};var Ajax={getTransport:function(){return Try.these(function(){return new XMLHttpRequest();},function(){return new ActiveXObject("Msxml2.XMLHTTP");},function(){return new ActiveXObject("Microsoft.XMLHTTP");})||false;},activeRequestCount:0};Ajax.Responders={responders:[],_each:function(B){this.responders._each(B);},register:function(B){if(!this.load(B)){this.responders.push(B);}},unregister:function(B){this.responders=this.responders.without(B);},dispatch:function(F,H,G,E){this.each(function(B){if(Object.isFunction(B[F])){try{B[F].apply(B,[H,G,E]);}catch(A){}}});}};Object.extend(Ajax.Responders,Enumerable);Ajax.Responders.register({onCreate:function(){Ajax.activeRequestCount++;},onComplete:function(){Ajax.activeRequestCount--;}});Ajax.Base=Class.create({initialize:function(B){this.options={method:"post",asynchronous:true,contentType:"application/x-www-form-urlencoded",encoding:"UTF-8",parameters:"",evalJSON:true,evalJS:true};Object.extend(this.options,B||{});this.options.method=this.options.method.toLowerCase();if(Object.isString(this.options.parameters)){this.options.parameters=this.options.parameters.toQueryParams();}else{if(Object.isHash(this.options.parameters)){this.options.parameters=this.options.parameters.toObject();}}}});Ajax.Request=Class.create(Ajax.Base,{_complete:false,initialize:function($super,D,C){$super(C);this.transport=Ajax.getTransport();this.request(D);},request:function(H){this.url=H;this.method=this.options.method;var F=Object.clone(this.options.parameters);if(!["get","post"].load(this.method)){F["_method"]=this.method;this.method="post";}this.parameters=F;if(F=Object.toQueryString(F)){if(this.method=="get"){this.url+=(this.url.load("?")?"&":"?")+F;}else{if(/Konqueror|Safari|KHTML/.test(navigator.userAgent)){F+="&_=";}}}try{var E=new Ajax.Response(this);if(this.options.onCreate){this.options.onCreate(E);}Ajax.Responders.dispatch("onCreate",this,E);this.transport.open(this.method.toUpperCase(),this.url,this.options.asynchronous);if(this.options.asynchronous){this.respondToReadyState.bind(this).defer(1);}this.transport.onreadystatechange=this.onStateChange.bind(this);this.setRequestHeaders();this.body=this.method=="post"?(this.options.postBody||F):null;this.transport.send(this.body);if(!this.options.asynchronous&&this.transport.overrideMimeType){this.onStateChange();}}catch(G){this.dispatchException(G);}},onStateChange:function(){var B=this.transport.readyState;if(B>1&&!((B==4)&&this._complete)){this.respondToReadyState(this.transport.readyState);}},setRequestHeaders:function(){var G={"X-Requested-With":"XMLHttpRequest","X-Prototype-Version":Prototype.Version,"Accept":"text/javascript, text/html, application/xml, text/xml, */*"};if(this.method=="post"){G["Content-type"]=this.options.contentType+(this.options.encoding?"; charset="+this.options.encoding:"");if(this.transport.overrideMimeType&&(navigator.userAgent.match(/Gecko\/(\d{4})/)||[0,2005])[1]<2005){G["Connection"]="close";}}if(typeof this.options.requestHeaders=="object"){var I=this.options.requestHeaders;if(Object.isFunction(I.push)){for(var J=0,H=I.length;J<H;J+=2){G[I[J]]=I[J+1];}}else{$H(I).each(function(A){G[A.key]=A.value;});}}for(var F in G){this.transport.setRequestHeader(F,G[F]);}},success:function(){var B=this.getStatus();return !B||(B>=200&&B<300);},getStatus:function(){try{return this.transport.status||0;}catch(B){return 0;}},respondToReadyState:function(F){var I=Ajax.Request.Events[F],J=new Ajax.Response(this);if(I=="Complete"){try{this._complete=true;(this.options["on"+J.status]||this.options["on"+(this.success()?"Success":"Failure")]||Prototype.emptyFunction)(J,J.headerJSON);}catch(H){this.dispatchException(H);}var G=J.getHeader("Content-type");if(this.options.evalJS=="force"||(this.options.evalJS&&this.isSameOrigin()&&G&&G.match(/^\s*(text|application)\/(x-)?(java|ecma)script(;.*)?\s*$/i))){this.evalResponse();}}try{(this.options["on"+I]||Prototype.emptyFunction)(J,J.headerJSON);Ajax.Responders.dispatch("on"+I,this,J,J.headerJSON);}catch(H){this.dispatchException(H);}if(I=="Complete"){this.transport.onreadystatechange=Prototype.emptyFunction;}},isSameOrigin:function(){var B=this.url.match(/^\s*https?:\/\/[^\/]*/);return !B||(B[0]=="#{protocol}//#{domain}#{port}".interpolate({protocol:location.protocol,domain:document.domain,port:location.port?":"+location.port:""}));},getHeader:function(C){try{return this.transport.getResponseHeader(C)||null;}catch(D){return null;}},evalResponse:function(){try{return eval((this.transport.responseText||"").unfilterJSON());}catch(e){this.dispatchException(e);}},dispatchException:function(B){(this.options.onException||Prototype.emptyFunction)(this,B);Ajax.Responders.dispatch("onException",this,B);}});Ajax.Request.Events=["Uninitialized","Loading","Loaded","Interactive","Complete"];Ajax.Response=Class.create({initialize:function(G){this.request=G;var F=this.transport=G.transport,E=this.readyState=F.readyState;if((E>2&&!Prototype.Browser.IE)||E==4){this.status=this.getStatus();this.statusText=this.getStatusText();this.responseText=String.interpret(F.responseText);this.headerJSON=this._getHeaderJSON();}if(E==4){var H=F.responseXML;this.responseXML=Object.isUndefined(H)?null:H;this.responseJSON=this._getResponseJSON();}},status:0,statusText:"",getStatus:Ajax.Request.prototype.getStatus,getStatusText:function(){try{return this.transport.statusText||"";}catch(B){return"";}},getHeader:Ajax.Request.prototype.getHeader,getAllHeaders:function(){try{return this.getAllResponseHeaders();}catch(B){return null;}},getResponseHeader:function(B){return this.transport.getResponseHeader(B);},getAllResponseHeaders:function(){return this.transport.getAllResponseHeaders();},_getHeaderJSON:function(){var C=this.getHeader("X-JSON");if(!C){return null;}C=decodeURIComponent(escape(C));try{return C.evalJSON(this.request.options.sanitizeJSON||!this.request.isSameOrigin());}catch(D){this.request.dispatchException(D);}},_getResponseJSON:function(){var C=this.request.options;if(!C.evalJSON||(C.evalJSON!="force"&&!(this.getHeader("Content-type")||"").load("application/json"))||this.responseText.blank()){return null;}try{return this.responseText.evalJSON(C.sanitizeJSON||!this.request.isSameOrigin());}catch(D){this.request.dispatchException(D);}}});Ajax.Updater=Class.create(Ajax.Request,{initialize:function($super,E,G,H){this.container={success:(E.success||E),failure:(E.failure||(E.success?null:E))};H=Object.clone(H);var F=H.onComplete;H.onComplete=(function(B,A){this.updateContent(B.responseText);if(Object.isFunction(F)){F(B,A);}}).bind(this);$super(G,H);},updateContent:function(F){var G=this.container[this.success()?"success":"failure"],E=this.options;if(!E.evalScripts){F=F.stripScripts();}if(G=$(G)){if(E.insertion){if(Object.isString(E.insertion)){var H={};H[E.insertion]=F;G.insert(H);}else{E.insertion(G,F);}}else{G.update(F);}}}});Ajax.PeriodicalUpdater=Class.create(Ajax.Base,{initialize:function($super,D,E,F){$super(F);this.onComplete=this.options.onComplete;this.frequency=(this.options.frequency||2);this.decay=(this.options.decay||1);this.updater={};this.container=D;this.url=E;this.start();},start:function(){this.options.onComplete=this.updateComplete.bind(this);this.onTimerEvent();},stop:function(){this.updater.options.onComplete=undefined;clearTimeout(this.timer);(this.onComplete||Prototype.emptyFunction).apply(this,arguments);},updateComplete:function(B){if(this.options.decay){this.decay=(B.responseText==this.lastText?this.decay*this.options.decay:1);this.lastText=B.responseText;}this.timer=this.onTimerEvent.bind(this).delay(this.decay*this.frequency);},onTimerEvent:function(){this.updater=new Ajax.Updater(this.container,this.url,this.options);}});function $(H){if(arguments.length>1){for(var E=0,F=[],G=arguments.length;E<G;E++){F.push($(arguments[E]));}return F;}if(Object.isString(H)){H=document.getElementById(H);}return Element.extend(H);}if(Prototype.BrowserFeatures.XPath){document._getElementsByXPath=function(H,G){var K=[];var I=document.evaluate(H,$(G)||document,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null);for(var L=0,J=I.snapshotLength;L<J;L++){K.push(Element.extend(I.snapshotItem(L)));}return K;};}if(!window.Node){var Node={};}if(!Node.ELEMENT_NODE){Object.extend(Node,{ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12});}(function(){var B=this.Element;this.Element=function(A,E){E=E||{};A=A.toLowerCase();var F=Element.cache;if(Prototype.Browser.IE&&E.name){A="<"+A+' name="'+E.name+'">';delete E.name;return Element.writeAttribute(document.createElement(A),E);}if(!F[A]){F[A]=Element.extend(document.createElement(A));}return Element.writeAttribute(F[A].cloneNode(false),E);};Object.extend(this.Element,B||{});if(B){this.Element.prototype=B.prototype;}}).call(window);Element.cache={};Element.Methods={visible:function(B){return $(B).style.display!="none";},toggle:function(B){B=$(B);Element[Element.visible(B)?"hide":"show"](B);return B;},hide:function(B){B=$(B);B.style.display="none";return B;},show:function(B){B=$(B);B.style.display="";return B;},remove:function(B){B=$(B);B.parentNode.removeChild(B);return B;},update:function(C,D){C=$(C);if(D&&D.toElement){D=D.toElement();}if(Object.isElement(D)){return C.update().insert(D);}D=Object.toHTML(D);C.innerHTML=D.stripScripts();D.evalScripts.bind(D).defer();return C;},replace:function(F,E){F=$(F);if(E&&E.toElement){E=E.toElement();}else{if(!Object.isElement(E)){E=Object.toHTML(E);var D=F.ownerDocument.createRange();D.selectNode(F);E.evalScripts.bind(E).defer();E=D.createContextualFragment(E.stripScripts());}}F.parentNode.replaceChild(E,F);return F;},insert:function(M,K){M=$(M);if(Object.isString(K)||Object.isNumber(K)||Object.isElement(K)||(K&&(K.toElement||K.toHTML))){K={bottom:K};}var L,J,N,I;for(var H in K){L=K[H];H=H.toLowerCase();J=Element._insertionTranslations[H];if(L&&L.toElement){L=L.toElement();}if(Object.isElement(L)){J(M,L);continue;}L=Object.toHTML(L);N=((H=="before"||H=="after")?M.parentNode:M).tagName.toUpperCase();I=Element._getContentFromAnonymousElement(N,L.stripScripts());if(H=="top"||H=="after"){I.reverse();}I.each(J.curry(M));L.evalScripts.bind(L).defer();}return M;},wrap:function(F,E,D){F=$(F);if(Object.isElement(E)){$(E).writeAttribute(D||{});}else{if(Object.isString(E)){E=new Element(E,D);}else{E=new Element("div",E);}}if(F.parentNode){F.parentNode.replaceChild(E,F);}E.appendChild(F);return E;},inspect:function(D){D=$(D);var C="<"+D.tagName.toLowerCase();$H({"id":"id","className":"class"}).each(function(A){var B=A.first(),H=A.last();var G=(D[B]||"").toString();if(G){C+=" "+H+"="+G.inspect(true);}});return C+">";},recursivelyCollect:function(D,E){D=$(D);var F=[];while(D=D[E]){if(D.nodeType==1){F.push(Element.extend(D));}}return F;},ancestors:function(B){return $(B).recursivelyCollect("parentNode");},descendants:function(B){return $(B).select("*");},firstDescendant:function(B){B=$(B).firstChild;while(B&&B.nodeType!=1){B=B.nextSibling;}return $(B);},immediateDescendants:function(B){if(!(B=$(B).firstChild)){return[];}while(B&&B.nodeType!=1){B=B.nextSibling;}if(B){return[B].concat($(B).nextSiblings());}return[];},previousSiblings:function(B){return $(B).recursivelyCollect("previousSibling");},nextSiblings:function(B){return $(B).recursivelyCollect("nextSibling");},siblings:function(B){B=$(B);return B.previousSiblings().reverse().concat(B.nextSiblings());},match:function(D,C){if(Object.isString(C)){C=new Selector(C);}return C.match($(D));},up:function(H,F,E){H=$(H);if(arguments.length==1){return $(H.parentNode);}var G=H.ancestors();return Object.isNumber(F)?G[F]:Selector.findElement(G,F,E);},down:function(F,E,D){F=$(F);if(arguments.length==1){return F.firstDescendant();}return Object.isNumber(E)?F.descendants()[E]:Element.select(F,E)[D||0];},previous:function(H,F,E){H=$(H);if(arguments.length==1){return $(Selector.handlers.previousElementSibling(H));}var G=H.previousSiblings();return Object.isNumber(F)?G[F]:Selector.findElement(G,F,E);},next:function(G,F,H){G=$(G);if(arguments.length==1){return $(Selector.handlers.nextElementSibling(G));}var E=G.nextSiblings();return Object.isNumber(F)?E[F]:Selector.findElement(E,F,H);},select:function(){var C=$A(arguments),D=$(C.shift());return Selector.findChildElements(D,C);},adjacent:function(){var C=$A(arguments),D=$(C.shift());return Selector.findChildElements(D.parentNode,C).without(D);},identify:function(F){F=$(F);var E=F.readAttribute("id"),D=arguments.callee;if(E){return E;}do{E="anonymous_element_"+D.counter++;}while($(E));F.writeAttribute("id",E);return E;},readAttribute:function(E,D){E=$(E);if(Prototype.Browser.IE){var F=Element._attributeTranslations.read;if(F.values[D]){return F.values[D](E,D);}if(F.names[D]){D=F.names[D];}if(D.load(":")){return(!E.attributes||!E.attributes[D])?null:E.attributes[D].value;}}return E.getAttribute(D);},writeAttribute:function(I,K,H){I=$(I);var L={},J=Element._attributeTranslations.write;if(typeof K=="object"){L=K;}else{L[K]=Object.isUndefined(H)?true:H;}for(var G in L){K=J.names[G]||G;H=L[G];if(J.values[G]){K=J.values[G](I,H);}if(H===false||H===null){I.removeAttribute(K);}else{if(H===true){I.setAttribute(K,K);}else{I.setAttribute(K,H);}}}return I;},getHeight:function(B){return $(B).getDimensions().height;},getWidth:function(B){return $(B).getDimensions().width;},classNames:function(B){return new Element.ClassNames(B);},hasClassName:function(D,F){if(!(D=$(D))){return;}var E=D.className;return(E.length>0&&(E==F||new RegExp("(^|\\s)"+F+"(\\s|$)").test(E)));},addClassName:function(C,D){if(!(C=$(C))){return;}if(!C.hasClassName(D)){C.className+=(C.className?" ":"")+D;}return C;},removeClassName:function(C,D){if(!(C=$(C))){return;}C.className=C.className.replace(new RegExp("(^|\\s+)"+D+"(\\s+|$)")," ").strip();return C;},toggleClassName:function(C,D){if(!(C=$(C))){return;}return C[C.hasClassName(D)?"removeClassName":"addClassName"](D);},cleanWhitespace:function(F){F=$(F);var E=F.firstChild;while(E){var D=E.nextSibling;if(E.nodeType==3&&!/\S/.test(E.nodeValue)){F.removeChild(E);}E=D;}return F;},empty:function(B){return $(B).innerHTML.blank();},descendantOf:function(D,C){D=$(D),C=$(C);if(D.compareDocumentPosition){return(D.compareDocumentPosition(C)&8)===8;}if(C.contains){return C.contains(D)&&C!==D;}while(D=D.parentNode){if(D==C){return true;}}return false;},scrollTo:function(C){C=$(C);var D=C.cumulativeOffset();window.scrollTo(D[0],D[1]);return C;},getStyle:function(H,G){H=$(H);G=G=="float"?"cssFloat":G.camelize();var F=H.style[G];if(!F||F=="auto"){var E=document.defaultView.getComputedStyle(H,null);F=E?E[G]:null;}if(G=="opacity"){return F?parseFloat(F):1;}return F=="auto"?null:F;},getOpacity:function(B){return $(B).getStyle("opacity");},setStyle:function(J,I){J=$(J);var G=J.style,F;if(Object.isString(I)){J.style.cssText+=";"+I;return I.load("opacity")?J.setOpacity(I.match(/opacity:\s*(\d?\.?\d*)/)[1]):J;}for(var H in I){if(H=="opacity"){J.setOpacity(I[H]);}else{G[(H=="float"||H=="cssFloat")?(Object.isUndefined(G.styleFloat)?"cssFloat":"styleFloat"):H]=I[H];}}return J;},setOpacity:function(C,D){C=$(C);C.style.opacity=(D==1||D==="")?"":(D<0.00001)?0:D;return C;},getDimensions:function(O){O=$(O);var K=O.getStyle("display");if(K!="none"&&K!=null){return{width:O.offsetWidth,height:O.offsetHeight};}var P=O.style;var L=P.visibility;var N=P.position;var I=P.display;P.visibility="hidden";P.position="absolute";P.display="block";var J=O.clientWidth;var M=O.clientHeight;P.display=I;P.position=N;P.visibility=L;return{width:J,height:M};},makePositioned:function(C){C=$(C);var D=Element.getStyle(C,"position");if(D=="static"||!D){C._madePositioned=true;C.style.position="relative";if(Prototype.Browser.Opera){C.style.top=0;C.style.left=0;}}return C;},undoPositioned:function(B){B=$(B);if(B._madePositioned){B._madePositioned=undefined;B.style.position=B.style.top=B.style.left=B.style.bottom=B.style.right="";}return B;},makeClipping:function(B){B=$(B);if(B._overflow){return B;}B._overflow=Element.getStyle(B,"overflow")||"auto";if(B._overflow!=="hidden"){B.style.overflow="hidden";}return B;},undoClipping:function(B){B=$(B);if(!B._overflow){return B;}B.style.overflow=B._overflow=="auto"?"":B._overflow;B._overflow=null;return B;},cumulativeOffset:function(F){var D=0,E=0;do{D+=F.offsetTop||0;E+=F.offsetLeft||0;F=F.offsetParent;}while(F);return Element._returnOffset(E,D);},positionedOffset:function(H){var E=0,F=0;do{E+=H.offsetTop||0;F+=H.offsetLeft||0;H=H.offsetParent;if(H){if(H.tagName.toUpperCase()=="BODY"){break;}var G=Element.getStyle(H,"position");if(G!=="static"){break;}}}while(H);return Element._returnOffset(F,E);},absolutize:function(L){L=$(L);if(L.getStyle("position")=="absolute"){return L;}var J=L.positionedOffset();var H=J[1];var I=J[0];var K=L.clientWidth;var G=L.clientHeight;L._originalLeft=I-parseFloat(L.style.left||0);L._originalTop=H-parseFloat(L.style.top||0);L._originalWidth=L.style.width;L._originalHeight=L.style.height;L.style.position="absolute";L.style.top=H+"px";L.style.left=I+"px";L.style.width=K+"px";L.style.height=G+"px";return L;},relativize:function(D){D=$(D);if(D.getStyle("position")=="relative"){return D;}D.style.position="relative";var E=parseFloat(D.style.top||0)-(D._originalTop||0);var F=parseFloat(D.style.left||0)-(D._originalLeft||0);D.style.top=E+"px";D.style.left=F+"px";D.style.height=D._originalHeight;D.style.width=D._originalWidth;return D;},cumulativeScrollOffset:function(F){var D=0,E=0;do{D+=F.scrollTop||0;E+=F.scrollLeft||0;F=F.parentNode;}while(F);return Element._returnOffset(E,D);},getOffsetParent:function(B){if(B.offsetParent){return $(B.offsetParent);}if(B==document.body){return $(B);}while((B=B.parentNode)&&B!=document.body){if(Element.getStyle(B,"position")!="static"){return $(B);}}return $(document.body);},viewportOffset:function(F){var E=0,G=0;var H=F;do{E+=H.offsetTop||0;G+=H.offsetLeft||0;if(H.offsetParent==document.body&&Element.getStyle(H,"position")=="absolute"){break;}}while(H=H.offsetParent);H=F;do{if(!Prototype.Browser.Opera||(H.tagName&&(H.tagName.toUpperCase()=="BODY"))){E-=H.scrollTop||0;G-=H.scrollLeft||0;}}while(H=H.parentNode);return Element._returnOffset(G,E);},clonePosition:function(L,J){var G=Object.extend({setLeft:true,setTop:true,setWidth:true,setHeight:true,offsetTop:0,offsetLeft:0},arguments[2]||{});J=$(J);var I=J.viewportOffset();L=$(L);var H=[0,0];var K=null;if(Element.getStyle(L,"position")=="absolute"){K=L.getOffsetParent();H=K.viewportOffset();}if(K==document.body){H[0]-=document.body.offsetLeft;H[1]-=document.body.offsetTop;}if(G.setLeft){L.style.left=(I[0]-H[0]+G.offsetLeft)+"px";}if(G.setTop){L.style.top=(I[1]-H[1]+G.offsetTop)+"px";}if(G.setWidth){L.style.width=J.offsetWidth+"px";}if(G.setHeight){L.style.height=J.offsetHeight+"px";}return L;}};Element.Methods.identify.counter=1;Object.extend(Element.Methods,{getElementsBySelector:Element.Methods.select,childElements:Element.Methods.immediateDescendants});Element._attributeTranslations={write:{names:{className:"class",htmlFor:"for"},values:{}}};if(Prototype.Browser.Opera){Element.Methods.getStyle=Element.Methods.getStyle.wrap(function(H,J,I){switch(I){case"left":case"top":case"right":case"bottom":if(H(J,"position")==="static"){return null;}case"height":case"width":if(!Element.visible(J)){return null;}var G=parseInt(H(J,I),10);if(G!==J["offset"+I.capitalize()]){return G+"px";}var F;if(I==="height"){F=["border-top-width","padding-top","padding-bottom","border-bottom-width"];}else{F=["border-left-width","padding-left","padding-right","border-right-width"];}return F.inject(G,function(C,B){var A=H(J,B);return A===null?C:C-parseInt(A,10);})+"px";default:return H(J,I);}});Element.Methods.readAttribute=Element.Methods.readAttribute.wrap(function(E,D,F){if(F==="title"){return D.title;}return E(D,F);});}else{if(Prototype.Browser.IE){Element.Methods.getOffsetParent=Element.Methods.getOffsetParent.wrap(function(I,J){J=$(J);try{J.offsetParent;}catch(G){return $(document.body);}var F=J.getStyle("position");if(F!=="static"){return I(J);}J.setStyle({position:"relative"});var H=I(J);J.setStyle({position:F});return H;});$w("positionedOffset viewportOffset").each(function(B){Element.Methods[B]=Element.Methods[B].wrap(function(I,K){K=$(K);try{K.offsetParent;}catch(A){return Element._returnOffset(0,0);}var L=K.getStyle("position");if(L!=="static"){return I(K);}var J=K.getOffsetParent();if(J&&J.getStyle("position")==="fixed"){J.setStyle({zoom:1});}K.setStyle({position:"relative"});var H=I(K);K.setStyle({position:L});return H;});});Element.Methods.cumulativeOffset=Element.Methods.cumulativeOffset.wrap(function(F,D){try{D.offsetParent;}catch(E){return Element._returnOffset(0,0);}return F(D);});Element.Methods.getStyle=function(D,F){D=$(D);F=(F=="float"||F=="cssFloat")?"styleFloat":F.camelize();var E=D.style[F];if(!E&&D.currentStyle){E=D.currentStyle[F];}if(F=="opacity"){if(E=(D.getStyle("filter")||"").match(/alpha\(opacity=(.*)\)/)){if(E[1]){return parseFloat(E[1])/100;}}return 1;}if(E=="auto"){if((F=="width"||F=="height")&&(D.getStyle("display")!="none")){return D["offset"+F.capitalize()]+"px";}return null;}return E;};Element.Methods.setOpacity=function(L,I){function H(A){return A.replace(/alpha\([^\)]*\)/gi,"");}L=$(L);var G=L.currentStyle;if((G&&!G.hasLayout)||(!G&&L.style.zoom=="normal")){L.style.zoom=1;}var J=L.getStyle("filter"),K=L.style;if(I==1||I===""){(J=H(J))?K.filter=J:K.removeAttribute("filter");return L;}else{if(I<0.00001){I=0;}}K.filter=H(J)+"alpha(opacity="+(I*100)+")";return L;};Element._attributeTranslations={read:{names:{"class":"className","for":"htmlFor"},values:{_getAttr:function(C,D){return C.getAttribute(D,2);},_getAttrNode:function(D,E){var F=D.getAttributeNode(E);return F?F.value:"";},_getEv:function(C,D){D=C.getAttribute(D);return D?D.toString().slice(23,-2):null;},_flag:function(C,D){return $(C).hasAttribute(D)?D:null;},style:function(B){return B.style.cssText.toLowerCase();},title:function(B){return B.title;}}}};Element._attributeTranslations.write={names:Object.extend({cellpadding:"cellPadding",cellspacing:"cellSpacing"},Element._attributeTranslations.read.names),values:{checked:function(C,D){C.checked=!!D;},style:function(C,D){C.style.cssText=D?D:"";}}};Element._attributeTranslations.has={};$w("colSpan rowSpan vAlign dateTime accessKey tabIndex "+"encType maxLength readOnly longDesc frameBorder").each(function(B){Element._attributeTranslations.write.names[B.toLowerCase()]=B;Element._attributeTranslations.has[B.toLowerCase()]=B;});(function(B){Object.extend(B,{href:B._getAttr,src:B._getAttr,type:B._getAttr,action:B._getAttrNode,disabled:B._flag,checked:B._flag,readonly:B._flag,multiple:B._flag,onload:B._getEv,onunload:B._getEv,onclick:B._getEv,ondblclick:B._getEv,onmousedown:B._getEv,onmouseup:B._getEv,onmouseover:B._getEv,onmousemove:B._getEv,onmouseout:B._getEv,onfocus:B._getEv,onblur:B._getEv,onkeypress:B._getEv,onkeydown:B._getEv,onkeyup:B._getEv,onsubmit:B._getEv,onreset:B._getEv,onselect:B._getEv,onchange:B._getEv});})(Element._attributeTranslations.read.values);}else{if(Prototype.Browser.Gecko&&/rv:1\.8\.0/.test(navigator.userAgent)){Element.Methods.setOpacity=function(C,D){C=$(C);C.style.opacity=(D==1)?0.999999:(D==="")?"":(D<0.00001)?0:D;return C;};}else{if(Prototype.Browser.WebKit){Element.Methods.setOpacity=function(E,H){E=$(E);E.style.opacity=(H==1||H==="")?"":(H<0.00001)?0:H;if(H==1){if(E.tagName.toUpperCase()=="IMG"&&E.width){E.width++;E.width--;}else{try{var F=document.createTextNode(" ");E.appendChild(F);E.removeChild(F);}catch(G){}}}return E;};Element.Methods.cumulativeOffset=function(F){var D=0,E=0;do{D+=F.offsetTop||0;E+=F.offsetLeft||0;if(F.offsetParent==document.body){if(Element.getStyle(F,"position")=="absolute"){break;}}F=F.offsetParent;}while(F);return Element._returnOffset(E,D);};}}}}if(Prototype.Browser.IE||Prototype.Browser.Opera){Element.Methods.update=function(F,E){F=$(F);if(E&&E.toElement){E=E.toElement();}if(Object.isElement(E)){return F.update().insert(E);}E=Object.toHTML(E);var D=F.tagName.toUpperCase();if(D in Element._insertionTranslations.tags){$A(F.childNodes).each(function(A){F.removeChild(A);});Element._getContentFromAnonymousElement(D,E.stripScripts()).each(function(A){F.appendChild(A);});}else{F.innerHTML=E.stripScripts();}E.evalScripts.bind(E).defer();return F;};}if("outerHTML" in document.createElement("div")){Element.Methods.replace=function(K,I){K=$(K);if(I&&I.toElement){I=I.toElement();}if(Object.isElement(I)){K.parentNode.replaceChild(I,K);return K;}I=Object.toHTML(I);var J=K.parentNode,L=J.tagName.toUpperCase();if(Element._insertionTranslations.tags[L]){var H=K.next();var G=Element._getContentFromAnonymousElement(L,I.stripScripts());J.removeChild(K);if(H){G.each(function(A){J.insertBefore(A,H);});}else{G.each(function(A){J.appendChild(A);});}}else{K.outerHTML=I.stripScripts();}I.evalScripts.bind(I).defer();return K;};}Element._returnOffset=function(F,E){var D=[F,E];D.left=F;D.top=E;return D;};Element._getContentFromAnonymousElement=function(G,H){var F=new Element("div"),E=Element._insertionTranslations.tags[G];if(E){F.innerHTML=E[0]+H+E[1];E[2].times(function(){F=F.firstChild;});}else{F.innerHTML=H;}return $A(F.childNodes);};Element._insertionTranslations={before:function(C,D){C.parentNode.insertBefore(D,C);},top:function(C,D){C.insertBefore(D,C.firstChild);},bottom:function(C,D){C.appendChild(D);},after:function(C,D){C.parentNode.insertBefore(D,C.nextSibling);},tags:{TABLE:["<table>","</table>",1],TBODY:["<table><tbody>","</tbody></table>",2],TR:["<table><tbody><tr>","</tr></tbody></table>",3],TD:["<table><tbody><tr><td>","</td></tr></tbody></table>",4],SELECT:["<select>","</select>",1]}};(function(){Object.extend(this.tags,{THEAD:this.tags.TBODY,TFOOT:this.tags.TBODY,TH:this.tags.TD});}).call(Element._insertionTranslations);Element.Methods.Simulated={hasAttribute:function(D,E){E=Element._attributeTranslations.has[E]||E;var F=$(D).getAttributeNode(E);return !!(F&&F.specified);}};Element.Methods.ByTag={};Object.extend(Element,Element.Methods);if(!Prototype.BrowserFeatures.ElementExtensions&&document.createElement("div")["__proto__"]){window.HTMLElement={};window.HTMLElement.prototype=document.createElement("div")["__proto__"];Prototype.BrowserFeatures.ElementExtensions=true;}Element.extend=(function(){if(Prototype.BrowserFeatures.SpecificElementExtensions){return Prototype.K;}var D={},F=Element.Methods.ByTag;var E=Object.extend(function(C){if(!C||C._extendedByPrototype||C.nodeType!=1||C==window){return C;}var J=Object.clone(D),I=C.tagName.toUpperCase(),A,B;if(F[I]){Object.extend(J,F[I]);}for(A in J){B=J[A];if(Object.isFunction(B)&&!(A in C)){C[A]=B.methodize();}}C._extendedByPrototype=Prototype.emptyFunction;return C;},{refresh:function(){if(!Prototype.BrowserFeatures.ElementExtensions){Object.extend(D,Element.Methods);Object.extend(D,Element.Methods.Simulated);}}});E.refresh();return E;})();Element.hasAttribute=function(C,D){if(C.hasAttribute){return C.hasAttribute(D);}return Element.Methods.Simulated.hasAttribute(C,D);};Element.addMethods=function(K){var O=Prototype.BrowserFeatures,F=Element.Methods.ByTag;if(!K){Object.extend(Form,Form.Methods);Object.extend(Form.Element,Form.Element.Methods);Object.extend(Element.Methods.ByTag,{"FORM":Object.clone(Form.Methods),"INPUT":Object.clone(Form.Element.Methods),"SELECT":Object.clone(Form.Element.Methods),"TEXTAREA":Object.clone(Form.Element.Methods)});}if(arguments.length==2){var L=K;K=arguments[1];}if(!L){Object.extend(Element.Methods,K||{});}else{if(Object.isArray(L)){L.each(P);}else{P(L);}}function P(A){A=A.toUpperCase();if(!Element.Methods.ByTag[A]){Element.Methods.ByTag[A]={};}Object.extend(Element.Methods.ByTag[A],K);}function M(A,B,C){C=C||false;for(var D in A){var E=A[D];if(!Object.isFunction(E)){continue;}if(!C||!(D in B)){B[D]=E.methodize();}}}function R(A){var C;var B={"OPTGROUP":"OptGroup","TEXTAREA":"TextArea","P":"Paragraph","FIELDSET":"FieldSet","UL":"UList","OL":"OList","DL":"DList","DIR":"Directory","H1":"Heading","H2":"Heading","H3":"Heading","H4":"Heading","H5":"Heading","H6":"Heading","Q":"Quote","INS":"Mod","DEL":"Mod","A":"Anchor","IMG":"Image","CAPTION":"TableCaption","COL":"TableCol","COLGROUP":"TableCol","THEAD":"TableSection","TFOOT":"TableSection","TBODY":"TableSection","TR":"TableRow","TH":"TableCell","TD":"TableCell","FRAMESET":"FrameSet","IFRAME":"IFrame"};if(B[A]){C="HTML"+B[A]+"Element";}if(window[C]){return window[C];}C="HTML"+A+"Element";if(window[C]){return window[C];}C="HTML"+A.capitalize()+"Element";if(window[C]){return window[C];}window[C]={};window[C].prototype=document.createElement(A)["__proto__"];return window[C];}if(O.ElementExtensions){M(Element.Methods,HTMLElement.prototype);M(Element.Methods.Simulated,HTMLElement.prototype,true);}if(O.SpecificElementExtensions){for(var N in Element.Methods.ByTag){var Q=R(N);if(Object.isUndefined(Q)){continue;}M(F[N],Q.prototype);}}Object.extend(Element,Element.Methods);delete Element.ByTag;if(Element.extend.refresh){Element.extend.refresh();}Element.cache={};};document.viewport={getDimensions:function(){var B={},D=Prototype.Browser;$w("width height").each(function(A){var C=A.capitalize();if(D.WebKit&&!document.evaluate){B[A]=self["inner"+C];}else{if(D.Opera&&parseFloat(window.opera.version())<9.5){B[A]=document.body["client"+C];}else{B[A]=document.documentElement["client"+C];}}});return B;},getWidth:function(){return this.getDimensions().width;},getHeight:function(){return this.getDimensions().height;},getScrollOffsets:function(){return Element._returnOffset(window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft,window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop);}};var Selector=Class.create({initialize:function(B){this.expression=B.strip();if(this.shouldUseSelectorsAPI()){this.mode="selectorsAPI";}else{if(this.shouldUseXPath()){this.mode="xpath";this.compileXPathMatcher();}else{this.mode="normal";this.compileMatcher();}}},shouldUseXPath:function(){if(!Prototype.BrowserFeatures.XPath){return false;}var B=this.expression;if(Prototype.Browser.WebKit&&(B.load("-of-type")||B.load(":empty"))){return false;}if((/(\[[\w-]*?:|:checked)/).test(B)){return false;}return true;},shouldUseSelectorsAPI:function(){if(!Prototype.BrowserFeatures.SelectorsAPI){return false;}if(!Selector._div){Selector._div=new Element("div");}try{Selector._div.querySelector(this.expression);}catch(B){return false;}return true;},compileMatcher:function(){var e=this.expression,ps=Selector.patterns,h=Selector.handlers,c=Selector.criteria,le,p,m;if(Selector._cache[e]){this.matcher=Selector._cache[e];return;}this.matcher=["this.matcher = function(root) {","var r = root, h = Selector.handlers, c = false, n;"];while(e&&le!=e&&(/\S/).test(e)){le=e;for(var i in ps){p=ps[i];if(m=e.match(p)){this.matcher.push(Object.isFunction(c[i])?c[i](m):new Template(c[i]).evaluate(m));e=e.replace(m[0],"");break;}}}this.matcher.push("return h.unique(n);\n}");eval(this.matcher.join("\n"));Selector._cache[this.expression]=this.matcher;},compileXPathMatcher:function(){var I=this.expression,H=Selector.patterns,L=Selector.xpath,J,G;if(Selector._cache[I]){this.xpath=Selector._cache[I];return;}this.matcher=[".//*"];while(I&&J!=I&&(/\S/).test(I)){J=I;for(var K in H){if(G=I.match(H[K])){this.matcher.push(Object.isFunction(L[K])?L[K](G):new Template(L[K]).evaluate(G));I=I.replace(G[0],"");break;}}}this.xpath=this.matcher.join("");Selector._cache[this.expression]=this.xpath;},findElements:function(F){F=F||document;var I=this.expression,J;switch(this.mode){case"selectorsAPI":if(F!==document){var H=F.id,G=$(F).identify();I="#"+G+" "+I;}J=$A(F.querySelectorAll(I)).map(Element.extend);F.id=H;return J;case"xpath":return document._getElementsByXPath(this.xpath,F);default:return this.matcher(F);}},match:function(U){this.tokens=[];var Q=this.expression,P=Selector.patterns,X=Selector.assertions;var O,M,W;while(Q&&O!==Q&&(/\S/).test(Q)){O=Q;for(var T in P){M=P[T];if(W=Q.match(M)){if(X[T]){this.tokens.push([T,Object.clone(W)]);Q=Q.replace(W[0],"");}else{return this.findElements(document).load(U);}}}}var R=true,N,S;for(var T=0,V;V=this.tokens[T];T++){N=V[0],S=V[1];if(!Selector.assertions[N](U,S)){R=false;break;}}return R;},toString:function(){return this.expression;},inspect:function(){return"#<Selector:"+this.expression.inspect()+">";}});Object.extend(Selector,{_cache:{},xpath:{descendant:"//*",child:"/*",adjacent:"/following-sibling::*[1]",laterSibling:"/following-sibling::*",tagName:function(B){if(B[1]=="*"){return"";}return"[local-name()='"+B[1].toLowerCase()+"' or local-name()='"+B[1].toUpperCase()+"']";},className:"[contains(concat(' ', @class, ' '), ' #{1} ')]",id:"[@id='#{1}']",attrPresence:function(B){B[1]=B[1].toLowerCase();return new Template("[@#{1}]").evaluate(B);},attr:function(B){B[1]=B[1].toLowerCase();B[3]=B[5]||B[6];return new Template(Selector.xpath.operators[B[2]]).evaluate(B);},pseudo:function(C){var D=Selector.xpath.pseudos[C[1]];if(!D){return"";}if(Object.isFunction(D)){return D(C);}return new Template(Selector.xpath.pseudos[C[1]]).evaluate(C);},operators:{"=":"[@#{1}='#{3}']","!=":"[@#{1}!='#{3}']","^=":"[starts-with(@#{1}, '#{3}')]","$=":"[substring(@#{1}, (string-length(@#{1}) - string-length('#{3}') + 1))='#{3}']","*=":"[contains(@#{1}, '#{3}')]","~=":"[contains(concat(' ', @#{1}, ' '), ' #{3} ')]","|=":"[contains(concat('-', @#{1}, '-'), '-#{3}-')]"},pseudos:{"first-child":"[not(preceding-sibling::*)]","last-child":"[not(following-sibling::*)]","only-child":"[not(preceding-sibling::* or following-sibling::*)]","empty":"[count(*) = 0 and (count(text()) = 0)]","checked":"[@checked]","disabled":"[(@disabled) and (@type!='hidden')]","enabled":"[not(@disabled) and (@type!='hidden')]","not":function(P){var J=P[6],K=Selector.patterns,I=Selector.xpath,M,O;var L=[];while(J&&M!=J&&(/\S/).test(J)){M=J;for(var N in K){if(P=J.match(K[N])){O=Object.isFunction(I[N])?I[N](P):new Template(I[N]).evaluate(P);L.push("("+O.substring(1,O.length-1)+")");J=J.replace(P[0],"");break;}}}return"[not("+L.join(" and ")+")]";},"nth-child":function(B){return Selector.xpath.pseudos.nth("(count(./preceding-sibling::*) + 1) ",B);},"nth-last-child":function(B){return Selector.xpath.pseudos.nth("(count(./following-sibling::*) + 1) ",B);},"nth-of-type":function(B){return Selector.xpath.pseudos.nth("position() ",B);},"nth-last-of-type":function(B){return Selector.xpath.pseudos.nth("(last() + 1 - position()) ",B);},"first-of-type":function(B){B[6]="1";return Selector.xpath.pseudos["nth-of-type"](B);},"last-of-type":function(B){B[6]="1";return Selector.xpath.pseudos["nth-last-of-type"](B);},"only-of-type":function(C){var D=Selector.xpath.pseudos;return D["first-of-type"](C)+D["last-of-type"](C);},nth:function(K,M){var J,I=M[6],N;if(I=="even"){I="2n+0";}if(I=="odd"){I="2n+1";}if(J=I.match(/^(\d+)$/)){return"["+K+"= "+J[1]+"]";}if(J=I.match(/^(-?\d*)?n(([+-])(\d+))?/)){if(J[1]=="-"){J[1]=-1;}var L=J[1]?Number(J[1]):1;var H=J[2]?Number(J[2]):0;N="[((#{fragment} - #{b}) mod #{a} = 0) and "+"((#{fragment} - #{b}) div #{a} >= 0)]";return new Template(N).evaluate({fragment:K,a:L,b:H});}}}},criteria:{tagName:'n = h.tagName(n, r, "#{1}", c);      c = false;',className:'n = h.className(n, r, "#{1}", c);    c = false;',id:'n = h.id(n, r, "#{1}", c);           c = false;',attrPresence:'n = h.attrPresence(n, r, "#{1}", c); c = false;',attr:function(B){B[3]=(B[5]||B[6]);return new Template('n = h.attr(n, r, "#{1}", "#{3}", "#{2}", c); c = false;').evaluate(B);},pseudo:function(B){if(B[6]){B[6]=B[6].replace(/"/g,'\\"');}return new Template('n = h.pseudo(n, "#{1}", "#{6}", r, c); c = false;').evaluate(B);},descendant:'c = "descendant";',child:'c = "child";',adjacent:'c = "adjacent";',laterSibling:'c = "laterSibling";'},patterns:{laterSibling:/^\s*~\s*/,child:/^\s*>\s*/,adjacent:/^\s*\+\s*/,descendant:/^\s/,tagName:/^\s*(\*|[\w\-]+)(\b|$)?/,id:/^#([\w\-\*]+)(\b|$)/,className:/^\.([\w\-\*]+)(\b|$)/,pseudo:/^:((first|last|nth|nth-last|only)(-child|-of-type)|empty|checked|(en|dis)abled|not)(\((.*?)\))?(\b|$|(?=\s|[:+~>]))/,attrPresence:/^\[((?:[\w]+:)?[\w]+)\]/,attr:/\[((?:[\w-]*:)?[\w-]+)\s*(?:([!^$*~|]?=)\s*((['"])([^\4]*?)\4|([^'"][^\]]*?)))?\]/},assertions:{tagName:function(C,D){return D[1].toUpperCase()==C.tagName.toUpperCase();},className:function(C,D){return Element.hasClassName(C,D[1]);},id:function(C,D){return C.id===D[1];},attrPresence:function(C,D){return Element.hasAttribute(C,D[1]);},attr:function(F,E){var D=Element.readAttribute(F,E[1]);return D&&Selector.operators[E[2]](D,E[5]||E[6]);}},handlers:{concat:function(H,E){for(var G=0,F;F=E[G];G++){H.push(F);}return H;},mark:function(E){var F=Prototype.emptyFunction;for(var H=0,G;G=E[H];H++){G._countedByPrototype=F;}return E;},unmark:function(D){for(var F=0,E;E=D[F];F++){E._countedByPrototype=undefined;}return D;},index:function(H,L,I){H._countedByPrototype=Prototype.emptyFunction;if(L){for(var N=H.childNodes,K=N.length-1,M=1;K>=0;K--){var J=N[K];if(J.nodeType==1&&(!I||J._countedByPrototype)){J.nodeIndex=M++;}}}else{for(var K=0,M=1,N=H.childNodes;J=N[K];K++){if(J.nodeType==1&&(!I||J._countedByPrototype)){J.nodeIndex=M++;}}}},unique:function(J){if(J.length==0){return J;}var H=[],G;for(var I=0,F=J.length;I<F;I++){if(!(G=J[I])._countedByPrototype){G._countedByPrototype=Prototype.emptyFunction;H.push(Element.extend(G));}}return Selector.handlers.unmark(H);},descendant:function(F){var H=Selector.handlers;for(var I=0,J=[],G;G=F[I];I++){H.concat(J,G.getElementsByTagName("*"));}return J;},child:function(H){var K=Selector.handlers;for(var L=0,M=[],J;J=H[L];L++){for(var N=0,I;I=J.childNodes[N];N++){if(I.nodeType==1&&I.tagName!="!"){M.push(I);}}}return M;},adjacent:function(F){for(var I=0,J=[],G;G=F[I];I++){var H=this.nextElementSibling(G);if(H){J.push(H);}}return J;},laterSibling:function(F){var H=Selector.handlers;for(var I=0,J=[],G;G=F[I];I++){H.concat(J,Element.nextSiblings(G));}return J;},nextElementSibling:function(B){while(B=B.nextSibling){if(B.nodeType==1){return B;}}return null;},previousElementSibling:function(B){while(B=B.previousSibling){if(B.nodeType==1){return B;}}return null;},tagName:function(M,O,K,L){var N=K.toUpperCase();var R=[],P=Selector.handlers;if(M){if(L){if(L=="descendant"){for(var Q=0,J;J=M[Q];Q++){P.concat(R,J.getElementsByTagName(K));}return R;}else{M=this[L](M);}if(K=="*"){return M;}}for(var Q=0,J;J=M[Q];Q++){if(J.tagName.toUpperCase()===N){R.push(J);}}return R;}else{return O.getElementsByTagName(K);}},id:function(P,I,J,L){var K=$(J),N=Selector.handlers;if(!K){return[];}if(!P&&I==document){return[K];}if(P){if(L){if(L=="child"){for(var O=0,M;M=P[O];O++){if(K.parentNode==M){return[K];}}}else{if(L=="descendant"){for(var O=0,M;M=P[O];O++){if(Element.descendantOf(K,M)){return[K];}}}else{if(L=="adjacent"){for(var O=0,M;M=P[O];O++){if(Selector.handlers.previousElementSibling(K)==M){return[K];}}}else{P=N[L](P);}}}}for(var O=0,M;M=P[O];O++){if(M==K){return[K];}}return[];}return(K&&Element.descendantOf(K,I))?[K]:[];},className:function(H,E,G,F){if(H&&F){H=this[F](H);}return Selector.handlers.byClassName(H,E,G);},byClassName:function(O,P,L){if(!O){O=Selector.handlers.descendant([P]);}var J=" "+L+" ";for(var M=0,N=[],K,I;K=O[M];M++){I=K.className;if(I.length==0){continue;}if(I==L||(" "+I+" ").load(J)){N.push(K);}}return N;},attrPresence:function(M,N,H,I){if(!M){M=N.getElementsByTagName("*");}if(M&&I){M=this[I](M);}var K=[];for(var L=0,J;J=M[L];L++){if(Element.hasAttribute(J,H)){K.push(J);}}return K;},attr:function(O,R,S,Q,M,N){if(!O){O=R.getElementsByTagName("*");}if(O&&N){O=this[N](O);}var P=Selector.operators[M],U=[];for(var V=0,L;L=O[V];V++){var T=Element.readAttribute(L,S);if(T===null){continue;}if(P(T,Q)){U.push(L);}}return U;},pseudo:function(J,I,G,F,H){if(J&&H){J=this[H](J);}if(!J){J=F.getElementsByTagName("*");}return Selector.pseudos[I](J,G,F);}},pseudos:{"first-child":function(L,H,G){for(var J=0,K=[],I;I=L[J];J++){if(Selector.handlers.previousElementSibling(I)){continue;}K.push(I);}return K;},"last-child":function(L,H,G){for(var J=0,K=[],I;I=L[J];J++){if(Selector.handlers.nextElementSibling(I)){continue;}K.push(I);}return K;},"only-child":function(N,I,H){var K=Selector.handlers;for(var L=0,M=[],J;J=N[L];L++){if(!K.previousElementSibling(J)&&!K.nextElementSibling(J)){M.push(J);}}return M;},"nth-child":function(F,E,D){return Selector.pseudos.nth(F,E,D);},"nth-last-child":function(F,E,D){return Selector.pseudos.nth(F,E,D,true);},"nth-of-type":function(F,E,D){return Selector.pseudos.nth(F,E,D,false,true);},"nth-last-of-type":function(F,E,D){return Selector.pseudos.nth(F,E,D,true,true);},"first-of-type":function(F,E,D){return Selector.pseudos.nth(F,"1",D,false,true);},"last-of-type":function(F,E,D){return Selector.pseudos.nth(F,"1",D,true,true);},"only-of-type":function(H,F,E){var G=Selector.pseudos;return G["last-of-type"](G["first-of-type"](H,F,E),F,E);},getIndices:function(F,D,E){if(F==0){return D>0?[D]:[];}return $R(1,E).inject([],function(B,A){if(0==(A-D)%F&&(A-D)/F>=0){B.push(A);}return B;});},nth:function(T,Y,W,Z,R){if(T.length==0){return[];}if(Y=="even"){Y="2n+0";}if(Y=="odd"){Y="2n+1";}var a=Selector.handlers,b=[],S=[],f;a.mark(T);for(var c=0,Q;Q=T[c];c++){if(!Q.parentNode._countedByPrototype){a.index(Q.parentNode,Z,R);S.push(Q.parentNode);}}if(Y.match(/^\d+$/)){Y=Number(Y);for(var c=0,Q;Q=T[c];c++){if(Q.nodeIndex==Y){b.push(Q);}}}else{if(f=Y.match(/^(-?\d*)?n(([+-])(\d+))?/)){if(f[1]=="-"){f[1]=-1;}var V=f[1]?Number(f[1]):1;var X=f[2]?Number(f[2]):0;var U=Selector.pseudos.getIndices(V,X,T.length);for(var c=0,Q,e=U.length;Q=T[c];c++){for(var d=0;d<e;d++){if(Q.nodeIndex==U[d]){b.push(Q);}}}}}a.unmark(T);a.unmark(S);return b;},"empty":function(L,H,G){for(var J=0,K=[],I;I=L[J];J++){if(I.tagName=="!"||I.firstChild){continue;}K.push(I);}return K;},"not":function(N,K,P){var R=Selector.handlers,O,L;var Q=new Selector(K).findElements(P);R.mark(Q);for(var S=0,T=[],M;M=N[S];S++){if(!M._countedByPrototype){T.push(M);}}R.unmark(Q);return T;},"enabled":function(L,H,G){for(var J=0,K=[],I;I=L[J];J++){if(!I.disabled&&(!I.type||I.type!=="hidden")){K.push(I);}}return K;},"disabled":function(L,H,G){for(var J=0,K=[],I;I=L[J];J++){if(I.disabled){K.push(I);}}return K;},"checked":function(L,H,G){for(var J=0,K=[],I;I=L[J];J++){if(I.checked){K.push(I);}}return K;}},operators:{"=":function(D,C){return D==C;},"!=":function(D,C){return D!=C;},"^=":function(D,C){return D==C||D&&D.startsWith(C);},"$=":function(D,C){return D==C||D&&D.endsWith(C);},"*=":function(D,C){return D==C||D&&D.load(C);},"$=":function(D,C){return D.endsWith(C);},"*=":function(D,C){return D.load(C);},"~=":function(D,C){return(" "+D+" ").load(" "+C+" ");},"|=":function(D,C){return("-"+(D||"").toUpperCase()+"-").load("-"+(C||"").toUpperCase()+"-");}},split:function(D){var C=[];D.scan(/(([\w#:.~>+()\s-]+|\*|\[.*?\])+)\s*(,|$)/,function(A){C.push(A[1].strip());});return C;},matchElements:function(J,I){var K=$$(I),L=Selector.handlers;L.mark(K);for(var M=0,N=[],H;H=J[M];M++){if(H._countedByPrototype){N.push(H);}}L.unmark(K);return N;},findElement:function(F,E,D){if(Object.isNumber(E)){D=E;E=false;}return Selector.matchElements(F,E||"*")[D||0];},findChildElements:function(K,I){I=Selector.split(I.join(","));var L=[],J=Selector.handlers;for(var M=0,N=I.length,H;M<N;M++){H=new Selector(I[M].strip());J.concat(L,H.findElements(K));}return(N>1)?J.unique(L):L;}});if(Prototype.Browser.IE){Object.extend(Selector.handlers,{concat:function(H,E){for(var G=0,F;F=E[G];G++){if(F.tagName!=="!"){H.push(F);}}return H;},unmark:function(D){for(var F=0,E;E=D[F];F++){E.removeAttribute("_countedByPrototype");}return D;}});}function $$(){return Selector.findChildElements(document,$A(arguments));}var Form={reset:function(B){$(B).reset();return B;},serializeElements:function(I,N){if(typeof N!="object"){N={hash:!!N};}else{if(Object.isUndefined(N.hash)){N.hash=true;}}var M,J,H=false,K=N.submit;var L=I.inject({},function(B,A){if(!A.disabled&&A.name){M=A.name;J=$(A).getValue();if(J!=null&&A.type!="file"&&(A.type!="submit"||(!H&&K!==false&&(!K||M==K)&&(H=true)))){if(M in B){if(!Object.isArray(B[M])){B[M]=[B[M]];}B[M].push(J);}else{B[M]=J;}}}return B;});return N.hash?L:Object.toQueryString(L);}};Form.Methods={serialize:function(D,C){return Form.serializeElements(Form.getElements(D),C);},getElements:function(B){return $A($(B).getElementsByTagName("*")).inject([],function(D,A){if(Form.Element.Serializers[A.tagName.toLowerCase()]){D.push(Element.extend(A));}return D;});},getInputs:function(K,O,N){K=$(K);var I=K.getElementsByTagName("input");if(!O&&!N){return $A(I).map(Element.extend);}for(var M=0,J=[],L=I.length;M<L;M++){var P=I[M];if((O&&P.type!=O)||(N&&P.name!=N)){continue;}J.push(Element.extend(P));}return J;},disable:function(B){B=$(B);Form.getElements(B).invoke("disable");return B;},enable:function(B){B=$(B);Form.getElements(B).invoke("enable");return B;},findFirstElement:function(F){var E=$(F).getElements().findAll(function(A){return"hidden"!=A.type&&!A.disabled;});var D=E.findAll(function(A){return A.hasAttribute("tabIndex")&&A.tabIndex>=0;}).sortBy(function(A){return A.tabIndex;}).first();return D?D:E.find(function(A){return["input","select","textarea"].load(A.tagName.toLowerCase());});},focusFirstElement:function(B){B=$(B);B.findFirstElement().activate();return B;},request:function(H,E){H=$(H),E=Object.clone(E||{});var F=E.parameters,G=H.readAttribute("action")||"";if(G.blank()){G=window.location.href;}E.parameters=H.serialize(true);if(F){if(Object.isString(F)){F=F.toQueryParams();}Object.extend(E.parameters,F);}if(H.hasAttribute("method")&&!E.method){E.method=H.method;}return new Ajax.Request(G,E);}};Form.Element={focus:function(B){$(B).focus();return B;},select:function(B){$(B).select();return B;}};Form.Element.Methods={serialize:function(D){D=$(D);if(!D.disabled&&D.name){var F=D.getValue();if(F!=undefined){var E={};E[D.name]=F;return Object.toQueryString(E);}}return"";},getValue:function(C){C=$(C);var D=C.tagName.toLowerCase();return Form.Element.Serializers[D](C);},setValue:function(D,F){D=$(D);var E=D.tagName.toLowerCase();Form.Element.Serializers[E](D,F);return D;},clear:function(B){$(B).value="";return B;},present:function(B){return $(B).value!="";},activate:function(C){C=$(C);try{C.focus();if(C.select&&(C.tagName.toLowerCase()!="input"||!["button","reset","submit"].load(C.type))){C.select();}}catch(D){}return C;},disable:function(B){B=$(B);B.disabled=true;return B;},enable:function(B){B=$(B);B.disabled=false;return B;}};var Field=Form.Element;var $F=Form.Element.Methods.getValue;Form.Element.Serializers={input:function(C,D){switch(C.type.toLowerCase()){case"checkbox":case"radio":return Form.Element.Serializers.inputSelector(C,D);default:return Form.Element.Serializers.textarea(C,D);}},inputSelector:function(C,D){if(Object.isUndefined(D)){return C.checked?C.value:null;}else{C.checked=!!D;}},textarea:function(C,D){if(Object.isUndefined(D)){return C.value;}else{C.value=D;}},select:function(M,J){if(Object.isUndefined(J)){return this[M.type=="select-one"?"selectOne":"selectMany"](M);}else{var N,L,I=!Object.isArray(J);for(var H=0,K=M.length;H<K;H++){N=M.options[H];L=this.optionValue(N);if(I){if(L==J){N.selected=true;return;}}else{N.selected=J.load(L);}}}},selectOne:function(D){var C=D.selectedIndex;return C>=0?this.optionValue(D.options[C]):null;},selectMany:function(H){var F,G=H.length;if(!G){return null;}for(var I=0,F=[];I<G;I++){var J=H.options[I];if(J.selected){F.push(this.optionValue(J));}}return F;},optionValue:function(B){return Element.extend(B).hasAttribute("value")?B.value:B.text;}};Abstract.TimedObserver=Class.create(PeriodicalExecuter,{initialize:function($super,D,F,E){$super(E,F);this.element=$(D);this.lastValue=this.getValue();},execute:function(){var B=this.getValue();if(Object.isString(this.lastValue)&&Object.isString(B)?this.lastValue!=B:String(this.lastValue)!=String(B)){this.callback(this.element,B);this.lastValue=B;}}});Form.Element.Observer=Class.create(Abstract.TimedObserver,{getValue:function(){return Form.Element.getValue(this.element);}});Form.Observer=Class.create(Abstract.TimedObserver,{getValue:function(){return Form.serialize(this.element);}});Abstract.EventObserver=Class.create({initialize:function(C,D){this.element=$(C);this.callback=D;this.lastValue=this.getValue();if(this.element.tagName.toLowerCase()=="form"){this.registerFormCallbacks();}else{this.registerCallback(this.element);}},onElementEvent:function(){var B=this.getValue();if(this.lastValue!=B){this.callback(this.element,B);this.lastValue=B;}},registerFormCallbacks:function(){Form.getElements(this.element).each(this.registerCallback,this);},registerCallback:function(B){if(B.type){switch(B.type.toLowerCase()){case"checkbox":case"radio":Event.observe(B,"click",this.onElementEvent.bind(this));break;default:Event.observe(B,"change",this.onElementEvent.bind(this));break;}}}});Form.Element.EventObserver=Class.create(Abstract.EventObserver,{getValue:function(){return Form.Element.getValue(this.element);}});Form.EventObserver=Class.create(Abstract.EventObserver,{getValue:function(){return Form.serialize(this.element);}});if(!window.Event){var Event={};}Object.extend(Event,{KEY_BACKSPACE:8,KEY_TAB:9,KEY_RETURN:13,KEY_ESC:27,KEY_LEFT:37,KEY_UP:38,KEY_RIGHT:39,KEY_DOWN:40,KEY_DELETE:46,KEY_HOME:36,KEY_END:35,KEY_PAGEUP:33,KEY_PAGEDOWN:34,KEY_INSERT:45,cache:{},relatedTarget:function(D){var C;switch(D.type){case"mouseover":C=D.fromElement;break;case"mouseout":C=D.toElement;break;default:return null;}return Element.extend(C);}});Event.Methods=(function(){var C;if(Prototype.Browser.IE){var D={0:1,1:4,2:2};C=function(A,B){return A.button==D[B];};}else{if(Prototype.Browser.WebKit){C=function(A,B){switch(B){case 0:return A.which==1&&!A.metaKey;case 1:return A.which==1&&A.metaKey;default:return false;}};}else{C=function(A,B){return A.which?(A.which===B+1):(A.button===B);};}}return{isLeftClick:function(A){return C(A,0);},isMiddleClick:function(A){return C(A,1);},isRightClick:function(A){return C(A,2);},element:function(B){B=Event.extend(B);var G=B.target,H=B.type,A=B.currentTarget;if(A&&A.tagName){if(H==="load"||H==="error"||(H==="click"&&A.tagName.toLowerCase()==="input"&&A.type==="radio")){G=A;}}if(G.nodeType==Node.TEXT_NODE){G=G.parentNode;}return Element.extend(G);},findElement:function(G,A){var H=Event.element(G);if(!A){return H;}var B=[H].concat(H.ancestors());return Selector.findElement(B,A,0);},pointer:function(A){var B=document.documentElement,F=document.body||{scrollLeft:0,scrollTop:0};return{x:A.pageX||(A.clientX+(B.scrollLeft||F.scrollLeft)-(B.clientLeft||0)),y:A.pageY||(A.clientY+(B.scrollTop||F.scrollTop)-(B.clientTop||0))};},pointerX:function(A){return Event.pointer(A).x;},pointerY:function(A){return Event.pointer(A).y;},stop:function(A){Event.extend(A);A.preventDefault();A.stopPropagation();A.stopped=true;}};})();Event.extend=(function(){var B=Object.keys(Event.Methods).inject({},function(D,A){D[A]=Event.Methods[A].methodize();return D;});if(Prototype.Browser.IE){Object.extend(B,{stopPropagation:function(){this.cancelBubble=true;},preventDefault:function(){this.returnValue=false;},inspect:function(){return"[object Event]";}});return function(D){if(!D){return false;}if(D._extendedByPrototype){return D;}D._extendedByPrototype=Prototype.emptyFunction;var A=Event.pointer(D);Object.extend(D,{target:D.srcElement,relatedTarget:Event.relatedTarget(D),pageX:A.x,pageY:A.y});return Object.extend(D,B);};}else{Event.prototype=Event.prototype||document.createEvent("HTMLEvents")["__proto__"];Object.extend(Event.prototype,B);return Prototype.K;}})();Object.extend(Event,(function(){var L=Event.cache;function K(A){if(A._prototypeEventID){return A._prototypeEventID[0];}arguments.callee.id=arguments.callee.id||1;return A._prototypeEventID=[++arguments.callee.id];}function P(A){if(A&&A.load(":")){return"dataavailable";}return A;}function M(A){return L[A]=L[A]||{};}function Q(A,C){var B=M(A);return B[C]=B[C]||[];}function O(B,C,A){var D=K(B);var E=Q(D,C);if(E.pluck("handler").load(A)){return false;}var F=function(G){if(!Event||!Event.extend||(G.eventName&&G.eventName!=C)){return false;}Event.extend(G);A.call(B,G);};F.handler=A;E.push(F);return F;}function N(D,C,B){var A=Q(D,C);return A.find(function(E){return E.handler==B;});}function J(D,C,B){var A=M(D);if(!A[C]){return false;}A[C]=A[C].without(N(D,C,B));}function R(){for(var A in L){for(var B in L[A]){L[A][B]=null;}}}if(window.attachEvent){window.attachEvent("onunload",R);}if(Prototype.Browser.WebKit){window.addEventListener("unload",Prototype.emptyFunction,false);}return{observe:function(A,C,E){A=$(A);var B=P(C);var D=O(A,C,E);if(!D){return A;}if(A.addEventListener){A.addEventListener(B,D,false);}else{A.attachEvent("on"+B,D);}return A;},stopObserving:function(A,C,F){A=$(A);var D=K(A),B=P(C);if(!F&&C){Q(D,C).each(function(G){A.stopObserving(C,G.handler);});return A;}else{if(!C){Object.keys(M(D)).each(function(G){A.stopObserving(G);});return A;}}var E=N(D,C,F);if(!E){return A;}if(A.removeEventListener){A.removeEventListener(B,E,false);}else{A.detachEvent("on"+B,E);}J(D,C,F);return A;},fire:function(A,B,C){A=$(A);if(A==document&&document.createEvent&&!A.dispatchEvent){A=document.documentElement;}var D;if(document.createEvent){D=document.createEvent("HTMLEvents");D.initEvent("dataavailable",true,true);}else{D=document.createEventObject();D.eventType="ondataavailable";}D.eventName=B;D.memo=C||{};if(document.createEvent){A.dispatchEvent(D);}else{A.fireEvent(D.eventType,D);}return Event.extend(D);}};})());Object.extend(Event,Event.Methods);Element.addMethods({fire:Event.fire,observe:Event.observe,stopObserving:Event.stopObserving});Object.extend(document,{fire:Element.Methods.fire.methodize(),observe:Element.Methods.observe.methodize(),stopObserving:Element.Methods.stopObserving.methodize(),loaded:false});(function(){var D;function C(){if(document.loaded){return;}if(D){window.clearInterval(D);}document.fire("dom:loaded");document.loaded=true;}if(document.addEventListener){if(Prototype.Browser.WebKit){D=window.setInterval(function(){if(/loaded|complete/.test(document.readyState)){C();}},0);Event.observe(window,"load",C);}else{document.addEventListener("DOMContentLoaded",C,false);}}else{document.write("<script id=__onDOMContentLoaded defer src=//:><\/script>");$("__onDOMContentLoaded").onreadystatechange=function(){if(this.readyState=="complete"){this.onreadystatechange=null;C();}};}})();Hash.toQueryString=Object.toQueryString;var Toggle={display:Element.toggle};Element.Methods.childOf=Element.Methods.descendantOf;var Insertion={Before:function(C,D){return Element.insert(C,{before:D});},Top:function(C,D){return Element.insert(C,{top:D});},Bottom:function(C,D){return Element.insert(C,{bottom:D});},After:function(C,D){return Element.insert(C,{after:D});}};var $continue=new Error('"throw $continue" is deprecated, use "return" instead');var Position={includeScrollOffsets:false,prepare:function(){this.deltaX=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0;this.deltaY=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0;},within:function(F,D,E){if(this.includeScrollOffsets){return this.withinIncludingScrolloffsets(F,D,E);}this.xcomp=D;this.ycomp=E;this.offset=Element.cumulativeOffset(F);return(E>=this.offset[1]&&E<this.offset[1]+F.offsetHeight&&D>=this.offset[0]&&D<this.offset[0]+F.offsetWidth);},withinIncludingScrolloffsets:function(H,E,F){var G=Element.cumulativeScrollOffset(H);this.xcomp=E+G[0]-this.deltaX;this.ycomp=F+G[1]-this.deltaY;this.offset=Element.cumulativeOffset(H);return(this.ycomp>=this.offset[1]&&this.ycomp<this.offset[1]+H.offsetHeight&&this.xcomp>=this.offset[0]&&this.xcomp<this.offset[0]+H.offsetWidth);},overlap:function(D,C){if(!D){return 0;}if(D=="vertical"){return((this.offset[1]+C.offsetHeight)-this.ycomp)/C.offsetHeight;}if(D=="horizontal"){return((this.offset[0]+C.offsetWidth)-this.xcomp)/C.offsetWidth;}},cumulativeOffset:Element.Methods.cumulativeOffset,positionedOffset:Element.Methods.positionedOffset,absolutize:function(B){Position.prepare();return Element.absolutize(B);},relativize:function(B){Position.prepare();return Element.relativize(B);},realOffset:Element.Methods.cumulativeScrollOffset,offsetParent:Element.Methods.getOffsetParent,page:Element.Methods.viewportOffset,clone:function(F,E,D){D=D||{};return Element.clonePosition(E,F,D);}};if(!document.getElementsByClassName){document.getElementsByClassName=function(D){function C(A){return A.blank()?null:"[contains(concat(' ', @class, ' '), ' "+A+" ')]";}D.getElementsByClassName=Prototype.BrowserFeatures.XPath?function(F,A){A=A.toString().strip();var B=/\s/.test(A)?$w(A).map(C).join(""):C(A);return B?document._getElementsByXPath(".//*"+B,F):[];}:function(N,M){M=M.toString().strip();var L=[],K=(/\s/.test(M)?$w(M):null);if(!K&&!M){return L;}var P=$(N).getElementsByTagName("*");M=" "+M+" ";for(var O=0,A,B;A=P[O];O++){if(A.className&&(B=" "+A.className+" ")&&(B.load(M)||(K&&K.all(function(E){return !E.toString().blank()&&B.load(" "+E+" ");})))){L.push(Element.extend(A));}}return L;};return function(A,B){return $(B||document.body).getElementsByClassName(A);};}(Element.Methods);}Element.ClassNames=Class.create();Element.ClassNames.prototype={initialize:function(B){this.element=$(B);},_each:function(B){this.element.className.split(/\s+/).select(function(A){return A.length>0;})._each(B);},set:function(B){this.element.className=B;},add:function(B){if(this.load(B)){return;}this.set($A(this).concat(B).join(" "));},remove:function(B){if(!this.load(B)){return;}this.set($A(this).without(B).join(" "));},toString:function(){return $A(this).join(" ");}};Object.extend(Element.ClassNames.prototype,Enumerable);Element.addMethods();var Builder={NODEMAP:{AREA:"map",CAPTION:"table",COL:"table",COLGROUP:"table",LEGEND:"fieldset",OPTGROUP:"select",OPTION:"select",PARAM:"object",TBODY:"table",TD:"table",TFOOT:"table",TH:"table",THEAD:"table",TR:"table"},node:function(G){G=G.toUpperCase();var H=this.NODEMAP[G]||"div";var L=document.createElement(H);try{L.innerHTML="<"+G+"></"+G+">";}catch(I){}var J=L.firstChild||null;if(J&&(J.tagName.toUpperCase()!=G)){J=J.getElementsByTagName(G)[0];}if(!J){J=document.createElement(G);}if(!J){return;}if(arguments[1]){if(this._isStringOrNumber(arguments[1])||(arguments[1] instanceof Array)||arguments[1].tagName){this._children(J,arguments[1]);}else{var K=this._attributes(arguments[1]);if(K.length){try{L.innerHTML="<"+G+" "+K+"></"+G+">";}catch(I){}J=L.firstChild||null;if(!J){J=document.createElement(G);for(attr in arguments[1]){J[attr=="class"?"className":attr]=arguments[1][attr];}}if(J.tagName.toUpperCase()!=G){J=L.getElementsByTagName(G)[0];}}}}if(arguments[2]){this._children(J,arguments[2]);}return $(J);},_text:function(B){return document.createTextNode(B);},ATTR_MAP:{"className":"class","htmlFor":"for"},_attributes:function(C){var D=[];for(attribute in C){D.push((attribute in this.ATTR_MAP?this.ATTR_MAP[attribute]:attribute)+'="'+C[attribute].toString().escapeHTML().gsub(/"/,"&quot;")+'"');}return D.join(" ");},_children:function(D,C){if(C.tagName){D.appendChild(C);return;}if(typeof C=="object"){C.flatten().each(function(A){if(typeof A=="object"){D.appendChild(A);}else{if(Builder._isStringOrNumber(A)){D.appendChild(Builder._text(A));}}});}else{if(Builder._isStringOrNumber(C)){D.appendChild(Builder._text(C));}}},_isStringOrNumber:function(B){return(typeof B=="string"||typeof B=="number");},build:function(D){var C=this.node("div");$(C).update(D.strip());return C.down();},dump:function(D){if(typeof D!="object"&&typeof D!="function"){D=window;}var C=("A ABBR ACRONYM ADDRESS APPLET AREA B BASE BASEFONT BDO BIG BLOCKQUOTE BODY "+"BR BUTTON CAPTION CENTER CITE CODE COL COLGROUP DD DEL DFN DIR DIV DL DT EM FIELDSET "+"FONT FORM FRAME FRAMESET H1 H2 H3 H4 H5 H6 HEAD HR HTML I IFRAME IMG INPUT INS ISINDEX "+"KBD LABEL LEGEND LI LINK MAP MENU META NOFRAMES NOSCRIPT OBJECT OL OPTGROUP OPTION P "+"PARAM PRE Q S SAMP SCRIPT SELECT SMALL SPAN STRIKE STRONG STYLE SUB SUP TABLE TBODY TD "+"TEXTAREA TFOOT TH THEAD TITLE TR TT U UL VAR").split(/\s+/);C.each(function(A){D[A]=function(){return Builder.node.apply(Builder,[A].concat($A(arguments)));};});}};String.prototype.parseColor=function(){var D="#";if(this.slice(0,4)=="rgb("){var E=this.slice(4,this.length-1).split(",");var F=0;do{D+=parseInt(E[F]).toColorPart();}while(++F<3);}else{if(this.slice(0,1)=="#"){if(this.length==4){for(var F=1;F<4;F++){D+=(this.charAt(F)+this.charAt(F)).toLowerCase();}}if(this.length==7){D=this.toLowerCase();}}}return(D.length==7?D:(arguments[0]||this));};Element.collectTextNodes=function(B){return $A($(B).childNodes).collect(function(A){return(A.nodeType==3?A.nodeValue:(A.hasChildNodes()?Element.collectTextNodes(A):""));}).flatten().join("");};Element.collectTextNodesIgnoreClass=function(C,D){return $A($(C).childNodes).collect(function(A){return(A.nodeType==3?A.nodeValue:((A.hasChildNodes()&&!Element.hasClassName(A,D))?Element.collectTextNodesIgnoreClass(A,D):""));}).flatten().join("");};Element.setContentZoom=function(C,D){C=$(C);C.setStyle({fontSize:(D/100)+"em"});if(Prototype.Browser.WebKit){window.scrollBy(0,0);}return C;};Element.getInlineOpacity=function(B){return $(B).style.opacity||"";};Element.forceRerendering=function(D){try{D=$(D);var E=document.createTextNode(" ");D.appendChild(E);D.removeChild(E);}catch(F){}};var Effect={_elementDoesNotExistError:{name:"ElementDoesNotExistError",message:"The specified DOM element does not exist, but is required for this effect to operate"},Transitions:{linear:Prototype.K,sinoidal:function(B){return(-Math.cos(B*Math.PI)/2)+0.5;},reverse:function(B){return 1-B;},flicker:function(B){var B=((-Math.cos(B*Math.PI)/4)+0.75)+Math.random()/4;return B>1?1:B;},wobble:function(B){return(-Math.cos(B*Math.PI*(9*B))/2)+0.5;},pulse:function(D,C){return(-Math.cos((D*((C||5)-0.5)*2)*Math.PI)/2)+0.5;},spring:function(B){return 1-(Math.cos(B*4.5*Math.PI)*Math.exp(-B*6));},none:function(B){return 0;},full:function(B){return 1;}},DefaultOptions:{duration:1,fps:100,sync:false,from:0,to:1,delay:0,queue:"parallel"},tagifyText:function(C){var D="position:relative";if(Prototype.Browser.IE){D+=";zoom:1";}C=$(C);$A(C.childNodes).each(function(A){if(A.nodeType==3){A.nodeValue.toArray().each(function(B){C.insertBefore(new Element("span",{style:D}).update(B==" "?String.fromCharCode(160):B),A);});Element.remove(A);}});},multiple:function(J,I){var G;if(((typeof J=="object")||Object.isFunction(J))&&(J.length)){G=J;}else{G=$(J).childNodes;}var F=Object.extend({speed:0.1,delay:0},arguments[2]||{});var H=F.delay;$A(G).each(function(A,B){new I(A,Object.extend(F,{delay:B*F.speed+H}));});},PAIRS:{"slide":["SlideDown","SlideUp"],"blind":["BlindDown","BlindUp"],"appear":["Appear","Fade"]},toggle:function(F,E){F=$(F);E=(E||"appear").toLowerCase();var D=Object.extend({queue:{position:"end",scope:(F.id||"global"),limit:1}},arguments[2]||{});Effect[F.visible()?Effect.PAIRS[E][1]:Effect.PAIRS[E][0]](F,D);}};Effect.DefaultOptions.transition=Effect.Transitions.sinoidal;Effect.ScopedQueue=Class.create(Enumerable,{initialize:function(){this.effects=[];this.interval=null;},_each:function(B){this.effects._each(B);},add:function(F){var E=new Date().getTime();var D=Object.isString(F.options.queue)?F.options.queue:F.options.queue.position;switch(D){case"front":this.effects.findAll(function(A){return A.state=="idle";}).each(function(A){A.startOn+=F.finishOn;A.finishOn+=F.finishOn;});break;case"with-last":E=this.effects.pluck("startOn").max()||E;break;case"end":E=this.effects.pluck("finishOn").max()||E;break;}F.startOn+=E;F.finishOn+=E;if(!F.options.queue.limit||(this.effects.length<F.options.queue.limit)){this.effects.push(F);}if(!this.interval){this.interval=setInterval(this.loop.bind(this),15);}},remove:function(B){this.effects=this.effects.reject(function(A){return A==B;});if(this.effects.length==0){clearInterval(this.interval);this.interval=null;}},loop:function(){var E=new Date().getTime();for(var F=0,D=this.effects.length;F<D;F++){this.effects[F]&&this.effects[F].loop(E);}}});Effect.Queues={instances:$H(),get:function(B){if(!Object.isString(B)){return B;}return this.instances.get(B)||this.instances.set(B,new Effect.ScopedQueue());}};Effect.Queue=Effect.Queues.get("global");Effect.Base=Class.create({position:null,start:function(C){function D(A,B){return((A[B+"Internal"]?"this.options."+B+"Internal(this);":"")+(A[B]?"this.options."+B+"(this);":""));}if(C&&C.transition===false){C.transition=Effect.Transitions.linear;}this.options=Object.extend(Object.extend({},Effect.DefaultOptions),C||{});this.currentFrame=0;this.state="idle";this.startOn=this.options.delay*1000;this.finishOn=this.startOn+(this.options.duration*1000);this.fromToDelta=this.options.to-this.options.from;this.totalTime=this.finishOn-this.startOn;this.totalFrames=this.options.fps*this.options.duration;this.render=(function(){function A(B,F){if(B.options[F+"Internal"]){B.options[F+"Internal"](B);}if(B.options[F]){B.options[F](B);}}return function(B){if(this.state==="idle"){this.state="running";A(this,"beforeSetup");if(this.setup){this.setup();}A(this,"afterSetup");}if(this.state==="running"){B=(this.options.transition(B)*this.fromToDelta)+this.options.from;this.position=B;A(this,"beforeUpdate");if(this.update){this.update(B);}A(this,"afterUpdate");}};})();this.event("beforeStart");if(!this.options.sync){Effect.Queues.get(Object.isString(this.options.queue)?"global":this.options.queue.scope).add(this);}},loop:function(E){if(E>=this.startOn){if(E>=this.finishOn){this.render(1);this.cancel();this.event("beforeFinish");if(this.finish){this.finish();}this.event("afterFinish");return;}var F=(E-this.startOn)/this.totalTime,D=(F*this.totalFrames).round();if(D>this.currentFrame){this.render(F);this.currentFrame=D;}}},cancel:function(){if(!this.options.sync){Effect.Queues.get(Object.isString(this.options.queue)?"global":this.options.queue.scope).remove(this);}this.state="finished";},event:function(B){if(this.options[B+"Internal"]){this.options[B+"Internal"](this);}if(this.options[B]){this.options[B](this);}},inspect:function(){var B=$H();for(property in this){if(!Object.isFunction(this[property])){B.set(property,this[property]);}}return"#<Effect:"+B.inspect()+",options:"+$H(this.options).inspect()+">";}});Effect.Parallel=Class.create(Effect.Base,{initialize:function(B){this.effects=B||[];this.start(arguments[1]);},update:function(B){this.effects.invoke("render",B);},finish:function(B){this.effects.each(function(A){A.render(1);A.cancel();A.event("beforeFinish");if(A.finish){A.finish(B);}A.event("afterFinish");});}});Effect.Tween=Class.create(Effect.Base,{initialize:function(K,H,I){K=Object.isString(K)?$(K):K;var L=$A(arguments),J=L.last(),G=L.length==5?L[3]:null;this.method=Object.isFunction(J)?J.bind(K):Object.isFunction(K[J])?K[J].bind(K):function(A){K[J]=A;};this.start(Object.extend({from:H,to:I},G||{}));},update:function(B){this.method(B);}});Effect.Event=Class.create(Effect.Base,{initialize:function(){this.start(Object.extend({duration:0},arguments[0]||{}));},update:Prototype.emptyFunction});Effect.Opacity=Class.create(Effect.Base,{initialize:function(D){this.element=$(D);if(!this.element){throw (Effect._elementDoesNotExistError);}if(Prototype.Browser.IE&&(!this.element.currentStyle.hasLayout)){this.element.setStyle({zoom:1});}var C=Object.extend({from:this.element.getOpacity()||0,to:1},arguments[1]||{});this.start(C);},update:function(B){this.element.setOpacity(B);}});Effect.Move=Class.create(Effect.Base,{initialize:function(D){this.element=$(D);if(!this.element){throw (Effect._elementDoesNotExistError);}var C=Object.extend({x:0,y:0,mode:"relative"},arguments[1]||{});this.start(C);},setup:function(){this.element.makePositioned();this.originalLeft=parseFloat(this.element.getStyle("left")||"0");this.originalTop=parseFloat(this.element.getStyle("top")||"0");if(this.options.mode=="absolute"){this.options.x=this.options.x-this.originalLeft;this.options.y=this.options.y-this.originalTop;}},update:function(B){this.element.setStyle({left:(this.options.x*B+this.originalLeft).round()+"px",top:(this.options.y*B+this.originalTop).round()+"px"});}});Effect.MoveBy=function(F,D,E){return new Effect.Move(F,Object.extend({x:E,y:D},arguments[3]||{}));};Effect.Scale=Class.create(Effect.Base,{initialize:function(F,E){this.element=$(F);if(!this.element){throw (Effect._elementDoesNotExistError);}var D=Object.extend({scaleX:true,scaleY:true,scaleContent:true,scaleFromCenter:false,scaleMode:"box",scaleFrom:100,scaleTo:E},arguments[2]||{});this.start(D);},setup:function(){this.restoreAfterFinish=this.options.restoreAfterFinish||false;this.elementPositioning=this.element.getStyle("position");this.originalStyle={};["top","left","width","height","fontSize"].each(function(A){this.originalStyle[A]=this.element.style[A];}.bind(this));this.originalTop=this.element.offsetTop;this.originalLeft=this.element.offsetLeft;var B=this.element.getStyle("font-size")||"100%";["em","px","%","pt"].each(function(A){if(B.indexOf(A)>0){this.fontSize=parseFloat(B);this.fontSizeType=A;}}.bind(this));this.factor=(this.options.scaleTo-this.options.scaleFrom)/100;this.dims=null;if(this.options.scaleMode=="box"){this.dims=[this.element.offsetHeight,this.element.offsetWidth];}if(/^content/.test(this.options.scaleMode)){this.dims=[this.element.scrollHeight,this.element.scrollWidth];}if(!this.dims){this.dims=[this.options.scaleMode.originalHeight,this.options.scaleMode.originalWidth];}},update:function(C){var D=(this.options.scaleFrom/100)+(this.factor*C);if(this.options.scaleContent&&this.fontSize){this.element.setStyle({fontSize:this.fontSize*D+this.fontSizeType});}this.setDimensions(this.dims[0]*D,this.dims[1]*D);},finish:function(B){if(this.restoreAfterFinish){this.element.setStyle(this.originalStyle);}},setDimensions:function(F,H){var G={};if(this.options.scaleX){G.width=H.round()+"px";}if(this.options.scaleY){G.height=F.round()+"px";}if(this.options.scaleFromCenter){var I=(F-this.dims[0])/2;var J=(H-this.dims[1])/2;if(this.elementPositioning=="absolute"){if(this.options.scaleY){G.top=this.originalTop-I+"px";}if(this.options.scaleX){G.left=this.originalLeft-J+"px";}}else{if(this.options.scaleY){G.top=-I+"px";}if(this.options.scaleX){G.left=-J+"px";}}}this.element.setStyle(G);}});Effect.Highlight=Class.create(Effect.Base,{initialize:function(D){this.element=$(D);if(!this.element){throw (Effect._elementDoesNotExistError);}var C=Object.extend({startcolor:"#ffff99"},arguments[1]||{});this.start(C);},setup:function(){if(this.element.getStyle("display")=="none"){this.cancel();return;}this.oldStyle={};if(!this.options.keepBackgroundImage){this.oldStyle.backgroundImage=this.element.getStyle("background-image");this.element.setStyle({backgroundImage:"none"});}if(!this.options.endcolor){this.options.endcolor=this.element.getStyle("background-color").parseColor("#ffffff");}if(!this.options.restorecolor){this.options.restorecolor=this.element.getStyle("background-color");}this._base=$R(0,2).map(function(B){return parseInt(this.options.startcolor.slice(B*2+1,B*2+3),16);}.bind(this));this._delta=$R(0,2).map(function(B){return parseInt(this.options.endcolor.slice(B*2+1,B*2+3),16)-this._base[B];}.bind(this));},update:function(B){this.element.setStyle({backgroundColor:$R(0,2).inject("#",function(F,E,A){return F+((this._base[A]+(this._delta[A]*B)).round().toColorPart());}.bind(this))});},finish:function(){this.element.setStyle(Object.extend(this.oldStyle,{backgroundColor:this.options.restorecolor}));}});Effect.ScrollTo=function(G){var H=arguments[1]||{},E=document.viewport.getScrollOffsets(),F=$(G).cumulativeOffset();if(H.offset){F[1]+=H.offset;}return new Effect.Tween(null,E.top,F[1],H,function(A){scrollTo(E.left,A.round());});};Effect.Fade=function(E){E=$(E);var D=E.getInlineOpacity();var F=Object.extend({from:E.getOpacity()||1,to:0,afterFinishInternal:function(A){if(A.options.to!=0){return;}A.element.hide().setStyle({opacity:D});}},arguments[1]||{});return new Effect.Opacity(E,F);};Effect.Appear=function(D){D=$(D);var C=Object.extend({from:(D.getStyle("display")=="none"?0:D.getOpacity()||0),to:1,afterFinishInternal:function(A){A.element.forceRerendering();},beforeSetup:function(A){A.element.setOpacity(A.options.from).show();}},arguments[1]||{});return new Effect.Opacity(D,C);};Effect.Puff=function(D){D=$(D);var C={opacity:D.getInlineOpacity(),position:D.getStyle("position"),top:D.style.top,left:D.style.left,width:D.style.width,height:D.style.height};return new Effect.Parallel([new Effect.Scale(D,200,{sync:true,scaleFromCenter:true,scaleContent:true,restoreAfterFinish:true}),new Effect.Opacity(D,{sync:true,to:0})],Object.extend({duration:1,beforeSetupInternal:function(A){Position.absolutize(A.effects[0].element);},afterFinishInternal:function(A){A.effects[0].element.hide().setStyle(C);}},arguments[1]||{}));};Effect.BlindUp=function(B){B=$(B);B.makeClipping();return new Effect.Scale(B,0,Object.extend({scaleContent:false,scaleX:false,restoreAfterFinish:true,afterFinishInternal:function(A){A.element.hide().undoClipping();}},arguments[1]||{}));};Effect.BlindDown=function(D){D=$(D);var C=D.getDimensions();return new Effect.Scale(D,100,Object.extend({scaleContent:false,scaleX:false,scaleFrom:0,scaleMode:{originalHeight:C.height,originalWidth:C.width},restoreAfterFinish:true,afterSetup:function(A){A.element.makeClipping().setStyle({height:"0px"}).show();},afterFinishInternal:function(A){A.element.undoClipping();}},arguments[1]||{}));};Effect.SwitchOff=function(D){D=$(D);var C=D.getInlineOpacity();return new Effect.Appear(D,Object.extend({duration:0.4,from:0,transition:Effect.Transitions.flicker,afterFinishInternal:function(A){new Effect.Scale(A.element,1,{duration:0.3,scaleFromCenter:true,scaleX:false,scaleContent:false,restoreAfterFinish:true,beforeSetup:function(B){B.element.makePositioned().makeClipping();},afterFinishInternal:function(B){B.element.hide().undoClipping().undoPositioned().setStyle({opacity:C});}});}},arguments[1]||{}));};Effect.DropOut=function(D){D=$(D);var C={top:D.getStyle("top"),left:D.getStyle("left"),opacity:D.getInlineOpacity()};return new Effect.Parallel([new Effect.Move(D,{x:0,y:100,sync:true}),new Effect.Opacity(D,{sync:true,to:0})],Object.extend({duration:0.5,beforeSetup:function(A){A.effects[0].element.makePositioned();},afterFinishInternal:function(A){A.effects[0].element.hide().undoPositioned().setStyle(C);}},arguments[1]||{}));};Effect.Shake=function(H){H=$(H);var J=Object.extend({distance:20,duration:0.5},arguments[1]||{});var G=parseFloat(J.distance);var I=parseFloat(J.duration)/10;var F={top:H.getStyle("top"),left:H.getStyle("left")};return new Effect.Move(H,{x:G,y:0,duration:I,afterFinishInternal:function(A){new Effect.Move(A.element,{x:-G*2,y:0,duration:I*2,afterFinishInternal:function(B){new Effect.Move(B.element,{x:G*2,y:0,duration:I*2,afterFinishInternal:function(C){new Effect.Move(C.element,{x:-G*2,y:0,duration:I*2,afterFinishInternal:function(D){new Effect.Move(D.element,{x:G*2,y:0,duration:I*2,afterFinishInternal:function(E){new Effect.Move(E.element,{x:-G,y:0,duration:I,afterFinishInternal:function(L){L.element.undoPositioned().setStyle(F);}});}});}});}});}});}});};Effect.SlideDown=function(E){E=$(E).cleanWhitespace();var D=E.down().getStyle("bottom");var F=E.getDimensions();return new Effect.Scale(E,100,Object.extend({scaleContent:false,scaleX:false,scaleFrom:window.opera?0:1,scaleMode:{originalHeight:F.height,originalWidth:F.width},restoreAfterFinish:true,afterSetup:function(A){A.element.makePositioned();A.element.down().makePositioned();if(window.opera){A.element.setStyle({top:""});}A.element.makeClipping().setStyle({height:"0px"}).show();},afterUpdateInternal:function(A){A.element.down().setStyle({bottom:(A.dims[0]-A.element.clientHeight)+"px"});},afterFinishInternal:function(A){A.element.undoClipping().undoPositioned();A.element.down().undoPositioned().setStyle({bottom:D});}},arguments[1]||{}));};Effect.SlideUp=function(E){E=$(E).cleanWhitespace();var D=E.down().getStyle("bottom");var F=E.getDimensions();return new Effect.Scale(E,window.opera?0:1,Object.extend({scaleContent:false,scaleX:false,scaleMode:"box",scaleFrom:100,scaleMode:{originalHeight:F.height,originalWidth:F.width},restoreAfterFinish:true,afterSetup:function(A){A.element.makePositioned();A.element.down().makePositioned();if(window.opera){A.element.setStyle({top:""});}A.element.makeClipping().show();},afterUpdateInternal:function(A){A.element.down().setStyle({bottom:(A.dims[0]-A.element.clientHeight)+"px"});},afterFinishInternal:function(A){A.element.hide().undoClipping().undoPositioned();A.element.down().undoPositioned().setStyle({bottom:D});}},arguments[1]||{}));};Effect.Squish=function(B){return new Effect.Scale(B,window.opera?1:0,{restoreAfterFinish:true,beforeSetup:function(A){A.element.makeClipping();},afterFinishInternal:function(A){A.element.hide().undoClipping();}});};Effect.Grow=function(O){O=$(O);var P=Object.extend({direction:"center",moveTransition:Effect.Transitions.sinoidal,scaleTransition:Effect.Transitions.sinoidal,opacityTransition:Effect.Transitions.full},arguments[1]||{});var I={top:O.style.top,left:O.style.left,height:O.style.height,width:O.style.width,opacity:O.getInlineOpacity()};var K=O.getDimensions();var J,L;var M,N;switch(P.direction){case"top-left":J=L=M=N=0;break;case"top-right":J=K.width;L=N=0;M=-K.width;break;case"bottom-left":J=M=0;L=K.height;N=-K.height;break;case"bottom-right":J=K.width;L=K.height;M=-K.width;N=-K.height;break;case"center":J=K.width/2;L=K.height/2;M=-K.width/2;N=-K.height/2;break;}return new Effect.Move(O,{x:J,y:L,duration:0.01,beforeSetup:function(A){A.element.hide().makeClipping().makePositioned();},afterFinishInternal:function(A){new Effect.Parallel([new Effect.Opacity(A.element,{sync:true,to:1,from:0,transition:P.opacityTransition}),new Effect.Move(A.element,{x:M,y:N,sync:true,transition:P.moveTransition}),new Effect.Scale(A.element,100,{scaleMode:{originalHeight:K.height,originalWidth:K.width},sync:true,scaleFrom:window.opera?1:0,transition:P.scaleTransition,restoreAfterFinish:true})],Object.extend({beforeSetup:function(B){B.effects[0].element.setStyle({height:"0px"}).show();},afterFinishInternal:function(B){B.effects[0].element.undoClipping().undoPositioned().setStyle(I);}},P));}});};Effect.Shrink=function(K){K=$(K);var L=Object.extend({direction:"center",moveTransition:Effect.Transitions.sinoidal,scaleTransition:Effect.Transitions.sinoidal,opacityTransition:Effect.Transitions.none},arguments[1]||{});var G={top:K.style.top,left:K.style.left,height:K.style.height,width:K.style.width,opacity:K.getInlineOpacity()};var H=K.getDimensions();var I,J;switch(L.direction){case"top-left":I=J=0;break;case"top-right":I=H.width;J=0;break;case"bottom-left":I=0;J=H.height;break;case"bottom-right":I=H.width;J=H.height;break;case"center":I=H.width/2;J=H.height/2;break;}return new Effect.Parallel([new Effect.Opacity(K,{sync:true,to:0,from:1,transition:L.opacityTransition}),new Effect.Scale(K,window.opera?1:0,{sync:true,transition:L.scaleTransition,restoreAfterFinish:true}),new Effect.Move(K,{x:I,y:J,sync:true,transition:L.moveTransition})],Object.extend({beforeStartInternal:function(A){A.effects[0].element.makePositioned().makeClipping();},afterFinishInternal:function(A){A.effects[0].element.hide().undoClipping().undoPositioned().setStyle(G);}},L));};Effect.Pulsate=function(I){I=$(I);var J=arguments[1]||{},F=I.getInlineOpacity(),G=J.transition||Effect.Transitions.linear,H=function(A){return 1-G((-Math.cos((A*(J.pulses||5)*2)*Math.PI)/2)+0.5);};return new Effect.Opacity(I,Object.extend(Object.extend({duration:2,from:0,afterFinishInternal:function(A){A.element.setStyle({opacity:F});}},J),{transition:H}));};Effect.Fold=function(D){D=$(D);var C={top:D.style.top,left:D.style.left,width:D.style.width,height:D.style.height};D.makeClipping();return new Effect.Scale(D,5,Object.extend({scaleContent:false,scaleX:false,afterFinishInternal:function(A){new Effect.Scale(D,1,{scaleContent:false,scaleY:false,afterFinishInternal:function(B){B.element.hide().undoClipping().setStyle(C);}});}},arguments[1]||{}));};Effect.Morph=Class.create(Effect.Base,{initialize:function(E){this.element=$(E);if(!this.element){throw (Effect._elementDoesNotExistError);}var D=Object.extend({style:{}},arguments[1]||{});if(!Object.isString(D.style)){this.style=$H(D.style);}else{if(D.style.include(":")){this.style=D.style.parseStyle();}else{this.element.addClassName(D.style);this.style=$H(this.element.getStyles());this.element.removeClassName(D.style);var F=this.element.getStyles();this.style=this.style.reject(function(A){return A.value==F[A.key];});D.afterFinishInternal=function(A){A.element.addClassName(A.options.style);A.transforms.each(function(B){A.element.style[B.style]="";});};}}this.start(D);},setup:function(){function B(A){if(!A||["rgba(0, 0, 0, 0)","transparent"].include(A)){A="#ffffff";}A=A.parseColor();return $R(0,2).map(function(D){return parseInt(A.slice(D*2+1,D*2+3),16);});}this.transforms=this.style.map(function(A){var H=A[0],I=A[1],J=null;if(I.parseColor("#zzzzzz")!="#zzzzzz"){I=I.parseColor();J="color";}else{if(H=="opacity"){I=parseFloat(I);if(Prototype.Browser.IE&&(!this.element.currentStyle.hasLayout)){this.element.setStyle({zoom:1});}}else{if(Element.CSS_LENGTH.test(I)){var K=I.match(/^([\+\-]?[0-9\.]+)(.*)$/);I=parseFloat(K[1]);J=(K.length==3)?K[2]:null;}}}var L=this.element.getStyle(H);return{style:H.camelize(),originalValue:J=="color"?B(L):parseFloat(L||0),targetValue:J=="color"?B(I):I,unit:J};}.bind(this)).reject(function(A){return((A.originalValue==A.targetValue)||(A.unit!="color"&&(isNaN(A.originalValue)||isNaN(A.targetValue))));});},update:function(E){var F={},H,G=this.transforms.length;while(G--){F[(H=this.transforms[G]).style]=H.unit=="color"?"#"+(Math.round(H.originalValue[0]+(H.targetValue[0]-H.originalValue[0])*E)).toColorPart()+(Math.round(H.originalValue[1]+(H.targetValue[1]-H.originalValue[1])*E)).toColorPart()+(Math.round(H.originalValue[2]+(H.targetValue[2]-H.originalValue[2])*E)).toColorPart():(H.originalValue+(H.targetValue-H.originalValue)*E).toFixed(3)+(H.unit===null?"":H.unit);}this.element.setStyle(F,true);}});Effect.Transform=Class.create({initialize:function(B){this.tracks=[];this.options=arguments[1]||{};this.addTracks(B);},addTracks:function(B){B.each(function(D){D=$H(D);var A=D.values().first();this.tracks.push($H({ids:D.keys().first(),effect:Effect.Morph,options:{style:A}}));}.bind(this));return this;},play:function(){return new Effect.Parallel(this.tracks.map(function(F){var H=F.get("ids"),I=F.get("effect"),J=F.get("options");var G=[$(H)||$$(H)].flatten();return G.map(function(A){return new I(A,Object.extend({sync:true},J));});}).flatten(),this.options);}});Element.CSS_PROPERTIES=$w("backgroundColor backgroundPosition borderBottomColor borderBottomStyle "+"borderBottomWidth borderLeftColor borderLeftStyle borderLeftWidth "+"borderRightColor borderRightStyle borderRightWidth borderSpacing "+"borderTopColor borderTopStyle borderTopWidth bottom clip color "+"fontSize fontWeight height left letterSpacing lineHeight "+"marginBottom marginLeft marginRight marginTop markerOffset maxHeight "+"maxWidth minHeight minWidth opacity outlineColor outlineOffset "+"outlineWidth paddingBottom paddingLeft paddingRight paddingTop "+"right textIndent top width wordSpacing zIndex");Element.CSS_LENGTH=/^(([\+\-]?[0-9\.]+)(em|ex|px|in|cm|mm|pt|pc|\%))|0$/;String.__parseStyleElement=document.createElement("div");String.prototype.parseStyle=function(){var D,C=$H();if(Prototype.Browser.WebKit){D=new Element("div",{style:this}).style;}else{String.__parseStyleElement.innerHTML='<div style="'+this+'"></div>';D=String.__parseStyleElement.childNodes[0].style;}Element.CSS_PROPERTIES.each(function(A){if(D[A]){C.set(A,D[A]);}});if(Prototype.Browser.IE&&this.include("opacity")){C.set("opacity",this.match(/opacity:\s*((?:0|1)?(?:\.\d*)?)/)[1]);}return C;};if(document.defaultView&&document.defaultView.getComputedStyle){Element.getStyles=function(D){var C=document.defaultView.getComputedStyle($(D),null);return Element.CSS_PROPERTIES.inject({},function(B,A){B[A]=C[A];return B;});};}else{Element.getStyles=function(F){F=$(F);var D=F.currentStyle,E;E=Element.CSS_PROPERTIES.inject({},function(B,A){B[A]=D[A];return B;});if(!E.opacity){E.opacity=F.getOpacity();}return E;};}Effect.Methods={morph:function(C,D){C=$(C);new Effect.Morph(C,Object.extend({style:D},arguments[2]||{}));return C;},visualEffect:function(I,G,J){I=$(I);var H=G.dasherize().camelize(),F=H.charAt(0).toUpperCase()+H.substring(1);new Effect[F](I,J);return I;},highlight:function(D,C){D=$(D);new Effect.Highlight(D,C);return D;}};$w("fade appear grow shrink fold blindUp blindDown slideUp slideDown "+"pulsate shake puff squish switchOff dropOut").each(function(B){Effect.Methods[B]=function(A,D){A=$(A);Effect[B.charAt(0).toUpperCase()+B.substring(1)](A,D);return A;};});$w("getInlineOpacity forceRerendering setContentZoom collectTextNodes collectTextNodesIgnoreClass getStyles").each(function(B){Effect.Methods[B]=Element[B];});Element.addMethods(Effect.Methods);if(Object.isUndefined(Effect)){throw ("dragdrop.js requires including script.aculo.us' effects.js library");}var Droppables={drops:[],remove:function(B){this.drops=this.drops.reject(function(A){return A.element==$(B);});},add:function(F){F=$(F);var D=Object.extend({greedy:true,hoverclass:null,tree:false},arguments[1]||{});if(D.containment){D._containers=[];var E=D.containment;if(Object.isArray(E)){E.each(function(A){D._containers.push($(A));});}else{D._containers.push($(E));}}if(D.accept){D.accept=[D.accept].flatten();}Element.makePositioned(F);D.element=F;this.drops.push(D);},findDeepestChild:function(B){deepest=B[0];for(i=1;i<B.length;++i){if(Element.isParent(B[i].element,deepest.element)){deepest=B[i];}}return deepest;},isContained:function(F,D){var E;if(D.tree){E=F.treeNode;}else{E=F.parentNode;}return D._containers.detect(function(A){return E==A;});},isAffected:function(D,E,F){return((F.element!=E)&&((!F._containers)||this.isContained(E,F))&&((!F.accept)||(Element.classNames(E).detect(function(A){return F.accept.include(A);})))&&Position.within(F.element,D[0],D[1]));},deactivate:function(B){if(B.hoverclass){Element.removeClassName(B.element,B.hoverclass);}this.last_active=null;},activate:function(B){if(B.hoverclass){Element.addClassName(B.element,B.hoverclass);}this.last_active=B;},show:function(E,G){if(!this.drops.length){return;}var H,F=[];this.drops.each(function(A){if(Droppables.isAffected(E,G,A)){F.push(A);}});if(F.length>0){H=Droppables.findDeepestChild(F);}if(this.last_active&&this.last_active!=H){this.deactivate(this.last_active);}if(H){Position.within(H.element,E[0],E[1]);if(H.onHover){H.onHover(G,H.element,Position.overlap(H.overlap,H.element));}if(H!=this.last_active){Droppables.activate(H);}}},fire:function(D,C){if(!this.last_active){return;}Position.prepare();if(this.isAffected([Event.pointerX(D),Event.pointerY(D)],C,this.last_active)){if(this.last_active.onDrop){this.last_active.onDrop(C,this.last_active.element,D);return true;}}},reset:function(){if(this.last_active){this.deactivate(this.last_active);}}};var Draggables={drags:[],observers:[],register:function(B){if(this.drags.length==0){this.eventMouseUp=this.endDrag.bindAsEventListener(this);this.eventMouseMove=this.updateDrag.bindAsEventListener(this);this.eventKeypress=this.keyPress.bindAsEventListener(this);Event.observe(document,"mouseup",this.eventMouseUp);Event.observe(document,"mousemove",this.eventMouseMove);Event.observe(document,"keypress",this.eventKeypress);}this.drags.push(B);},unregister:function(B){this.drags=this.drags.reject(function(A){return A==B;});if(this.drags.length==0){Event.stopObserving(document,"mouseup",this.eventMouseUp);Event.stopObserving(document,"mousemove",this.eventMouseMove);Event.stopObserving(document,"keypress",this.eventKeypress);}},activate:function(B){if(B.options.delay){this._timeout=setTimeout(function(){Draggables._timeout=null;window.focus();Draggables.activeDraggable=B;}.bind(this),B.options.delay);}else{window.focus();this.activeDraggable=B;}},deactivate:function(){this.activeDraggable=null;},updateDrag:function(C){if(!this.activeDraggable){return;}var D=[Event.pointerX(C),Event.pointerY(C)];if(this._lastPointer&&(this._lastPointer.inspect()==D.inspect())){return;}this._lastPointer=D;this.activeDraggable.updateDrag(C,D);},endDrag:function(B){if(this._timeout){clearTimeout(this._timeout);this._timeout=null;}if(!this.activeDraggable){return;}this._lastPointer=null;this.activeDraggable.endDrag(B);this.activeDraggable=null;},keyPress:function(B){if(this.activeDraggable){this.activeDraggable.keyPress(B);}},addObserver:function(B){this.observers.push(B);this._cacheObserverCallbacks();},removeObserver:function(B){this.observers=this.observers.reject(function(A){return A.element==B;});this._cacheObserverCallbacks();},notify:function(F,D,E){if(this[F+"Count"]>0){this.observers.each(function(A){if(A[F]){A[F](F,D,E);}});}if(D.options[F]){D.options[F](D,E);}},_cacheObserverCallbacks:function(){["onStart","onEnd","onDrag"].each(function(B){Draggables[B+"Count"]=Draggables.observers.select(function(A){return A[B];}).length;});}};var Draggable=Class.create({initialize:function(F){var E={handle:false,reverteffect:function(B,C,H){var A=Math.sqrt(Math.abs(C^2)+Math.abs(H^2))*0.02;new Effect.Move(B,{x:-H,y:-C,duration:A,queue:{scope:"_draggable",position:"end"}});},endeffect:function(A){var B=Object.isNumber(A._opacity)?A._opacity:1;new Effect.Opacity(A,{duration:0.2,from:0.7,to:B,queue:{scope:"_draggable",position:"end"},afterFinish:function(){Draggable._dragging[A]=false;}});},zindex:1000,revert:false,quiet:false,scroll:false,scrollSensitivity:20,scrollSpeed:15,snap:false,delay:0};if(!arguments[1]||Object.isUndefined(arguments[1].endeffect)){Object.extend(E,{starteffect:function(A){A._opacity=Element.getOpacity(A);Draggable._dragging[A]=true;new Effect.Opacity(A,{duration:0.2,from:A._opacity,to:0.7});}});}var D=Object.extend(E,arguments[1]||{});this.element=$(F);if(D.handle&&Object.isString(D.handle)){this.handle=this.element.down("."+D.handle,0);}if(!this.handle){this.handle=$(D.handle);}if(!this.handle){this.handle=this.element;}if(D.scroll&&!D.scroll.scrollTo&&!D.scroll.outerHTML){D.scroll=$(D.scroll);this._isScrollChild=Element.childOf(this.element,D.scroll);}Element.makePositioned(this.element);this.options=D;this.dragging=false;this.eventMouseDown=this.initDrag.bindAsEventListener(this);Event.observe(this.handle,"mousedown",this.eventMouseDown);Draggables.register(this);},destroy:function(){Event.stopObserving(this.handle,"mousedown",this.eventMouseDown);Draggables.unregister(this);},currentDelta:function(){return([parseInt(Element.getStyle(this.element,"left")||"0"),parseInt(Element.getStyle(this.element,"top")||"0")]);},initDrag:function(E){if(!Object.isUndefined(Draggable._dragging[this.element])&&Draggable._dragging[this.element]){return;}if(Event.isLeftClick(E)){var G=Event.element(E);if((tag_name=G.tagName.toUpperCase())&&(tag_name=="INPUT"||tag_name=="SELECT"||tag_name=="OPTION"||tag_name=="BUTTON"||tag_name=="TEXTAREA")){return;}var H=[Event.pointerX(E),Event.pointerY(E)];var F=Position.cumulativeOffset(this.element);this.offset=[0,1].map(function(A){return(H[A]-F[A]);});Draggables.activate(this);Event.stop(E);}},startDrag:function(D){this.dragging=true;if(!this.delta){this.delta=this.currentDelta();}if(this.options.zindex){this.originalZ=parseInt(Element.getStyle(this.element,"z-index")||0);this.element.style.zIndex=this.options.zindex;}if(this.options.ghosting){this._clone=this.element.cloneNode(true);this._originallyAbsolute=(this.element.getStyle("position")=="absolute");if(!this._originallyAbsolute){Position.absolutize(this.element);}this.element.parentNode.insertBefore(this._clone,this.element);}if(this.options.scroll){if(this.options.scroll==window){var C=this._getWindowScroll(this.options.scroll);this.originalScrollLeft=C.left;this.originalScrollTop=C.top;}else{this.originalScrollLeft=this.options.scroll.scrollLeft;this.originalScrollTop=this.options.scroll.scrollTop;}}Draggables.notify("onStart",this,D);if(this.options.starteffect){this.options.starteffect(this.element);}},updateDrag:function(event,pointer){if(!this.dragging){this.startDrag(event);}if(!this.options.quiet){Position.prepare();Droppables.show(pointer,this.element);}Draggables.notify("onDrag",this,event);this.draw(pointer);if(this.options.change){this.options.change(this);}if(this.options.scroll){this.stopScrolling();var p;if(this.options.scroll==window){with(this._getWindowScroll(this.options.scroll)){p=[left,top,left+width,top+height];}}else{p=Position.page(this.options.scroll);p[0]+=this.options.scroll.scrollLeft+Position.deltaX;p[1]+=this.options.scroll.scrollTop+Position.deltaY;p.push(p[0]+this.options.scroll.offsetWidth);p.push(p[1]+this.options.scroll.offsetHeight);}var speed=[0,0];if(pointer[0]<(p[0]+this.options.scrollSensitivity)){speed[0]=pointer[0]-(p[0]+this.options.scrollSensitivity);}if(pointer[1]<(p[1]+this.options.scrollSensitivity)){speed[1]=pointer[1]-(p[1]+this.options.scrollSensitivity);}if(pointer[0]>(p[2]-this.options.scrollSensitivity)){speed[0]=pointer[0]-(p[2]-this.options.scrollSensitivity);}if(pointer[1]>(p[3]-this.options.scrollSensitivity)){speed[1]=pointer[1]-(p[3]-this.options.scrollSensitivity);}this.startScrolling(speed);}if(Prototype.Browser.WebKit){window.scrollBy(0,0);}Event.stop(event);},finishDrag:function(L,I){this.dragging=false;if(this.options.quiet){Position.prepare();var J=[Event.pointerX(L),Event.pointerY(L)];Droppables.show(J,this.element);}if(this.options.ghosting){if(!this._originallyAbsolute){Position.relativize(this.element);}delete this._originallyAbsolute;Element.remove(this._clone);this._clone=null;}var H=false;if(I){H=Droppables.fire(L,this.element);if(!H){H=false;}}if(H&&this.options.onDropped){this.options.onDropped(this.element);}Draggables.notify("onEnd",this,L);var G=this.options.revert;if(G&&Object.isFunction(G)){G=G(this.element);}var K=this.currentDelta();if(G&&this.options.reverteffect){if(H==0||G!="failure"){this.options.reverteffect(this.element,K[1]-this.delta[1],K[0]-this.delta[0]);}}else{this.delta=K;}if(this.options.zindex){this.element.style.zIndex=this.originalZ;}if(this.options.endeffect){this.options.endeffect(this.element);}Draggables.deactivate(this);Droppables.reset();},keyPress:function(B){if(B.keyCode!=Event.KEY_ESC){return;}this.finishDrag(B,false);Event.stop(B);},endDrag:function(B){if(!this.dragging){return;}this.stopScrolling();this.finishDrag(B,true);Event.stop(B);},draw:function(G){var H=Position.cumulativeOffset(this.element);if(this.options.ghosting){var K=Position.realOffset(this.element);H[0]+=K[0]-Position.deltaX;H[1]+=K[1]-Position.deltaY;}var I=this.currentDelta();H[0]-=I[0];H[1]-=I[1];if(this.options.scroll&&(this.options.scroll!=window&&this._isScrollChild)){H[0]-=this.options.scroll.scrollLeft-this.originalScrollLeft;H[1]-=this.options.scroll.scrollTop-this.originalScrollTop;}var J=[0,1].map(function(A){return(G[A]-H[A]-this.offset[A]);}.bind(this));if(this.options.snap){if(Object.isFunction(this.options.snap)){J=this.options.snap(J[0],J[1],this);}else{if(Object.isArray(this.options.snap)){J=J.map(function(B,A){return(B/this.options.snap[A]).round()*this.options.snap[A];}.bind(this));}else{J=J.map(function(A){return(A/this.options.snap).round()*this.options.snap;}.bind(this));}}}var L=this.element.style;if((!this.options.constraint)||(this.options.constraint=="horizontal")){L.left=J[0]+"px";}if((!this.options.constraint)||(this.options.constraint=="vertical")){L.top=J[1]+"px";}if(L.visibility=="hidden"){L.visibility="";}},stopScrolling:function(){if(this.scrollInterval){clearInterval(this.scrollInterval);this.scrollInterval=null;Draggables._lastScrollPointer=null;}},startScrolling:function(B){if(!(B[0]||B[1])){return;}this.scrollSpeed=[B[0]*this.options.scrollSpeed,B[1]*this.options.scrollSpeed];this.lastScrolled=new Date();this.scrollInterval=setInterval(this.scroll.bind(this),10);},scroll:function(){var current=new Date();var delta=current-this.lastScrolled;this.lastScrolled=current;if(this.options.scroll==window){with(this._getWindowScroll(this.options.scroll)){if(this.scrollSpeed[0]||this.scrollSpeed[1]){var d=delta/1000;this.options.scroll.scrollTo(left+d*this.scrollSpeed[0],top+d*this.scrollSpeed[1]);}}}else{this.options.scroll.scrollLeft+=this.scrollSpeed[0]*delta/1000;this.options.scroll.scrollTop+=this.scrollSpeed[1]*delta/1000;}Position.prepare();Droppables.show(Draggables._lastPointer,this.element);Draggables.notify("onDrag",this);if(this._isScrollChild){Draggables._lastScrollPointer=Draggables._lastScrollPointer||$A(Draggables._lastPointer);Draggables._lastScrollPointer[0]+=this.scrollSpeed[0]*delta/1000;Draggables._lastScrollPointer[1]+=this.scrollSpeed[1]*delta/1000;if(Draggables._lastScrollPointer[0]<0){Draggables._lastScrollPointer[0]=0;}if(Draggables._lastScrollPointer[1]<0){Draggables._lastScrollPointer[1]=0;}this.draw(Draggables._lastScrollPointer);}if(this.options.change){this.options.change(this);}},_getWindowScroll:function(w){var T,L,W,H;with(w.document){if(w.document.documentElement&&documentElement.scrollTop){T=documentElement.scrollTop;L=documentElement.scrollLeft;}else{if(w.document.body){T=body.scrollTop;L=body.scrollLeft;}}if(w.innerWidth){W=w.innerWidth;H=w.innerHeight;}else{if(w.document.documentElement&&documentElement.clientWidth){W=documentElement.clientWidth;H=documentElement.clientHeight;}else{W=body.offsetWidth;H=body.offsetHeight;}}}return{top:T,left:L,width:W,height:H};}});Draggable._dragging={};var SortableObserver=Class.create({initialize:function(D,C){this.element=$(D);this.observer=C;this.lastValue=Sortable.serialize(this.element);},onStart:function(){this.lastValue=Sortable.serialize(this.element);},onEnd:function(){Sortable.unmark();if(this.lastValue!=Sortable.serialize(this.element)){this.observer(this.element);}}});var Sortable={SERIALIZE_RULE:/^[^_\-](?:[A-Za-z0-9\-\_]*)[_](.*)$/,sortables:{},_findRootElement:function(B){while(B.tagName.toUpperCase()!="BODY"){if(B.id&&Sortable.sortables[B.id]){return B;}B=B.parentNode;}},options:function(B){B=Sortable._findRootElement($(B));if(!B){return;}return Sortable.sortables[B.id];},destroy:function(C){C=$(C);var D=Sortable.sortables[C.id];if(D){Draggables.removeObserver(D.element);D.droppables.each(function(A){Droppables.remove(A);});D.draggables.invoke("destroy");delete Sortable.sortables[D.element.id];}},create:function(I){I=$(I);var J=Object.extend({element:I,tag:"li",dropOnEmpty:false,tree:false,treeTag:"ul",overlap:"vertical",constraint:"vertical",containment:I,handle:false,only:false,delay:0,hoverclass:null,ghosting:false,quiet:false,scroll:false,scrollSensitivity:20,scrollSpeed:15,format:this.SERIALIZE_RULE,elements:false,handles:false,onChange:Prototype.emptyFunction,onUpdate:Prototype.emptyFunction},arguments[1]||{});this.destroy(I);var F={revert:true,quiet:J.quiet,scroll:J.scroll,scrollSpeed:J.scrollSpeed,scrollSensitivity:J.scrollSensitivity,delay:J.delay,ghosting:J.ghosting,constraint:J.constraint,handle:J.handle};if(J.starteffect){F.starteffect=J.starteffect;}if(J.reverteffect){F.reverteffect=J.reverteffect;}else{if(J.ghosting){F.reverteffect=function(A){A.style.top=0;A.style.left=0;};}}if(J.endeffect){F.endeffect=J.endeffect;}if(J.zindex){F.zindex=J.zindex;}var H={overlap:J.overlap,containment:J.containment,tree:J.tree,hoverclass:J.hoverclass,onHover:Sortable.onHover};var G={onHover:Sortable.onEmptyHover,overlap:J.overlap,containment:J.containment,hoverclass:J.hoverclass};Element.cleanWhitespace(I);J.draggables=[];J.droppables=[];if(J.dropOnEmpty||J.tree){Droppables.add(I,G);J.droppables.push(I);}(J.elements||this.findElements(I,J)||[]).each(function(A,C){var B=J.handles?$(J.handles[C]):(J.handle?$(A).select("."+J.handle)[0]:A);J.draggables.push(new Draggable(A,Object.extend(F,{handle:B})));Droppables.add(A,H);if(J.tree){A.treeNode=I;}J.droppables.push(A);});if(J.tree){(Sortable.findTreeElements(I,J)||[]).each(function(A){Droppables.add(A,G);A.treeNode=I;J.droppables.push(A);});}this.sortables[I.id]=J;Draggables.addObserver(new SortableObserver(I,J.onUpdate));},findElements:function(D,C){return Element.findChildren(D,C.only,C.tree?true:false,C.tag);},findTreeElements:function(D,C){return Element.findChildren(D,C.only,C.tree?true:false,C.treeTag);},onHover:function(G,H,F){if(Element.isParent(H,G)){return;}if(F>0.33&&F<0.66&&Sortable.options(H).tree){return;}else{if(F>0.5){Sortable.mark(H,"before");if(H.previousSibling!=G){var J=G.parentNode;G.style.visibility="hidden";H.parentNode.insertBefore(G,H);if(H.parentNode!=J){Sortable.options(J).onChange(G);}Sortable.options(H.parentNode).onChange(G);}}else{Sortable.mark(H,"after");var I=H.nextSibling||null;if(I!=G){var J=G.parentNode;G.style.visibility="hidden";H.parentNode.insertBefore(G,I);if(H.parentNode!=J){Sortable.options(J).onChange(G);}Sortable.options(H.parentNode).onChange(G);}}}},onEmptyHover:function(R,P,O){var N=R.parentNode;var M=Sortable.options(P);if(!Element.isParent(P,R)){var Q;var K=Sortable.findElements(P,{tag:M.tag,only:M.only});var L=null;if(K){var J=Element.offsetSize(P,M.overlap)*(1-O);for(Q=0;Q<K.length;Q+=1){if(J-Element.offsetSize(K[Q],M.overlap)>=0){J-=Element.offsetSize(K[Q],M.overlap);}else{if(J-(Element.offsetSize(K[Q],M.overlap)/2)>=0){L=Q+1<K.length?K[Q+1]:null;break;}else{L=K[Q];break;}}}}P.insertBefore(R,L);Sortable.options(N).onChange(R);M.onChange(R);}},unmark:function(){if(Sortable._marker){Sortable._marker.hide();}},mark:function(H,E){var F=Sortable.options(H.parentNode);if(F&&!F.ghosting){return;}if(!Sortable._marker){Sortable._marker=($("dropmarker")||Element.extend(document.createElement("DIV"))).hide().addClassName("dropmarker").setStyle({position:"absolute"});document.getElementsByTagName("body").item(0).appendChild(Sortable._marker);}var G=Position.cumulativeOffset(H);Sortable._marker.setStyle({left:G[0]+"px",top:G[1]+"px"});if(E=="after"){if(F.overlap=="horizontal"){Sortable._marker.setStyle({left:(G[0]+H.clientWidth)+"px"});}else{Sortable._marker.setStyle({top:(G[1]+H.clientHeight)+"px"});}}Sortable._marker.show();},_tree:function(K,N,J){var L=Sortable.findElements(K,N)||[];for(var M=0;M<L.length;++M){var H=L[M].id.match(N.format);if(!H){continue;}var I={id:encodeURIComponent(H?H[1]:null),element:K,parent:J,children:[],position:J.children.length,container:$(L[M]).down(N.treeTag)};if(I.container){this._tree(I.container,N,I);}J.children.push(I);}return J;},tree:function(F){F=$(F);var G=this.options(F);var H=Object.extend({tag:G.tag,treeTag:G.treeTag,only:G.only,name:F.id,format:G.format},arguments[1]||{});var E={id:null,parent:null,children:[],container:F,position:0};return Sortable._tree(F,H,E);},_constructIndex:function(D){var C="";do{if(D.id){C="["+D.position+"]"+C;}}while((D=D.parent)!=null);return C;},sequence:function(D){D=$(D);var C=Object.extend(this.options(D),arguments[1]||{});return $(this.findElements(D,C)||[]).map(function(A){return A.id.match(C.format)?A.id.match(C.format)[1]:"";});},setSequence:function(H,G){H=$(H);var E=Object.extend(this.options(H),arguments[2]||{});var F={};this.findElements(H,E).each(function(A){if(A.id.match(E.format)){F[A.id.match(E.format)[1]]=[A,A.parentNode];}A.parentNode.removeChild(A);});G.each(function(B){var A=F[B];if(A){A[1].appendChild(A[0]);delete F[B];}});},serialize:function(E){E=$(E);var F=Object.extend(Sortable.options(E),arguments[1]||{});var D=encodeURIComponent((arguments[1]&&arguments[1].name)?arguments[1].name:E.id);if(F.tree){return Sortable.tree(E,arguments[1]).children.map(function(A){return[D+Sortable._constructIndex(A)+"[id]="+encodeURIComponent(A.id)].concat(A.children.map(arguments.callee));}).flatten().join("&");}else{return Sortable.sequence(E,arguments[1]).map(function(A){return D+"[]="+encodeURIComponent(A);}).join("&");}}};Element.isParent=function(D,C){if(!D.parentNode||D==C){return false;}if(D.parentNode==C){return true;}return Element.isParent(D.parentNode,C);};Element.findChildren=function(H,J,F,I){if(!H.hasChildNodes()){return null;}I=I.toUpperCase();if(J){J=[J].flatten();}var G=[];$A(H.childNodes).each(function(A){if(A.tagName&&A.tagName.toUpperCase()==I&&(!J||(Element.classNames(A).detect(function(C){return J.include(C);})))){G.push(A);}if(F){var B=Element.findChildren(A,J,F,I);if(B){G.push(B);}}});return(G.length>0?G.flatten():[]);};Element.offsetSize=function(C,D){return C["offset"+((D=="vertical"||D=="height")?"Height":"Width")];};if(typeof Effect=="undefined"){throw ("controls.js requires including script.aculo.us' effects.js library");}var Autocompleter={};Autocompleter.Base=Class.create({baseInitialize:function(F,E,D){F=$(F);this.element=F;this.update=$(E);this.hasFocus=false;this.changed=false;this.active=false;this.index=0;this.entryCount=0;this.oldElementValue=this.element.value;if(this.setOptions){this.setOptions(D);}else{this.options=D||{};}this.options.paramName=this.options.paramName||this.element.name;this.options.tokens=this.options.tokens||[];this.options.frequency=this.options.frequency||0.4;this.options.minChars=this.options.minChars||1;this.options.onShow=this.options.onShow||function(B,A){if(!A.style.position||A.style.position=="absolute"){A.style.position="absolute";Position.clone(B,A,{setHeight:false,offsetTop:B.offsetHeight});}Effect.Appear(A,{duration:0.15});};this.options.onHide=this.options.onHide||function(B,A){new Effect.Fade(A,{duration:0.15});};if(typeof(this.options.tokens)=="string"){this.options.tokens=new Array(this.options.tokens);}if(!this.options.tokens.include("\n")){this.options.tokens.push("\n");}this.observer=null;this.element.setAttribute("autocomplete","off");Element.hide(this.update);Event.observe(this.element,"blur",this.onBlur.bindAsEventListener(this));Event.observe(this.element,"keydown",this.onKeyPress.bindAsEventListener(this));},show:function(){if(Element.getStyle(this.update,"display")=="none"){this.options.onShow(this.element,this.update);}if(!this.iefix&&(Prototype.Browser.IE)&&(Element.getStyle(this.update,"position")=="absolute")){new Insertion.After(this.update,'<iframe id="'+this.update.id+'_iefix" '+'style="display:none;position:absolute;filter:progid:DXImageTransform.Microsoft.Alpha(opacity=0);" '+'src="javascript:false;" frameborder="0" scrolling="no"></iframe>');this.iefix=$(this.update.id+"_iefix");}if(this.iefix){setTimeout(this.fixIEOverlapping.bind(this),50);}},fixIEOverlapping:function(){Position.clone(this.update,this.iefix,{setTop:(!this.update.style.height)});this.iefix.style.zIndex=1;this.update.style.zIndex=2;Element.show(this.iefix);},hide:function(){this.stopIndicator();if(Element.getStyle(this.update,"display")!="none"){this.options.onHide(this.element,this.update);}if(this.iefix){Element.hide(this.iefix);}},startIndicator:function(){if(this.options.indicator){Element.show(this.options.indicator);}},stopIndicator:function(){if(this.options.indicator){Element.hide(this.options.indicator);}},onKeyPress:function(B){if(this.active){switch(B.keyCode){case Event.KEY_TAB:case Event.KEY_RETURN:this.selectEntry();Event.stop(B);case Event.KEY_ESC:this.hide();this.active=false;Event.stop(B);return;case Event.KEY_LEFT:case Event.KEY_RIGHT:return;case Event.KEY_UP:this.markPrevious();this.render();Event.stop(B);return;case Event.KEY_DOWN:this.markNext();this.render();Event.stop(B);return;}}else{if(B.keyCode==Event.KEY_TAB||B.keyCode==Event.KEY_RETURN||(Prototype.Browser.WebKit>0&&B.keyCode==0)){return;}}this.changed=true;this.hasFocus=true;if(this.observer){clearTimeout(this.observer);}this.observer=setTimeout(this.onObserverEvent.bind(this),this.options.frequency*1000);},activate:function(){this.changed=false;this.hasFocus=true;this.getUpdatedChoices();},onHover:function(D){var C=Event.findElement(D,"LI");if(this.index!=C.autocompleteIndex){this.index=C.autocompleteIndex;this.render();}Event.stop(D);},onClick:function(D){var C=Event.findElement(D,"LI");this.index=C.autocompleteIndex;this.selectEntry();this.hide();},onBlur:function(B){setTimeout(this.hide.bind(this),250);this.hasFocus=false;this.active=false;},render:function(){if(this.entryCount>0){for(var B=0;B<this.entryCount;B++){this.index==B?Element.addClassName(this.getEntry(B),"selected"):Element.removeClassName(this.getEntry(B),"selected");}if(this.hasFocus){this.show();this.active=true;}}else{this.active=false;this.hide();}},markPrevious:function(){if(this.index>0){this.index--;}else{this.index=this.entryCount-1;}this.getEntry(this.index).scrollIntoView(true);},markNext:function(){if(this.index<this.entryCount-1){this.index++;}else{this.index=0;}this.getEntry(this.index).scrollIntoView(false);},getEntry:function(B){return this.update.firstChild.childNodes[B];},getCurrentEntry:function(){return this.getEntry(this.index);},selectEntry:function(){this.active=false;this.updateElement(this.getCurrentEntry());},updateElement:function(H){if(this.options.updateElement){this.options.updateElement(H);return;}var J="";if(this.options.select){var G=$(H).select("."+this.options.select)||[];if(G.length>0){J=Element.collectTextNodes(G[0],this.options.select);}}else{J=Element.collectTextNodesIgnoreClass(H,"informal");}var K=this.getTokenBounds();if(K[0]!=-1){var I=this.element.value.substr(0,K[0]);var L=this.element.value.substr(K[0]).match(/^\s+/);if(L){I+=L[0];}this.element.value=I+J+this.element.value.substr(K[1]);}else{this.element.value=J;}this.oldElementValue=this.element.value;this.element.focus();if(this.options.afterUpdateElement){this.options.afterUpdateElement(this.element,H);}},updateChoices:function(E){if(!this.changed&&this.hasFocus){this.update.innerHTML=E;Element.cleanWhitespace(this.update);Element.cleanWhitespace(this.update.down());if(this.update.firstChild&&this.update.down().childNodes){this.entryCount=this.update.down().childNodes.length;for(var D=0;D<this.entryCount;D++){var F=this.getEntry(D);F.autocompleteIndex=D;this.addObservers(F);}}else{this.entryCount=0;}this.stopIndicator();this.index=0;if(this.entryCount==1&&this.options.autoSelect){this.selectEntry();this.hide();}else{this.render();}}},addObservers:function(B){Event.observe(B,"mouseover",this.onHover.bindAsEventListener(this));Event.observe(B,"click",this.onClick.bindAsEventListener(this));},onObserverEvent:function(){this.changed=false;this.tokenBounds=null;if(this.getToken().length>=this.options.minChars){this.getUpdatedChoices();}else{this.active=false;this.hide();}this.oldElementValue=this.element.value;},getToken:function(){var B=this.getTokenBounds();return this.element.value.substring(B[0],B[1]).strip();},getTokenBounds:function(){if(null!=this.tokenBounds){return this.tokenBounds;}var M=this.element.value;if(M.strip().empty()){return[-1,0];}var L=arguments.callee.getFirstDifferencePos(M,this.oldElementValue);var J=(L==this.oldElementValue.length?1:0);var N=-1,O=M.length;var K;for(var P=0,I=this.options.tokens.length;P<I;++P){K=M.lastIndexOf(this.options.tokens[P],L+J-1);if(K>N){N=K;}K=M.indexOf(this.options.tokens[P],L+J);if(-1!=K&&K<O){O=K;}}return(this.tokenBounds=[N+1,O]);}});Autocompleter.Base.prototype.getTokenBounds.getFirstDifferencePos=function(G,E){var F=Math.min(G.length,E.length);for(var H=0;H<F;++H){if(G[H]!=E[H]){return H;}}return F;};Ajax.Autocompleter=Class.create(Autocompleter.Base,{initialize:function(G,F,H,E){this.baseInitialize(G,F,E);this.options.asynchronous=true;this.options.onComplete=this.onComplete.bind(this);this.options.defaultParams=this.options.parameters||null;this.url=H;},getUpdatedChoices:function(){this.startIndicator();var B=encodeURIComponent(this.options.paramName)+"="+encodeURIComponent(this.getToken());this.options.parameters=this.options.callback?this.options.callback(this.element,B):B;if(this.options.defaultParams){this.options.parameters+="&"+this.options.defaultParams;}new Ajax.Request(this.url,this.options);},onComplete:function(B){this.updateChoices(B.responseText);}});Autocompleter.Local=Class.create(Autocompleter.Base,{initialize:function(H,F,G,E){this.baseInitialize(H,F,E);this.options.array=G;},getUpdatedChoices:function(){this.updateChoices(this.options.selector(this));},setOptions:function(B){this.options=Object.extend({choices:10,partialSearch:true,partialChars:2,ignoreCase:true,fullSearch:false,selector:function(P){var N=[];var O=[];var J=P.getToken();var K=0;for(var M=0;M<P.options.array.length&&N.length<P.options.choices;M++){var L=P.options.array[M];var A=P.options.ignoreCase?L.toLowerCase().indexOf(J.toLowerCase()):L.indexOf(J);while(A!=-1){if(A==0&&L.length!=J.length){N.push("<li><strong>"+L.substr(0,J.length)+"</strong>"+L.substr(J.length)+"</li>");break;}else{if(J.length>=P.options.partialChars&&P.options.partialSearch&&A!=-1){if(P.options.fullSearch||/\s/.test(L.substr(A-1,1))){O.push("<li>"+L.substr(0,A)+"<strong>"+L.substr(A,J.length)+"</strong>"+L.substr(A+J.length)+"</li>");break;}}}A=P.options.ignoreCase?L.toLowerCase().indexOf(J.toLowerCase(),A+1):L.indexOf(J,A+1);}}if(O.length){N=N.concat(O.slice(0,P.options.choices-N.length));}return"<ul>"+N.join("")+"</ul>";}},B||{});}});Field.scrollFreeActivate=function(B){setTimeout(function(){Field.activate(B);},1);};Ajax.InPlaceEditor=Class.create({initialize:function(E,F,D){this.url=F;this.element=E=$(E);this.prepareOptions();this._controls={};arguments.callee.dealWithDeprecatedOptions(D);Object.extend(this.options,D||{});if(!this.options.formId&&this.element.id){this.options.formId=this.element.id+"-inplaceeditor";if($(this.options.formId)){this.options.formId="";}}if(this.options.externalControl){this.options.externalControl=$(this.options.externalControl);}if(!this.options.externalControl){this.options.externalControlOnly=false;}this._originalBackground=this.element.getStyle("background-color")||"transparent";this.element.title=this.options.clickToEditText;this._boundCancelHandler=this.handleFormCancellation.bind(this);this._boundComplete=(this.options.onComplete||Prototype.emptyFunction).bind(this);this._boundFailureHandler=this.handleAJAXFailure.bind(this);this._boundSubmitHandler=this.handleFormSubmission.bind(this);this._boundWrapperHandler=this.wrapUp.bind(this);this.registerListeners();},checkForEscapeOrReturn:function(B){if(!this._editing||B.ctrlKey||B.altKey||B.shiftKey){return;}if(Event.KEY_ESC==B.keyCode){this.handleFormCancellation(B);}else{if(Event.KEY_RETURN==B.keyCode){this.handleFormSubmission(B);}}},createControl:function(I,M,N){var K=this.options[I+"Control"];var J=this.options[I+"Text"];if("button"==K){var H=document.createElement("input");H.type="submit";H.value=J;H.className="editor_"+I+"_button";if("cancel"==I){H.onclick=this._boundCancelHandler;}this._form.appendChild(H);this._controls[I]=H;}else{if("link"==K){var L=document.createElement("a");L.href="#";L.appendChild(document.createTextNode(J));L.onclick="cancel"==I?this._boundCancelHandler:this._boundSubmitHandler;L.className="editor_"+I+"_link";if(N){L.className+=" "+N;}this._form.appendChild(L);this._controls[I]=L;}}},createEditField:function(){var E=(this.options.loadTextURL?this.options.loadingText:this.getText());var F;if(1>=this.options.rows&&!/\r|\n/.test(this.getText())){F=document.createElement("input");F.type="text";var D=this.options.size||this.options.cols||0;if(0<D){F.size=D;}}else{F=document.createElement("textarea");F.rows=(1>=this.options.rows?this.options.autoRows:this.options.rows);F.cols=this.options.cols||40;}F.name=this.options.paramName;F.value=E;F.className="editor_field";if(this.options.submitOnBlur){F.onblur=this._boundSubmitHandler;}this._controls.editor=F;if(this.options.loadTextURL){this.loadExternalText();}this._form.appendChild(this._controls.editor);},createForm:function(){var D=this;function C(B,A){var F=D.options["text"+B+"Controls"];if(!F||A===false){return;}D._form.appendChild(document.createTextNode(F));}this._form=$(document.createElement("form"));this._form.id=this.options.formId;this._form.addClassName(this.options.formClassName);this._form.onsubmit=this._boundSubmitHandler;this.createEditField();if("textarea"==this._controls.editor.tagName.toLowerCase()){this._form.appendChild(document.createElement("br"));}if(this.options.onFormCustomization){this.options.onFormCustomization(this,this._form);}C("Before",this.options.okControl||this.options.cancelControl);this.createControl("ok",this._boundSubmitHandler);C("Between",this.options.okControl&&this.options.cancelControl);this.createControl("cancel",this._boundCancelHandler,"editor_cancel");C("After",this.options.okControl||this.options.cancelControl);},destroy:function(){if(this._oldInnerHTML){this.element.innerHTML=this._oldInnerHTML;}this.leaveEditMode();this.unregisterListeners();},enterEditMode:function(B){if(this._saving||this._editing){return;}this._editing=true;this.triggerCallback("onEnterEditMode");if(this.options.externalControl){this.options.externalControl.hide();}this.element.hide();this.createForm();this.element.parentNode.insertBefore(this._form,this.element);if(!this.options.loadTextURL){this.postProcessEditField();}if(B){Event.stop(B);}},enterHover:function(B){if(this.options.hoverClassName){this.element.addClassName(this.options.hoverClassName);}if(this._saving){return;}this.triggerCallback("onEnterHover");},getText:function(){return this.element.innerHTML.unescapeHTML();},handleAJAXFailure:function(B){this.triggerCallback("onFailure",B);if(this._oldInnerHTML){this.element.innerHTML=this._oldInnerHTML;this._oldInnerHTML=null;}},handleFormCancellation:function(B){this.wrapUp();if(B){Event.stop(B);}},handleFormSubmission:function(H){var J=this._form;var I=$F(this._controls.editor);this.prepareSubmission();var G=this.options.callback(J,I)||"";if(Object.isString(G)){G=G.toQueryParams();}G.editorId=this.element.id;if(this.options.htmlResponse){var F=Object.extend({evalScripts:true},this.options.ajaxOptions);Object.extend(F,{parameters:G,onComplete:this._boundWrapperHandler,onFailure:this._boundFailureHandler});new Ajax.Updater({success:this.element},this.url,F);}else{var F=Object.extend({method:"get"},this.options.ajaxOptions);Object.extend(F,{parameters:G,onComplete:this._boundWrapperHandler,onFailure:this._boundFailureHandler});new Ajax.Request(this.url,F);}if(H){Event.stop(H);}},leaveEditMode:function(){this.element.removeClassName(this.options.savingClassName);this.removeForm();this.leaveHover();this.element.style.backgroundColor=this._originalBackground;this.element.show();if(this.options.externalControl){this.options.externalControl.show();}this._saving=false;this._editing=false;this._oldInnerHTML=null;this.triggerCallback("onLeaveEditMode");},leaveHover:function(B){if(this.options.hoverClassName){this.element.removeClassName(this.options.hoverClassName);}if(this._saving){return;}this.triggerCallback("onLeaveHover");},loadExternalText:function(){this._form.addClassName(this.options.loadingClassName);this._controls.editor.disabled=true;var B=Object.extend({method:"get"},this.options.ajaxOptions);Object.extend(B,{parameters:"editorId="+encodeURIComponent(this.element.id),onComplete:Prototype.emptyFunction,onSuccess:function(A){this._form.removeClassName(this.options.loadingClassName);var D=A.responseText;if(this.options.stripLoadedTextTags){D=D.stripTags();}this._controls.editor.value=D;this._controls.editor.disabled=false;this.postProcessEditField();}.bind(this),onFailure:this._boundFailureHandler});new Ajax.Request(this.options.loadTextURL,B);},postProcessEditField:function(){var B=this.options.fieldPostCreation;if(B){$(this._controls.editor)["focus"==B?"focus":"activate"]();}},prepareOptions:function(){this.options=Object.clone(Ajax.InPlaceEditor.DefaultOptions);Object.extend(this.options,Ajax.InPlaceEditor.DefaultCallbacks);[this._extraDefaultOptions].flatten().compact().each(function(B){Object.extend(this.options,B);}.bind(this));},prepareSubmission:function(){this._saving=true;this.removeForm();this.leaveHover();this.showSaving();},registerListeners:function(){this._listeners={};var B;$H(Ajax.InPlaceEditor.Listeners).each(function(A){B=this[A.value].bind(this);this._listeners[A.key]=B;if(!this.options.externalControlOnly){this.element.observe(A.key,B);}if(this.options.externalControl){this.options.externalControl.observe(A.key,B);}}.bind(this));},removeForm:function(){if(!this._form){return;}this._form.remove();this._form=null;this._controls={};},showSaving:function(){this._oldInnerHTML=this.element.innerHTML;this.element.innerHTML=this.options.savingText;this.element.addClassName(this.options.savingClassName);this.element.style.backgroundColor=this._originalBackground;this.element.show();},triggerCallback:function(D,C){if("function"==typeof this.options[D]){this.options[D](this,C);}},unregisterListeners:function(){$H(this._listeners).each(function(B){if(!this.options.externalControlOnly){this.element.stopObserving(B.key,B.value);}if(this.options.externalControl){this.options.externalControl.stopObserving(B.key,B.value);}}.bind(this));},wrapUp:function(B){this.leaveEditMode();this._boundComplete(B,this.element);}});Object.extend(Ajax.InPlaceEditor.prototype,{dispose:Ajax.InPlaceEditor.prototype.destroy});Ajax.InPlaceCollectionEditor=Class.create(Ajax.InPlaceEditor,{initialize:function($super,E,F,D){this._extraDefaultOptions=Ajax.InPlaceCollectionEditor.DefaultOptions;$super(E,F,D);},createEditField:function(){var B=document.createElement("select");B.name=this.options.paramName;B.size=1;this._controls.editor=B;this._collection=this.options.collection||[];if(this.options.loadCollectionURL){this.loadCollection();}else{this.checkForExternalText();}this._form.appendChild(this._controls.editor);},loadCollection:function(){this._form.addClassName(this.options.loadingClassName);this.showLoadingText(this.options.loadingCollectionText);var options=Object.extend({method:"get"},this.options.ajaxOptions);Object.extend(options,{parameters:"editorId="+encodeURIComponent(this.element.id),onComplete:Prototype.emptyFunction,onSuccess:function(transport){var js=transport.responseText.strip();if(!/^\[.*\]$/.test(js)){throw ("Server returned an invalid collection representation.");}this._collection=eval(js);this.checkForExternalText();}.bind(this),onFailure:this.onFailure});new Ajax.Request(this.options.loadCollectionURL,options);},showLoadingText:function(D){this._controls.editor.disabled=true;var C=this._controls.editor.firstChild;if(!C){C=document.createElement("option");C.value="";this._controls.editor.appendChild(C);C.selected=true;}C.update((D||"").stripScripts().stripTags());},checkForExternalText:function(){this._text=this.getText();if(this.options.loadTextURL){this.loadExternalText();}else{this.buildOptionList();}},loadExternalText:function(){this.showLoadingText(this.options.loadingText);var B=Object.extend({method:"get"},this.options.ajaxOptions);Object.extend(B,{parameters:"editorId="+encodeURIComponent(this.element.id),onComplete:Prototype.emptyFunction,onSuccess:function(A){this._text=A.responseText.strip();this.buildOptionList();}.bind(this),onFailure:this.onFailure});new Ajax.Request(this.options.loadTextURL,B);},buildOptionList:function(){this._form.removeClassName(this.options.loadingClassName);this._collection=this._collection.map(function(A){return 2===A.length?A:[A,A].flatten();});var F=("value" in this.options)?this.options.value:this._text;var D=this._collection.any(function(A){return A[0]==F;}.bind(this));this._controls.editor.update("");var E;this._collection.each(function(A,B){E=document.createElement("option");E.value=A[0];E.selected=D?A[0]==F:0==B;E.appendChild(document.createTextNode(A[1]));this._controls.editor.appendChild(E);}.bind(this));this._controls.editor.disabled=false;Field.scrollFreeActivate(this._controls.editor);}});Ajax.InPlaceEditor.prototype.initialize.dealWithDeprecatedOptions=function(C){if(!C){return;}function D(B,A){if(B in C||A===undefined){return;}C[B]=A;}D("cancelControl",(C.cancelLink?"link":(C.cancelButton?"button":C.cancelLink==C.cancelButton==false?false:undefined)));D("okControl",(C.okLink?"link":(C.okButton?"button":C.okLink==C.okButton==false?false:undefined)));D("highlightColor",C.highlightcolor);D("highlightEndColor",C.highlightendcolor);};Object.extend(Ajax.InPlaceEditor,{DefaultOptions:{ajaxOptions:{},autoRows:3,cancelControl:"link",cancelText:"cancel",clickToEditText:"Click to edit",externalControl:null,externalControlOnly:false,fieldPostCreation:"activate",formClassName:"inplaceeditor-form",formId:null,highlightColor:"#ffff99",highlightEndColor:"#ffffff",hoverClassName:"",htmlResponse:true,loadingClassName:"inplaceeditor-loading",loadingText:"Loading...",okControl:"button",okText:"ok",paramName:"value",rows:1,savingClassName:"inplaceeditor-saving",savingText:"Saving...",size:0,stripLoadedTextTags:false,submitOnBlur:false,textAfterControls:"",textBeforeControls:"",textBetweenControls:""},DefaultCallbacks:{callback:function(B){return Form.serialize(B);},onComplete:function(D,C){new Effect.Highlight(C,{startcolor:this.options.highlightColor,keepBackgroundImage:true});},onEnterEditMode:null,onEnterHover:function(B){B.element.style.backgroundColor=B.options.highlightColor;if(B._effect){B._effect.cancel();}},onFailure:function(D,C){alert("Error communication with the server: "+D.responseText.stripTags());},onFormCustomization:null,onLeaveEditMode:null,onLeaveHover:function(B){B._effect=new Effect.Highlight(B.element,{startcolor:B.options.highlightColor,endcolor:B.options.highlightEndColor,restorecolor:B._originalBackground,keepBackgroundImage:true});}},Listeners:{click:"enterEditMode",keydown:"checkForEscapeOrReturn",mouseover:"enterHover",mouseout:"leaveHover"}});Ajax.InPlaceCollectionEditor.DefaultOptions={loadingCollectionText:"Loading options..."};Form.Element.DelayedObserver=Class.create({initialize:function(F,D,E){this.delay=D||0.5;this.element=$(F);this.callback=E;this.timer=null;this.lastValue=$F(this.element);Event.observe(this.element,"keyup",this.delayedListener.bindAsEventListener(this));},delayedListener:function(B){if(this.lastValue==$F(this.element)){return;}if(this.timer){clearTimeout(this.timer);}this.timer=setTimeout(this.onTimerEvent.bind(this),this.delay*1000);this.lastValue=$F(this.element);},onTimerEvent:function(){this.timer=null;this.callback(this.element,$F(this.element));}});if(!Control){var Control={};}Control.Slider=Class.create({initialize:function(F,E,H){var G=this;if(Object.isArray(F)){this.handles=F.collect(function(A){return $(A);});}else{this.handles=[$(F)];}this.track=$(E);this.options=H||{};this.axis=this.options.axis||"horizontal";this.increment=this.options.increment||1;this.step=parseInt(this.options.step||"1");this.range=this.options.range||$R(0,1);this.value=0;this.values=this.handles.map(function(){return 0;});this.spans=this.options.spans?this.options.spans.map(function(A){return $(A);}):false;this.options.startSpan=$(this.options.startSpan||null);this.options.endSpan=$(this.options.endSpan||null);this.restricted=this.options.restricted||false;this.maximum=this.options.maximum||this.range.end;this.minimum=this.options.minimum||this.range.start;this.alignX=parseInt(this.options.alignX||"0");this.alignY=parseInt(this.options.alignY||"0");this.trackLength=this.maximumOffset()-this.minimumOffset();this.handleLength=this.isVertical()?(this.handles[0].offsetHeight!=0?this.handles[0].offsetHeight:this.handles[0].style.height.replace(/px$/,"")):(this.handles[0].offsetWidth!=0?this.handles[0].offsetWidth:this.handles[0].style.width.replace(/px$/,""));this.active=false;this.dragging=false;this.disabled=false;if(this.options.disabled){this.setDisabled();}this.allowedValues=this.options.values?this.options.values.sortBy(Prototype.K):false;if(this.allowedValues){this.minimum=this.allowedValues.min();this.maximum=this.allowedValues.max();}this.eventMouseDown=this.startDrag.bindAsEventListener(this);this.eventMouseUp=this.endDrag.bindAsEventListener(this);this.eventMouseMove=this.update.bindAsEventListener(this);this.handles.each(function(A,B){B=G.handles.length-1-B;G.setValue(parseFloat((Object.isArray(G.options.sliderValue)?G.options.sliderValue[B]:G.options.sliderValue)||G.range.start),B);A.makePositioned().observe("mousedown",G.eventMouseDown);});this.track.observe("mousedown",this.eventMouseDown);document.observe("mouseup",this.eventMouseUp);document.observe("mousemove",this.eventMouseMove);this.initialized=true;},dispose:function(){var B=this;Event.stopObserving(this.track,"mousedown",this.eventMouseDown);Event.stopObserving(document,"mouseup",this.eventMouseUp);Event.stopObserving(document,"mousemove",this.eventMouseMove);this.handles.each(function(A){Event.stopObserving(A,"mousedown",B.eventMouseDown);});},setDisabled:function(){this.disabled=true;},setEnabled:function(){this.disabled=false;},getNearestValue:function(D){if(this.allowedValues){if(D>=this.allowedValues.max()){return(this.allowedValues.max());}if(D<=this.allowedValues.min()){return(this.allowedValues.min());}var E=Math.abs(this.allowedValues[0]-D);var F=this.allowedValues[0];this.allowedValues.each(function(B){var A=Math.abs(B-D);if(A<=E){F=B;E=A;}});return F;}if(D>this.range.end){return this.range.end;}if(D<this.range.start){return this.range.start;}return D;},setValue:function(D,C){if(!this.active){this.activeHandleIdx=C||0;this.activeHandle=this.handles[this.activeHandleIdx];this.updateStyles();}C=C||this.activeHandleIdx||0;if(this.initialized&&this.restricted){if((C>0)&&(D<this.values[C-1])){D=this.values[C-1];}if((C<(this.handles.length-1))&&(D>this.values[C+1])){D=this.values[C+1];}}D=this.getNearestValue(D);this.values[C]=D;this.value=this.values[0];this.handles[C].style[this.isVertical()?"top":"left"]=this.translateToPx(D);this.drawSpans();if(!this.dragging||!this.event){this.updateFinished();}},setValueBy:function(D,C){this.setValue(this.values[C||this.activeHandleIdx||0]+D,C||this.activeHandleIdx||0);},translateToPx:function(B){return Math.round(((this.trackLength-this.handleLength)/(this.range.end-this.range.start))*(B-this.range.start))+"px";},translateToValue:function(B){return((B/(this.trackLength-this.handleLength)*(this.range.end-this.range.start))+this.range.start);},getRange:function(D){var C=this.values.sortBy(Prototype.K);D=D||0;return $R(C[D],C[D+1]);},minimumOffset:function(){return(this.isVertical()?this.alignY:this.alignX);},maximumOffset:function(){return(this.isVertical()?(this.track.offsetHeight!=0?this.track.offsetHeight:this.track.style.height.replace(/px$/,""))-this.alignY:(this.track.offsetWidth!=0?this.track.offsetWidth:this.track.style.width.replace(/px$/,""))-this.alignX);},isVertical:function(){return(this.axis=="vertical");},drawSpans:function(){var B=this;if(this.spans){$R(0,this.spans.length-1).each(function(A){B.setSpan(B.spans[A],B.getRange(A));});}if(this.options.startSpan){this.setSpan(this.options.startSpan,$R(0,this.values.length>1?this.getRange(0).min():this.value));}if(this.options.endSpan){this.setSpan(this.options.endSpan,$R(this.values.length>1?this.getRange(this.spans.length-1).max():this.value,this.maximum));}},setSpan:function(D,C){if(this.isVertical()){D.style.top=this.translateToPx(C.start);D.style.height=this.translateToPx(C.end-C.start+this.range.start);}else{D.style.left=this.translateToPx(C.start);D.style.width=this.translateToPx(C.end-C.start+this.range.start);}},updateStyles:function(){this.handles.each(function(B){Element.removeClassName(B,"selected");});Element.addClassName(this.activeHandle,"selected");},startDrag:function(I){if(Event.isLeftClick(I)){if(!this.disabled){this.active=true;var H=Event.element(I);var G=[Event.pointerX(I),Event.pointerY(I)];var F=H;if(F==this.track){var J=Position.cumulativeOffset(this.track);this.event=I;this.setValue(this.translateToValue((this.isVertical()?G[1]-J[1]:G[0]-J[0])-(this.handleLength/2)));var J=Position.cumulativeOffset(this.activeHandle);this.offsetX=(G[0]-J[0]);this.offsetY=(G[1]-J[1]);}else{while((this.handles.indexOf(H)==-1)&&H.parentNode){H=H.parentNode;}if(this.handles.indexOf(H)!=-1){this.activeHandle=H;this.activeHandleIdx=this.handles.indexOf(this.activeHandle);this.updateStyles();var J=Position.cumulativeOffset(this.activeHandle);this.offsetX=(G[0]-J[0]);this.offsetY=(G[1]-J[1]);}}}Event.stop(I);}},update:function(B){if(this.active){if(!this.dragging){this.dragging=true;}this.draw(B);if(Prototype.Browser.WebKit){window.scrollBy(0,0);}Event.stop(B);}},draw:function(F){var E=[Event.pointerX(F),Event.pointerY(F)];var D=Position.cumulativeOffset(this.track);E[0]-=this.offsetX+D[0];E[1]-=this.offsetY+D[1];this.event=F;this.setValue(this.translateToValue(this.isVertical()?E[1]:E[0]));if(this.initialized&&this.options.onSlide){this.options.onSlide(this.values.length>1?this.values:this.value,this);}},endDrag:function(B){if(this.active&&this.dragging){this.finishDrag(B,true);Event.stop(B);}this.active=false;this.dragging=false;},finishDrag:function(C,D){this.active=false;this.dragging=false;this.updateFinished();},updateFinished:function(){if(this.initialized&&this.options.onChange){this.options.onChange(this.values.length>1?this.values:this.value,this);}this.event=null;}});Sound={tracks:{},_enabled:true,template:new Template('<embed style="height:0" id="sound_#{track}_#{id}" src="#{url}" loop="false" autostart="true" hidden="true"/>'),enable:function(){Sound._enabled=true;},disable:function(){Sound._enabled=false;},play:function(D){if(!Sound._enabled){return;}var C=Object.extend({track:"global",url:D,replace:false},arguments[1]||{});if(C.replace&&this.tracks[C.track]){$R(0,this.tracks[C.track].id).each(function(A){var B=$("sound_"+C.track+"_"+A);B.Stop&&B.Stop();B.remove();});this.tracks[C.track]=null;}if(!this.tracks[C.track]){this.tracks[C.track]={id:0};}else{this.tracks[C.track].id++;}C.id=this.tracks[C.track].id;$$("body")[0].insert(Prototype.Browser.IE?new Element("bgsound",{id:"sound_"+C.track+"_"+C.id,src:C.url,loop:1,autostart:true}):Sound.template.evaluate(C));}};if(Prototype.Browser.Gecko&&navigator.userAgent.indexOf("Win")>0){if(navigator.plugins&&$A(navigator.plugins).detect(function(B){return B.name.indexOf("QuickTime")!=-1;})){Sound.template=new Template('<object id="sound_#{track}_#{id}" width="0" height="0" type="audio/mpeg" data="#{url}"/>');}else{Sound.play=function(){};}}var jPlex={version:"1.0",_dependancies:["prototype-1.6.0.3","scriptaculous"],_dependanciesFF2:["builder","effects","dragdrop","controls","slider","sound"],_classes:["jplex.common.Config","jplex.common.Locale","jplex.common.Component","jplex.xprototype.Core","jplex.xprototype.Date","jplex.xprototype.Element","jplex.xprototype.Event","jplex.xprototype.Object","jplex.xprototype.String","jplex.components.Calendar","jplex.components.MenuBar","jplex.components.MouseOverImage","jplex.components.Overlay","jplex.components.Tabs","jplex.components.Tooltip","jplex.components.Frame","jplex.components.frame.Dialog","jplex.components.frame.Modal","jplex.components.frame.FrameSet"],src:[],_loaded:[],load:function(fileName){if(jPlex._loaded[fileName]){return;}if(this.src[fileName]!=undefined){eval(jPlex.src[fileName]);return;}new Ajax.Request(this.path+fileName,{method:"get",asynchronous:false});jPlex._loaded[fileName]=true;},loadJS:function(B){document.write("<script type='text/javascript' src='"+B+"'><\/script>");},init:function(){var M=document.getElementsByTagName("script");for(var J=0;J<M.length;J++){var O=M[J];if(O.src&&O.src.match(/j[pP]lex\.js(\?.*)?$/)){var P=O.src.replace(/j[pP]lex\.js(\?.*)?$/,"");this.path=P;if(typeof Prototype!="undefined"){return;}var N=O.src.match(/\?.*load=([a-z,]*)/);var Q=(N?N[1]:jPlex._dependancies);if(navigator.userAgent.indexOf("Firefox/2")){Q=Q.concat(jPlex._dependanciesFF2);}var R=P.split("/");R.length-=2;var K=R.join("/")+"/libs/";for(var L=0;L<Q.length;L++){jPlex.loadJS(K+Q[L]+".js");}}}},include:function(J,L){var N=J.split(".");var I=jPlex.get(J);if(I){if(!window[N[N.length-1]]&&!L&&N[1]!="xprototype"){window[N[N.length-1]]=I;}return I;}if(N[N.length-1]=="*"){$A(this._classes).each(function(A){if(A.startsWith(J.replace("*",""))){this.include(A,L);}},this);return null;}var K="";var O;for(O=0;O<N.length-1;O++){K+=N[O]+"/";}if(N[N.length-2]&&N[N.length-2]=="components"){K+=N[N.length-1].toLowerCase()+"/";}K+=N[N.length-1]+".js";jPlex.load(K);var P=jPlex.get(J);var M=N[N.length-1];if(!window[M]&&!L&&N[1]!="xprototype"){window[M]=P;}return P;},get:function(E){var F=window;var D=false;$A(E.split(".")).each(function(B,A){if(F){F=F[B];}else{D=true;throw $break;}});if(D){return null;}return F;},provide:function(R,S,T){var K,N;if(!T){K=S;}else{K=T;N=S;}var Q;if(N){N=jPlex.include(N);Q=Class.create(N,K);}else{Q=Class.create(K);}var O=$A(R.split("."));var M=window;for(var L=0;L<O.length-1;L++){var P=O[L];if(!M[P]){M[P]={};}M=M[P];}M[O[O.length-1]]=Q;},extend:function(C,D){Object.extend(this.get(C),D);},useSkin:function(D){var C=$(document.body);C.removeClassName(this._skin||"");C.addClassName(D);this._skin=D;}};jPlex.init();jPlex.src["jplex/common/_module.js"]="";jPlex.src["jplex/common/Component.js"]='jPlex.include("jplex.common.Config");jPlex.include("jplex.common.Locale");jPlex.include("jplex.xprototype.*");jPlex.provide("jplex.common.Component",{initialize:function(C,B){this.component=$(C);if(!this._definition||!this._definition.name||(!this._definition.defaultContainer&&!this.component)){throw"DefinitionError: Mandatory definition or field not present (Component#initialize)";}if(!Object.isElement(this.component)){if(typeof(C)!="string"){throw"WrongParameterType: The first parameters has to be a string in case of "+"a non-existing DOM element (Component#initialize)";}this.createdComponent=true;this.component=new Element(this._definition.defaultContainer,{id:C});document.body.appendChild(this.component);}this.UID="jplex-"+this._definition.name.toLowerCase()+"-";jplex.common.Component.subclasses.each(function(F){if(this instanceof F){this.UID=this.UID+F.prototype._instanceCount++;throw $break;}}.bind(this));this._definition.defaultConfig=this._definition.defaultConfig||{};this._definition.events=this._definition.events||{};B=B||{};B.events=B.events||{};var D=this._extension?this._extension.defaultConfig||{}:{};var A=Object.extendRecursive(Object.clone(this._definition.defaultConfig),D);A=Object.extend(A,B);A.events=null;var E=this._extension?this._extension.text||{}:{};Object.extendRecursive(this._definition.text,E);this._config=new jplex.common.Config(A);this._events=new Hash();$H(B.events).each(function(F){if(Object.isArray(F.value)){F.value.each(function(G){this.setEvent(F.key,G||Prototype.emptyFunction);},this);}else{this.setEvent(F.key,F.value||Prototype.emptyFunction);}},this);this.ID=this.component.getAttribute("id");jplex.common.Component._list.set(this.ID,this);},cfg:function(A){return this._config.get(A);},setCfg:function(A,B){this._config.set(A,B);},setEvent:function(A,B){if(!this._events.get(A)){this._events.set(A,$A([]));}this.getEvent(A).push(B.bind(this));},getEvent:function(B){var A=this._events.get(B);return A?A:$A([]);},fireEvent:function(A,B){if(this.getEvent(A)){this.getEvent(A).invoke("call",this,B);}},lang:function(C){var A=$H(this._definition.text);if(!A){return false;}var B=this.cfg("lang");if(!B){B=jplex.common.Locale.lang;}return $H(A.get(B)).get(C);},locale:function(A,B){var D=this.cfg("lang");if(!D){return jplex.common.Locale.current(A,B);}var C=jplex.common.Locale.get(A,D);if(!C){return undefined;}return C.get(B);},unregister:function(){jplex.common.Component._list.set(this.ID,undefined);if(this.createdComponent){this.component.remove();}},_instanceCount:0});jPlex.extend("jplex.common.Component",{_list:$H()});$C=function(B){var A=null;if(typeof(B)=="string"){A=jplex.common.Component._list.get(B);}else{if(B instanceof jplex.common.Component){A=B;}}return A;};';jPlex.src["jplex/common/Config.js"]='jPlex.provide("jplex.common.Config",{initialize:function(A){this._oConfig=$H(A);},set:function(B,A){this._oConfig.set(B,A);},get:function(B){var A=this._oConfig.get(B);return A;},each:function(A){this._oConfig.each(A);}});';jPlex.src["jplex/common/Locale.js"]='jPlex.provide("jplex.common.Locale",{});jPlex.extend("jplex.common.Locale",{lang:"en",get:function(B,C){var A=this._components.get(B);if(!A){return undefined;}if(!C){C=this.lang;}return $H(A.get(C));},current:function(B,C){var A=this.get(B);if(!A){return undefined;}return $H(A).get(C);},init:function(B,A){return this._components.set(B,$H(A));},_components:new Hash()});jplex.common.Locale.init("Date",{fr:{DAYS_SHORT:$A(["Di.","Lu.","Ma.","Me.","Je.","Ve.","Sa."]),DAYS:$A(["Dimanche","Lundi","Mardi","Mercredi","Jeudi","Vendredi","Samedi"]),MONTHS:$A(["Janvier","Février","Mars","Avril","Mai","Juin","Juillet","Août","Septembre","Octobre","Novembre","Décembre"]),MONTHS_SHORT:$A(["Jan.","Fév.","Mars","Avr.","Mai","Juin","Jui.","Août","Sep.","Oct.","Nov.","Déc."]),FORMAT:"d/m/Y"},en:{DAYS_SHORT:$A(["Su.","Mo.","Tu.","We.","Th.","Fr.","Sa."]),DAYS:$A(["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]),MONTHS:$A(["January","February","March","April","May","June","July","August","September","October","November","December"]),MONTHS_SHORT:$A(["Jan.","Feb.","Mar.","Apr.","May","June","July","Aug.","Sep.","Oct.","Nov.","Dec."]),FORMAT:"m-d-Y"},jp:{DAYS_SHORT:$A(["\\u65E5","\\u6708","\\u706B","\\u6C34","\\u6728","\\u91D1","\\u571F"]),DAYS:$A(["\\u65E5","\\u6708","\\u706B","\\u6C34","\\u6728","\\u91D1","\\u571F"]),MONTHS:$A(["1\\u6708","2\\u6708","3\\u6708","4\\u6708","5\\u6708","6\\u6708","7\\u6708","8\\u6708","9\\u6708","10\\u6708","11\\u6708","12\\u6708"]),MONTHS_SHORT:$A(["1\\u6708","2\\u6708","3\\u6708","4\\u6708","5\\u6708","6\\u6708","7\\u6708","8\\u6708","9\\u6708","10\\u6708","11\\u6708","12\\u6708"]),FORMAT:"Y\\u5E74m\\u65E5"}});';jPlex.src["jplex/components/_module.js"]="";jPlex.src["jplex/components/calendar/Calendar.js"]='jPlex.include("jplex.components.Tooltip",false);jPlex.include("jplex.components.calendar.CalendarItem",false);jPlex.include("jplex.components.Overlay",false);jPlex.provide("jplex.components.Calendar","jplex.common.Component",{_definition:{name:"Calendar",defaultConfig:{date:new Date(),minDate:false,maxDate:false,dateFormat:"d-m-Y",titleFormat:"{M} {Y}",fade:0.3,textField:null,source:null,fastBrowse:true,zBase:11000,fastBrowseYearStart:(new Date()).getFullYear()-5,fastBrowseYearEnd:(new Date()).getFullYear()+5,fastBrowseYearStep:1},events:{onSelectEvent:Prototype.emptyFunction,onShowEvent:Prototype.emptyFunction,onHideEvent:Prototype.emptyFunction,onPositionChangeEvent:Prototype.emptyFunction},defaultContainer:"div",text:{fr:{CLOSE:"Fermer",SELECT_MONTH:"Mois",SELECT_YEAR:"Année",SELECT_END:"Terminer"},en:{CLOSE:"Close",SELECT_MONTH:"Month",SELECT_YEAR:"Year",SELECT_END:"Finish"},jp:{CLOSE:"Close",SELECT_MONTH:"\\u65E5",SELECT_YEAR:"\\u5E74",SELECT_END:"Finish"}}},initialize:function($super,E,D){$super(E,D);var B=this.cfg("date");this._selectedItem=this._focusedItem={getDate:function(){return B;}};this._currentMonth=B;this._source=$(this.cfg("source"));this._textField=$(this.cfg("textField"));if(!this._textField&&this._source){this._textField=this._source;}this._initialRender();this.render();if(this._textField&&this._source){this.component.setStyle({position:"absolute",zIndex:this.cfg("zBase")});if(Prototype.Browser.IE){this._textField.setAttribute("readOnly",true);}else{this._textField.setAttribute("readonly",true);}var A=(function(){if(this.component.visible()){return;}this.show();this._source.activate();}).bindAsEventListener(this);this._source.observe("focus",A);this._source.observe("click",A);document.observe("click",function(G){G=Event.extend(window.event||G);var F=G.pointerX(),H=G.pointerY();if(!this._source.isWithin(F,H)&&!this.component.isWithin(F,H)&&!this._fastBrowseTooltip.component.isWithin(F,H)){this.hide();}}.bindAsEventListener(this));var C=function(){if(this.component.visible()){this._focusedItem.select(null,true);}else{this.show();}}.bind(this);this._source.bindKey(Event.Key.ENTER,C,{preventDefault:true});this._source.bindKey(Event.Key.SPACE,C,{preventDefault:true});this._source.bindKey(Event.Key.TAB,(function(){this.hide();}).bind(this));this._source.bindKey(Event.Key.TAB,(function(){this.hide();}).bind(this),{shift:true});this._source.bindKey(Event.Key.ESCAPE,function(){if(this.component.visible()){this.hide();}}.bind(this),{preventDefault:true});this._source.bindKey(Event.Key.PAGE_UP,this.previous.bind(this),{preventDefault:true});this._source.bindKey(Event.Key.PAGE_DOWN,this.next.bind(this),{preventDefault:true});this._source.bindKey(Event.Key.LEFT_ARROW,this.left.bind(this),{preventDefault:true});this._source.bindKey(Event.Key.RIGHT_ARROW,this.right.bind(this),{preventDefault:true});this._source.bindKey(Event.Key.UP_ARROW,this.up.bind(this),{preventDefault:true});this._source.bindKey(Event.Key.DOWN_ARROW,this.down.bind(this),{preventDefault:true});}},show:function(){this._fixPosition();if(this.cfg("fade")==0){this.component.show();}else{new Effect.Appear(this.component,{duration:this.cfg("fade")});}},hide:function(){this._fixPosition();if(this.cfg("fade")==0){this.component.hide();}else{new Effect.Fade(this.component,{duration:this.cfg("fade")});}},select:function(A){this.items[A].select();},render:function(){this.items=$A([]);var B=this._getTbody();B.removeChildren();var J=this._currentMonth.firstDayOfMonth(),G=this._currentMonth.lastDayOfMonth();this.__fdom=J;this.__ldom=G;var K=new Date(J.getFullYear(),J.getMonth(),J.getDate()-J.getDay(),0),F=new Date(G.getFullYear(),G.getMonth(),G.getDate()+6-G.getDay(),0);var I=K,A,D=0;while(F.compareTo(I)>=0){if(I.getDay()==0){A=new Element("tr");this._getTbody().appendChild(A);}var E=new jplex.components.calendar.CalendarItem(this,I,D),C=E.getCell();var H=this._selectedItem.getDate().getTime()-I.getTime();if(H>=0&&H<86400000){E.select();E.focus();}this.items[D++]=E;A.appendChild(C);if(J.compareTo(I)>0||G.compareTo(I)<0){C.addClassName("outofmonth");}I.setNextDay();}this._setTitle(this._currentMonth.getMonth(),this._currentMonth.getFullYear());if(this._fastBrowseOverlay&&this._fastBrowseOverlay.component.visible()){this._fastBrowseOverlay.component.clonePosition(this.component);}},next:function(){var B=this._currentMonth.getMonth()+1;var A=this._currentMonth.getFullYear();if(B>11){B=0;A++;}this.goTo(B,A);},previous:function(){var B=this._currentMonth.getMonth()-1;var A=this._currentMonth.getFullYear();if(B<0){B=11;A--;}this.goTo(B,A);},goTo:function(E,D){var F=this._focusedItem.getIndex();var C=this.__fdom.getDay();var A=new Date();if(!Object.isUndefined(E)){A.setMonth(E);}if(D){A.setYear(D);}this._currentMonth=A.firstDayOfMonth();this.render();var B=this.__fdom.getDay()+Math.min(this.__ldom.getDate()-1,F-C);this.items[B].focus();if(this._source){this._source.activate();}},left:function(){var A=Math.max(0,this._focusedItem.getIndex()-1);this.items[A].focus();},right:function(){var A=Math.min(this._focusedItem.getIndex()+1,this.items.length-1);this.items[A].focus();},up:function(){var A=Math.max(0,this._focusedItem.getIndex()-7);this.items[A].focus();},down:function(){var A=Math.min(this._focusedItem.getIndex()+7,this.items.length-1);this.items[A].focus();},setSelectedItem:function(A){this._selectedItem=A;if(this._textField&&this._textField.getAttribute("type")!="button"){this._textField.value=A.getDate().format(this.cfg("dateFormat"));}},setFocusedItem:function(A){this._focusedItem=A;},getSelectedItem:function(){return this._selectedItem;},getFocusedItem:function(){return this._focusedItem;},getTextField:function(){return this._textField;},getFormattedValue:function(B){var A=B?B:this.cfg("dateFormat");return this._selectedItem.getDate().format(A);},_initialRender:function(){this.component.addClassName("jplex-calendar");if(this._source){this._source.addClassName("jplex-calendar");this.component.setStyle({display:"none"});if(Prototype.Browser.IE6){if(this._source.getAttribute("type")=="button"){this._source.addClassName("jplex-calendar-button");}else{if(this._source.getAttribute("type")=="text"){this._source.addClassName("jplex-calendar-text");}}}}var E=new Element("div").addClassName("top"),G=new Element("span",{id:this.UID+"_TITLE"}).addClassName("title"),Q=new Element("span").addClassName("previous").update("&nbsp;&laquo;&nbsp"),A=new Element("span").addClassName("next").update("&nbsp;&raquo;&nbsp"),L=new Element("table",{id:this.UID+"_TABLE"}).addClassName("calendar"),F=new Element("tbody").update("&nbsp;"),O=new Element("thead"),C=new Element("tr"),K=new Element("div",{id:this.UID+"_CLOSE"}).addClassName("close").update("&nbsp;"+this.lang("CLOSE")+"&nbsp;");O.appendChild(C);L.appendChild(O);L.appendChild(F);E.appendChild(Q);E.appendChild(G);E.appendChild(A);this.component.appendChild(E);this.component.appendChild(L);if(this._textField&&this._source){this.component.appendChild(K);}this.component.IEFixCombobox();A.observe("click",this.next.bindAsEventListener(this));Q.observe("click",this.previous.bindAsEventListener(this));K.observe("click",this.hide.bindAsEventListener(this));$A(this.locale("Date","DAYS_SHORT")).each(function(R){C.appendChild(new Element("th").update(R));});if(this.cfg("fastBrowse")){var N=new Element("select");$A(this.locale("Date","MONTHS")).each(function(S,R){N.appendChild((new Element("option",{value:R})).update(S));});var J=new Element("select");$R(this.cfg("fastBrowseYearStart"),this.cfg("fastBrowseYearEnd")).each(function(R){J.appendChild((new Element("option",{value:R})).update(R));});var M=new Element("input",{value:this.lang("SELECT_END"),type:"button"});M.addClassName("end");this._fastBrowseTooltip=new jplex.components.Tooltip(this.UID+"-fbtooltip",{source:this._getTitle(),trigger:jplex.components.Tooltip.TRIGGER_CLICK,position:"bottom-right",positionRatio:0.35,zIndex:this.cfg("zBase")+2});var B=this._fastBrowseTooltip.getBody();this._fastBrowseTooltip.component.addClassName("jplex-calendar-tooltip");var D=new Element("div").update(this.lang("SELECT_MONTH")+"<br/>");D.appendChild(N);D.addClassName("select");var P=new Element("div").update(this.lang("SELECT_YEAR")+"<br/>");P.appendChild(J);P.addClassName("select");B.appendChildren(D,P,M);if(!Prototype.Browser.IE6){this._fastBrowseTooltip.setEvent("onShowEvent",function(){if(!this._fastBrowseOverlay){this._fastBrowseOverlay=new jplex.components.Overlay(this.UID+"-overlay",{z:this.cfg("zBase")+1,source:this.component,opacity:0.3,fade:0.5});this._fastBrowseOverlay.component.addClassName("jplex-calendar-overlay");}this._fastBrowseOverlay.show();}.bind(this));this._fastBrowseTooltip.setEvent("onHideEvent",function(){if(this._fastBrowseOverlay){this._fastBrowseOverlay.hide();}}.bind(this));}var H=function(R){R=Event.extend(window.event?window.event:R);R.cancelBubble=true;return false;};N.observe("click",H);J.observe("click",H);M.observe("click",this._fastBrowseTooltip.hide.bind(this._fastBrowseTooltip));var I=function(){this.goTo(parseInt(N.value),parseInt(J.value));}.bind(this);N.observe("change",I);J.observe("change",I);N.value=this.cfg("date").getMonth();J.value=this.cfg("date").getFullYear();}this._fixPosition();},_getTbody:function(){return $(this.UID+"_TABLE").childNodes[1];},_getThead:function(){return $(this.UID+"_TABLE").childNodes[0];},_getTable:function(){return $(this.UID+"_TABLE");},_getTitle:function(){return $(this.UID+"_TITLE");},_setTitle:function(B,A){var C=this.cfg("titleFormat").gsub("{M}",this.locale("Date","MONTHS")[B]).gsub("{Y}",A).gsub("{m}",(B+1).toString());this._getTitle().update("&nbsp;"+C+"&nbsp;");},_fixPosition:function(){if(!this._source){return;}var B=this._source.cumulativeOffset();var A={left:B.left,top:B.top+this._source.getHeight()};this.component.setStyle({left:A.left+"px",top:A.top+"px"});if(this._fastBrowseOverlay){this._fastBrowseOverlay.component.setStyle({left:A.left+"px",top:A.top+"px"});}this.fireEvent("onPositionChangeEvent",{position:A,dimensions:this.component.getDimensions()});}});';jPlex.src["jplex/components/calendar/CalendarItem.js"]='jPlex.provide("jplex.components.calendar.CalendarItem",{initialize:function(B,C,A){this._calendar=B;this._date=new Date();this._date.setTime(C.getTime());this._index=A;this._cell=new Element("td",{id:this._calendar.ID+"_DAY_"+A}).update(C.getDate().toString());if(Prototype.Browser.IE6){this._cell.observe("mouseover",function(){this._cell.addClassName("ie6-hover");}.bind(this));this._cell.observe("mouseout",function(){this._cell.removeClassName("ie6-hover");}.bind(this));}if(this.check()){this._cell.observe("click",this.select.bindAsEventListener(this,true));}else{this._cell.addClassName("disabled");}},select:function(B,A){if(!this.check()){return;}if(this._calendar.getSelectedItem()._unselect){this._calendar.getSelectedItem()._unselect();}if(!this._cell.hasClassName("selected")){this._cell.addClassName("selected");}this.focus();this._calendar.setSelectedItem(this);if(A&&this._calendar.getTextField()){this._calendar.hide();}this._calendar.fireEvent("onSelectEvent",{date:this._date});},focus:function(){if(!this.check()){return;}if(this._calendar.getFocusedItem()._blur){this._calendar.getFocusedItem()._blur();}if(!this._cell.hasClassName("focused")){this._cell.addClassName("focused");}this._calendar.setFocusedItem(this);},check:function(){var A=this._calendar.cfg("minDate"),B=this._calendar.cfg("maxDate");return(!A||this._date.compareTo(A)>=-86400000)&&(!B||this._date.compareTo(B)<=0);},getCell:function(){return this._cell;},getIndex:function(){return this._index;},getDate:function(){return this._date;},_unselect:function(){this._cell.removeClassName("selected");},_blur:function(){this._cell.removeClassName("focused");}});';jPlex.src["jplex/components/frame/Dialog.js"]='jPlex.provide("jplex.components.frame.Dialog","jplex.components.Frame",{_extension:{name:"WindowDialog",defaultConfig:{footer:true,center:true,draggable:true,okButton:true,cancelButton:true,okButtonLabel:"",cancelButtonLabel:"",otherButtons:[]},events:{onOkButtonClickEvent:Prototype.emptyFunction,onCancelButtonClickEvent:Prototype.emptyFunction},text:{fr:{OK:"OK",CANCEL:"Annuler"},en:{OK:"OK",CANCEL:"Cancel"}}},initialize:function($super,B,A){$super(B,A);this._addButtons();if($(this.sID+"-closecross")){$(this.sID+"-closecross").observe("click",this._cancelButtonClick.bind(this));}},_addButtons:function(){var C=this.component.down("div.footer");$A(this.cfg("otherButtons")).each(function(F,E){var D=new Element("input",{type:"button",id:this.sID+"-bt"+E,value:F.label});C.appendChild(D);D.observe("click",F.click.bindAsEventListener(this));}.bind(this));if(this.cfg("okButton")){var A=new Element("input",{type:"button",id:this.sID+"-ok",value:this.cfg("okButtonLabel")||true?this.lang("OK"):this.cfg("okButtonLabel")});C.appendChild(A);A.observe("click",this._okButtonClick.bindAsEventListener(this));}if(this.cfg("cancelButton")){var B=new Element("input",{type:"button",id:this.sID+"-cancel",value:this.cfg("cancelButtonLabel").blank()?this.lang("CANCEL"):this.cfg("cancelButtonLabel")});C.appendChild(B);B.observe("click",this._cancelButtonClick.bindAsEventListener(this));}},_okButtonClick:function(){this.fireEvent("onOkButtonClickEvent");},_cancelButtonClick:function(){this.fireEvent("onCancelButtonClickEvent");this.hide();}});';jPlex.src["jplex/components/frame/Frame.js"]='jPlex.include("jplex.components.Overlay",true);jPlex.provide("jplex.components.Frame","jplex.common.Component",{_definition:{name:"Frame",defaultConfig:{header:true,footer:false,center:true,constrainToCenter:false,close:"button",draggable:false,title:"",ajax:null,ajaxParameters:{},modal:false,zBase:9998,overlayColor:"#000000",overlayOpacity:0.6,overlayFade:false,width:null,heigth:null,minWidth:null,minHeight:null,maxWidth:null,maxHeight:null,overflow:"auto",constrainToViewport:true,top:null,left:null},events:{beforeRenderEvent:Prototype.emptyFunction,afterRenderEvent:Prototype.emptyFunction,onAjaxRequestCompleteEvent:Prototype.emptyFunction,onShowEvent:Prototype.emptyFunction,onHideEvent:Prototype.emptyFunction},defaultContainer:"div",text:{fr:{},en:{}}},initialize:function($super,B,A){$super(B,A);this._level=this.cfg("zBase")+2*jplex.components.Frame.list.length+1;this.render();jplex.components.Frame.list.push(this);this._evtMakeCentered=this.makeCentered.bind(this);},render:function(){this.fireEvent("beforeRenderEvent");this.component.addClassName("jplex-window");if(this.cfg("header")){this._addHeader(this.cfg("title"));}this.setBody(this.component.textContent||"");this._body.setStyle({overflow:this.cfg("overflow")});if(this.cfg("ajax")){this.reload();}if(this.cfg("footer")){this._addFooter();}if(this.cfg("close")==jplex.components.Frame.CLOSE_BUTTON){if(!this._header){}this._addCloseButton();}if(this.cfg("modal")){this._addOverlay();}if(this.cfg("draggable")){if(this._header){this._drag=new Draggable(this.component,{handle:this._header,snap:this._constrainToViewport.bind(this)});}else{this._drag=new Draggable(this.component,{snap:this._constrainToViewport.bind(this)});}}this.component.setStyle({zIndex:this._level});this.fireEvent("afterRenderEvent");},getZIndex:function(){return this._level;},setHeader:function(A){if(this._header){this._title.update(A);}else{this._addHeader(A);}return this._header;},setTitle:function(A){this.setHeader(A);},setBody:function(A){if(this._body){this.setLoading(true);this.makeCentered();var C=new Element("div");C.update(A.stripScripts());var D=C.getElementsByTagName("img");var B=$A([]);if(D.length>0){$A(D).each(function(H,G){var F=$(H);var E=F.src;B[G]=false;if(Prototype.Browser.Opera){F.src="";}F.observe("load",function(J,I,K){B[K]=true;I.show();if(B.all()){this._body.update(C.innerHTML);if(this._request){this._request.transport.responseText.evalScripts();this.fireEvent("onAjaxRequestCompleteEvent",{result:A});}this.setLoading(false);}}.bindAsEventListener(this,F,G));if(Prototype.Browser.Opera){F.src=E;if(F.complete){F.removeEvents();}}},this);}else{this._body.update(C.innerHTML);if(this._request){this._request.transport.responseText.evalScripts();this.fireEvent("onAjaxRequestCompleteEvent",{result:this._request.transport});}this.constrain();this.setLoading(false);}}else{this._addBody(A);}this.constrain();this.fireEvent("onContentChangeEvent");return this._body;},setFooter:function(A){if(this._footer){this._footer.update(A);}else{this._addFooter(A);}return this._footer;},_addOverlay:function(){this._overlay=new jplex.components.Overlay(this.UID+"-overlay",{color:this.cfg("overlayColor"),z:this._level-1,fade:this.cfg("overlayFade"),opacity:this.cfg("overlayOpacity")});this._overlay.component.observe("click",function(A){if(this.cfg("close")==jplex.components.Frame.CLOSE_CLICK_OUT){this.hide();}A.stop();}.bind(this));},_addCloseButton:function(){var A=new Element("a",{id:this.ID+"-closecross"});A.addClassName("close").update("&nbsp;");A.observe("click",this.hide.bind(this));(this._header||this._body).appendChild(A);},_addHeader:function(A){var B=new Element("div");this._title=new Element("div");B.appendChild(this._title.addClassName("title").update(A||""));B.addClassName("header");this.component.insert({top:B});this._header=B;},_addBody:function(A){var B=new Element("div");B.addClassName("body");if(this._header){this._header.insert({after:B});}else{if(this._footer){this._footer.insert({before:B});}else{this.component.insert(B);}}this._body=B;this.setBody(A);},_addFooter:function(A){var B=new Element("div");B.addClassName("footer").update(A||"");this.component.insert({bottom:B});this._footer=B;},reload:function(){this.setLoading(true);this._request=new Ajax.Request(this.cfg("ajax"),{parameters:this.cfg("ajaxParameters"),evalJS:false,onSuccess:function(A){this.setBody(A.responseText);}.bind(this)});},show:function(){if(this.cfg("modal")){this._overlay.show();}if(this.cfg("constrainToCenter")){this.makeCentered();Event.observe(window,"scroll",this._evtMakeCentered);Event.observe(window,"resize",this._evtMakeCentered);}this.component.show();this.fireEvent("onShowEvent");},hide:function(){if(this.cfg("modal")){this._overlay.hide();}this.component.hide();Event.stopObserving(window,"scroll",this._evtMakeCentered);Event.stopObserving(window,"resize",this._evtMakeCentered);this.fireEvent("onHideEvent");},makeCentered:function(B){var D=this.component.getDimensions();var C=document.viewport.getDimensions();var A=document.viewport.getScrollOffsets();this.component.setStyle({top:Math.max(0,C.height/2-D.height/2+A.top)+"px",left:Math.max(0,C.width/2-D.width/2+A.left)+"px"});if(!B&&this._evtMakeCentered){this._evtMakeCentered.delay(0.1,true);}},setLoading:function(B){var A=this.component.down("div.loading");if(B){if(!A){A=new Element("div").addClassName("loading");A.setStyle({zIndex:this._level+1});A.setOpacity(0.7);this.component.appendChild(A);}A.show();}else{if(A){A.hide();}}this.constrain();},constrain:function(){this._constrainToSize();if(this.cfg("center")&&this.cfg("constrainToCenter")){this.makeCentered();}if(this.cfg("constrainToViewport")){this._constrainToViewport();}},_constrainToViewport:function(A,G){if(!this.cfg("constrainToViewport")){return[A,G];}if(typeof(A)=="undefined"||typeof(G)=="undefined"){var F=this.component.cumulativeOffset();A=F.left;G=F.top;}var D=document.viewport.getWidth(),E=document.viewport.getHeight(),B=this.component.getWidth(),C=this.component.getHeight();return[B>D?0:(A<D-B?(A>0?A:0):D-B),C>E?0:(G<E-C?(G>0?G:0):E-C)];},_constrainToSize:function(){if(Prototype.Browser.Opera){return;}var E=this._body;var D={body:this._body.getDimensions(),frame:this.component.getDimensions()};D.fixed={width:D.frame.width-D.body.width,height:D.frame.height-D.body.height};var A=null,C=null,F=null,B=null;if(this.cfg("minWidth")){A=Math.max(0,this.cfg("minWidth")-D.fixed.width);E.setStyle({minWidth:A+"px"});}if(this.cfg("minHeight")){C=Math.max(0,this.cfg("minHeight")-D.fixed.height);E.setStyle({minHeight:C+"px"});}if(this.cfg("maxWidth")){F=Math.max(0,this.cfg("maxWidth")-D.fixed.width);this.component.setStyle({maxWidth:F+"px"});}if(this.cfg("maxHeight")){B=Math.max(this.cfg("maxHeight")-D.fixed.height);E.setStyle({maxHeight:B+"px"});}if(Prototype.Browser.IElt8){if(this.cfg("minWidth")&&this.cfg("minWidth")>D.frame.width){E.setStyle({width:A+"px"});}if(this.cfg("minHeight")&&this.cfg("minHeight")>D.frame.height){E.setStyle({height:C+"px"});}if(this.cfg("maxWidth")&&this.cfg("maxWidth")<D.frame.width){this.component.setStyle({width:F+"px"});}if(this.cfg("maxHeight")&&this.cfg("maxHeight")<D.frame.height){E.setStyle({height:B+"px"});}}}});jPlex.extend("jplex.components.Frame",{list:$A([]),CLOSE_BUTTON:"button",CLOSE_CLICK_OUT:"clickout",CLOSE_CUSTOM:"custom"});';jPlex.src["jplex/components/frame/FrameSet.js"]='jPlex.include("jplex.components.Frame",false);jPlex.provide("jplex.components.frame.FrameSet","jplex.common.Component",{_definition:{name:"FrameSet",defaultConfig:{overlay:false,overlayColor:"#000000",overlayOpacity:0.6},events:{onAddFrameEvent:Prototype.emptyFunction},defaultContainer:"div"},initialize:function($super,B,A){$super(B,A);this.windows=$A([]);if(this.cfg("overlay")){this.overlay=new jplex.components.Overlay(this.sID+"-overlay",{z:0,color:this.cfg("overlayColor"),opacity:this.cfg("overlayOpacity")});this.overlay.show();}},add:function(C){var A=typeof(C)=="string"?new jplex.components.Frame(C,{draggable:true}):C;var B=this.windows.length;A.show();this.windows.push(A);A.toFront=this._winToFront.methodize();A._group=this;A._groupPosition=B;A.component.setStyle({zIndex:B});A.component.observe("click",A.toFront.bindAsEventListener(A));this.fireEvent("onAddFrameEvent",{frame:A});return A;},_winToFront:function(A){var C;for(var B=A._groupPosition+1;B<A._group.windows.length;B++){C=A._group.windows[B].component.getStyle("zIndex");A._group.windows[B-1]=A._group.windows[B];A._group.windows[B-1]._groupPosition--;A._group.windows[B-1].component.setStyle({zIndex:Math.max(0,C-1)});}A._group.windows[A._group.windows.length-1]=A;if(C){A.component.setStyle({zIndex:C});}A._groupPosition=A._group.windows.length-1;}});';jPlex.src["jplex/components/frame/Modal.js"]='jPlex.provide("jplex.components.frame.Modal","jplex.components.Frame",{_extension:{name:"Modal",defaultConfig:{header:false,modal:true,close:jplex.components.Frame.CLOSE_CLICK_OUT}},initialize:function($super,B,A){A.modal=true;$super(B,A);}});';jPlex.src["jplex/components/menubar/MenuBar.js"]='jPlex.include("jplex.components.menubar.MenuBarItem",false);jPlex.provide("jplex.components.MenuBar","jplex.common.Component",{_definition:{name:"MenuBar",defaultConfig:{data:[],source:0},events:{beforeRenderEvent:Prototype.emptyFunction,afterRenderEvent:Prototype.emptyFunction,onClickEvent:Prototype.emptyFunction,onItemAddEvent:Prototype.emptyFunction},defaultContainer:"div"},initialize:function($super,B,A){$super(B,A);this.render();this._items=$A([]);this._getData().each(function(C){this.addItem(C);}.bind(this));document.observe("click",function(C){C=Event.extend(window.event?window.event:C);if(!$(Event.element(C)).up("li.item")){this.setActive(false);this.hide();}this.fireEvent("onClickEvent",{event:C});}.bind(this));if(Prototype.Browser.IE6){$$("div.jplex-menubar ul.with-icon > li.item-with-icon","div.jplex-menubar ul.with-icon > li.item-without-icon").each(function(C){$(C).setStyle({paddingLeft:"26px"});});}},render:function(){this.fireEvent("beforeRenderEvent");this.component.addClassName("jplex-menubar");this.me=new Element("ul");this.component.appendChild(this.getHTMLElement());this.fireEvent("afterRenderEvent");},hide:function(){this._items.each(function(A){A.getSubmenu().hide();});},addItem:function(C,E){var D=new jplex.components.menubar.MenuBarItem(this,C,0);if(E){this.getHTMLElement().insertBefore(D.getHTMLElement(),this._items[E].getHTMLElement());var B=$A([]);for(var A=0;A<this._items.length;A++){if(A==E){B.push(D);}B.push(this._items[A]);}this._items=B.compact();}else{this.getHTMLElement().appendChild(D.getHTMLElement());this._items.push(D);}this.fireEvent("onItemAddEvent",{item:D});return this;},removeItem:function(A){this.getHTMLElement().removeChild(this.getItem(A).getMenu().getHTMLElement());delete this._items[A];this._items=this._items.compact();},getItem:function(A){return this._items[A].getSubmenu();},getHTMLElement:function(){return this.me;},getRootMenuBar:function(){return this;},isActive:function(){return this._activate;},setActive:function(A){this._activate=A;},getItems:function(){return this._items;},_getData:function(){var A;if(jplex.components.MenuBar.SOURCE_JS_ARRAY==this.cfg("source")){A=this.cfg("data");}else{if(jplex.components.MenuBar.SOURCE_AJAX_XML==this.cfg("source")){}else{if(jplex.components.MenuBar.SOURCE_AJAX_JSON==this.cfg("source")){}}}return $A(A);}});jPlex.extend("jplex.components.MenuBar",{SOURCE_JS_ARRAY:0,SOURCE_AJAX_XML:1,SOURCE_AJAX_JSON:2});';jPlex.src["jplex/components/menubar/MenuBarItem.js"]='jPlex.include("jplex.components.menubar.MenuBarSubmenu",false);jPlex.provide("jplex.components.menubar.MenuBarItem",{initialize:function(B,A,C){this._level=C;this._label=A.name;this._event=A.click?A.click.bind(this):Prototype.emptyFunction;this._shortcut=A.shortcut;this._icon=A.icon;this._link=A.link;this._menu=B;this.render(A.items);this.me.observe("mouseover",this._onMouseOver.bindAsEventListener(this));this.me.observe("click",this._onClick.bindAsEventListener(this));if(this._shortcut){document.bindKey(this._shortcut.key,this._event.wrap(function(D){this.getMenu().getRootMenuBar().setActive(false);return D();}).bind(this),{ctrl:this._shortcut.ctrl,preventDefault:true});}},render:function(A){this.me=new Element("li").update(this._label);if(this._link){this.me.observe("click",function(){window.location=this._link;}.bind(this));}this.me.addClassName(this._level==0?"first":"item");var B;if(this._shortcut){B=new Element("span");B.update(this._shortcut.text).addClassName("shortcut");this.me.appendChild(B);}if(this._icon){this.getMenu().getHTMLElement().addClassName("with-icon");if(Prototype.Browser.IE6){this.me.removeClassName("item");this.me.addClassName("item-with-icon");}else{this.me.addClassName("icon");}this.me.setStyle({backgroundImage:"url(\'"+this._icon+"\')"});}else{if(Prototype.Browser.IE6){this.me.removeClassName("item");this.me.addClassName("item-without-icon");}else{this.me.addClassName("no-icon");}}this._submenu=new jplex.components.menubar.MenuBarSubmenu(this,A,this._level);this.me.appendChild(this.getSubmenu().getHTMLElement());this.me.appendChild(this._submenu._shadow);if(!this.getSubmenu().isEmpty()&&this._level!=0){this._addSubmenuIndicator();}if(Prototype.Browser.IE6){var C="ie6-item-hover";if(this._level==0){C="ie6-first-hover";}this.me.observe("mouseover",function(){this.me.addClassName(C);}.bind(this));this.me.observe("mouseout",function(){if(this.me.hasClassName(C)){this.me.removeClassName(C);}}.bind(this));}},getSubmenu:function(){return this._submenu;},getHTMLElement:function(){return this.me;},getMenu:function(){return this._menu;},getDetails:function(){return{label:this._label||"",icon:this._icon||false,shortcut:this._shortcut||false,link:this._link||false,level:this._level,event:this._event||false};},_addSubmenuIndicator:function(){if(this._level!=0){var A=new Element("span");this.me.appendChild(A.addClassName("parent"));}},_onMouseOver:function(A){A=Event.extend(window.event?window.event:A);if(!this.getMenu().getRootMenuBar().isActive()){A.cancelBubble=true;return;}this.getSubmenu().show();this.getMenu().getItems().each(function(B){if(B!==this){B.getSubmenu().hide();}}.bind(this));},_onClick:function(A){A=Event.extend(window.event?window.event:A);this._event();if(this._level==0){if($(Event.element(A).up("li.item"))){return false;}else{this.getMenu().getRootMenuBar().setActive(true);A.cancelBubble=true;this.getSubmenu().show();}}else{A.cancelBubble=true;this.getMenu().getRootMenuBar().setActive(false);if(this.getSubmenu().isEmpty()){this.getMenu().getRootMenuBar().hide();}}}});';jPlex.src["jplex/components/menubar/MenuBarSubmenu.js"]='jPlex.provide("jplex.components.menubar.MenuBarSubmenu",{initialize:function(A,B,D){this._level=D;this._parent=A;this._items=$A([]);this.render();if(B){for(var C=0;C<B.length;C++){if(!B[C]||!B[C].name){continue;}this.addItem(B[C]);}}},render:function(){this.me=$(new Element("ul"));this._shadow=$(new Element("div"));this._shadow.setStyle({background:"#000000",zIndex:2*this._level,position:"absolute"}).setOpacity(0.2);this.me.addClassName("submenu").setStyle({display:"none",zIndex:2*this._level+1});},show:function(){if(!this.isEmpty()&&!this.me.visible()){this.me.show();this._shadow.show();this._fixPosition();}},hide:function(){if(!this.isEmpty()&&this.me.visible()){this._items.each(function(A){A.getSubmenu().hide();});this.me.hide();this._shadow.hide();}},getHTMLElement:function(){return this.me;},isEmpty:function(){return this._items.length==0;},addItem:function(C,D){var C=new jplex.components.menubar.MenuBarItem(this,C,this._level+1);if(D){this.me.insertBefore(C.getHTMLElement(),this._items[D].getHTMLElement());var B=$A([]);for(var A=0;A<this._items.length;A++){if(A==D){B.push(C);}B.push(this._items[A]);}this._items=B.compact();}else{this.me.appendChild(C.getHTMLElement());this._items.push(C);}C.getMenu().getParentItem()._addSubmenuIndicator();this.getRootMenuBar().fireEvent("onItemAddEvent",{item:C});return this;},getItem:function(A){var B=this._items[A];if(B){return this._items[A].getSubmenu();}else{return false;}},removeItem:function(A){var B=this.getItem(A);if(B){this.me.removeChild(B.getParentItem().getHTMLElement());delete this._items[A];this._items=this._items.compact();return this;}else{return false;}},getParentItem:function(){return this._parent;},getRootMenuBar:function(){var A=this.getParentItem().getMenu();if(A._level==0){return A.getParentItem().getMenu();}else{return A.getRootMenuBar();}},getItems:function(){return this._items;},_fixPosition:function(){var A=this.getParentItem().getHTMLElement();var D=A.positionedOffset();var C,B;if(this._level==0){C=D.top+A.getHeight();B=D.left;}else{C=D.top;B=D.left+A.getWidth();}this.me.setStyle({top:C+"px",left:B+"px"});this._shadow.setStyle({top:C+"px",left:(B-2)+"px",width:(this.me.getWidth()+4)+"px",height:(this.me.getHeight()+2)+"px"});}});';jPlex.src["jplex/components/mouseoverimage/MouseOverImage.js"]='jPlex.provide("jplex.components.MouseOverImage","jplex.common.Component",{_definition:{name:"MouseOverImage",defaultConfig:{position:"top-right",style:false,img:false,method:"absolute",padding:4},events:{onClickEvent:Prototype.emptyFunction},defaultContainer:"div"},initialize:function($super,C,B){$super(C,B);var D;if(this.cfg("img")){D=new Element("div");D.appendChild(new Element("img",{border:0,src:this.cfg("img")}));}else{if(this.cfg("style")){D=new Element("span").update(" ");}else{throw {message:"Mandatory argument not provided"};}}this.eImg=D;if(this.cfg("style")){D.addClassName(this.cfg("style"));}D.hide();this.component.insert({top:D});this.position=this._getPositionFromCfg();this._bindEvents();if(this.cfg("method")=="float"){if(this.position[1]!="left"&&this.position[1]!="right"){throw {message:"Wrong position given considering method \'float\'"};}var A=this.cfg("padding")+"px";this.eImg.setStyle({cssFloat:this.position[1],position:"relative",top:A});if(this.position[1]=="left"){this.eImg.setStyle({left:A});}else{this.eImg.setStyle({right:A});}}else{this.eImg.setStyle({position:"absolute"});this.setPosition();}return this;},setPosition:function(){if(this.cfg("method")!="absolute"){return;}var B=!this.component.visible();if(B){this.component.show();}var E=this.component.getDimensions();var C=this.eImg.getDimensions();var A=[];var D=this.cfg("padding");if(this.position[0]=="top"){A[0]=D;}else{if(this.position[0]=="bottom"){A[0]=E.height-C.height-D;}else{if(this.position[0]=="center"){A[0]=(E.height-C.height)/2;}}}if(this.position[1]=="left"){A[1]=D;}else{if(this.position[1]=="right"){A[1]=E.width-C.width-D;}else{if(this.position[1]=="center"){A[1]=(E.width-C.width)/2;}}}this.eImg.clonePosition(this.component,{setWidth:false,setHeight:false,offsetTop:A[0],offsetLeft:A[1]});if(B){this.component.hide();}},_getPositionFromCfg:function(){var A=["center","center"];var B=this.cfg("position").split("-");if(B.length==2){A=B;}else{B=B[0];if(B=="top"||B=="bottom"){A[0]=B;}else{A[1]=B;}}return A;},_bindEvents:function(){var A=this.eImg;if(this.getEvent("onClickEvent")!==Prototype.emptyFunction){A.setStyle({cursor:"pointer"});A.observe("click",this.getEvent("onClickEvent"));}this.component.observe("mouseover",function(){this.eImg.show();this.setPosition();}.bind(this));this.component.observe("mouseout",function(){this.eImg.hide();}.bind(this));}});';jPlex.src["jplex/components/overlay/Overlay.js"]='jPlex.provide("jplex.components.Overlay","jplex.common.Component",{_definition:{name:"Overlay",defaultConfig:{opacity:0.75,fade:false,z:1,color:"#000000",source:document.body},events:{beforeRenderEvent:Prototype.emptyFunction,afterRenderEvent:Prototype.emptyFunction,onShowEvent:Prototype.emptyFunction,onHideEvent:Prototype.emptyFunction},defaultContainer:"div"},initialize:function($super,B,A){$super(B,A);this.render();},render:function(){this.fireEvent("beforeRenderEvent");if(!$(this.cfg("source"))||this.cfg("source")==document.body){if(Prototype.Browser.IE6){this.component.setStyle({top:0,left:0,position:"absolute"});var A=function(){var E=document.viewport.getDimensions();var D=document.viewport.getScrollOffsets();this.component.setStyle({width:E.width+"px",height:E.height+"px",top:D.top+"px",left:D.left+"px"});}.bind(this);Event.observe(window,"resize",A);Event.observe(window,"scroll",A);this.setEvent("IEonShowEvent",A);}else{this.component.setStyle({position:"fixed",top:0,left:0,width:"100%",height:"100%",zIndex:this.cfg("z"),background:this.cfg("color")});}}else{this.component.clonePosition(this.cfg("source"));this.component.setStyle({position:"absolute",zIndex:this.cfg("z")});if(Prototype.Browser.IE){var B=document.viewport.getScrollOffsets();var C=this.component.cumulativeOffset();this.component.setStyle({top:(C.top+B.top)+"px",left:(C.left+B.left)+"px"});}}this.component.setStyle({zIndex:this.cfg("z"),background:this.cfg("color"),display:"none"});this.component.setOpacity(this.cfg("opacity"));this.fireEvent("afterRenderEvent");},show:function(){if(!this.cfg("fade")){this.component.show();}else{new Effect.Appear(this.component,{duration:this.cfg("fade"),to:this.cfg("opacity")});}this.fireEvent("IEonShowEvent");this.fireEvent("onShowEvent");},hide:function(){if(!this.cfg("fade")){this.component.hide();}else{new Effect.Fade(this.component,{duration:this.cfg("fade")});}this.fireEvent("onHideEvent");}});';jPlex.src["jplex/components/tabs/Tabs.js"]='jPlex.provide("jplex.components.Tabs","jplex.common.Component",{_definition:{name:"Tabs",defaultConfig:{data:null,style:"jplex-tabs",method:"div",ajaxDiv:false,ajaxMethod:"get",ajaxReload:false,activeTab:0,events:{onSwitchEvent:Prototype.emptyFunction}},defaultContainer:"ul"},cache:$A(),initialize:function($super,D,C){$super(D,C);if(this.cfg("method")!="div"&&!this.cfg("ajaxDiv")){throw"Mandatory parameter \'ajaxDiv\' not provided";}this.aDefinition=$A(this.cfg("data"));if(!this.aDefinition){throw"Mandatory parameter \'data\' not provided";}this.component.addClassName(this.cfg("style"));var A=this.cfg("activeTab");this.aDefinition.each(function(G,F){var E=new Element("li").update(G.title);if(F==A){this.oldLi=E;E.addClassName(this.cfg("style")+"-active");this.activeTab=G.content;}E.observe("click",this.handler.curry(G.content,E).bind(this));this.component.appendChild(E);}.bind(this));if(this.cfg("method")=="div"){this.initDivMethod(this.aDefinition,A);}else{this.initAjaxMethod(this.aDefinition,A);}var B=this.cfg("ajaxDiv");if(B){this.ajaxDiv=B;}},initDivMethod:function(B,A){B.each(function(C){$(C.content).hide();});$(B[A].content).show();},initAjaxMethod:function(B,A){this.handleAjaxMethod(B[A].content,false);},handler:function(C,A){var B=this.activeTab;if(B==C){return;}this.oldLi.removeClassName(this.cfg("style")+"-active");this.activeTab=C;if(this.cfg("method")=="div"){this.handleDivMethod(C,B);}else{if(this.cfg("method")=="ajax"){this.handleAjaxMethod(C,B);}}this.fireEvent("onSwitchEvent",{oldContent:B,newContent:C});A.addClassName(this.cfg("style")+"-active");this.oldLi=A;},handleDivMethod:function(B,A){$(B).show();$(A).hide();},handleAjaxMethod:function(C,B){var A;if(!this.cfg("ajaxReload")&&B){this.cache[B]=$(this.ajaxDiv).innerHTML;if(this.cache[C]){A=this.cache[C];}}if(!A){new Ajax.Request(C,{method:this.cfg("ajaxMethod"),onSuccess:function(D){$(this.ajaxDiv).innerHTML=D.responseText;}.bind(this)});}else{$(this.ajaxDiv).innerHTML=A;}},getActiveTab:function(){return this.activeTab;}});';jPlex.src["jplex/components/tooltip/Tooltip.js"]='jPlex.provide("jplex.components.Tooltip","jplex.common.Component",{_definition:{name:"Tooltip",defaultConfig:{source:null,content:"",position:"top-right",shadowWidth:1,trigger:"mouseover",positionRatio:0.83,zIndex:99},events:{onShowEvent:Prototype.emptyFunction,onHideEvent:Prototype.emptyFunction},defaultContainer:"div"},initialize:function($super,B,A){$super(B,A);this.render();if(this.cfg("trigger")==jplex.components.Tooltip.TRIGGER_MOUSEOVER){this._source.observe("mouseover",this.show.bindAsEventListener(this));this.component.observe("mouseover",this.show.bindAsEventListener(this));this._source.observe("mouseout",this.hide.bindAsEventListener(this));this.component.observe("mouseout",this.hide.bindAsEventListener(this));}else{if(this.cfg("trigger")==jplex.components.Tooltip.TRIGGER_CLICK){this._source.observe("click",this.show.bindAsEventListener(this));document.observe("click",function(D){var C=D.pointerX(),E=D.pointerY();if(!this._source.isWithin(C,E)&&!this.component.isWithin(C,E)){this.hide();}}.bindAsEventListener(this));}}},render:function(){if(this.cfg("source")){this._source=$(this.cfg("source"));}if(!this._source){this._source=$(this.component.id+"-source");}if(!this._source){this._source=$(document.body);}this.component.addClassName("jplex-tooltip").setStyle({zIndex:this.cfg("zIndex")+1});this._pin=new Element("div");this._body=new Element("div");this._shadow=new Element("div");this._body.addClassName("body");var A=this.cfg("position");this._pin.addClassName("bubble-pin");if("top-right"==A){this._pin.addClassName("bubble-pin-tr");}if("top-left"==A){this._pin.addClassName("bubble-pin-tl");}if("bottom-right"==A){this._pin.addClassName("bubble-pin-br");}if("bottom-left"==A){this._pin.addClassName("bubble-pin-bl");}this.component.appendChildren(this._body,this._pin);this._shadow.addClassName("jplex-tooltip-shadow").addClassName("jplex-tooltip");this._shadow.setOpacity(0.3);this._shadow.setStyle({padding:0,zIndex:this.cfg("zIndex")});document.body.appendChild(this._shadow);this._fixShadow();this._fixPin();this._source.addClassName("jplex-bubbler");this.setContent(this.cfg("content"));this.hide();},setContent:function(A){this._body.update(A);this._fixShadow();this._fixPin();},getBody:function(){return this._body;},getSource:function(){return this._source;},setPosition:function(B,A){this.component.setStyle({top:B+"px",left:A+"px"});this._fixShadow();this._fixPin();},show:function(){this.component.show();this._shadow.show();var D=this._source.cumulativeOffset();var A=this.cfg("position"),C=D.left,B=D.top;if("top-right"==A){B=B-this.component.getHeight()-15;C+=Math.floor(this._source.getWidth()*this.cfg("positionRatio"))-10;}else{if("top-left"==A){B=B-this.component.getHeight()-15;C=C-(5*this.component.getWidth())/6+this._source.getWidth()*(1-this.cfg("positionRatio"))-5;}else{if("bottom-left"==A){B=B+this._source.getHeight()+15;C=C-(5*this.component.getWidth())/6+this._source.getWidth()*(1-this.cfg("positionRatio"))-5;}else{if("bottom-right"==A){B=B+this._source.getHeight()+15;C+=Math.floor(this._source.getWidth()*this.cfg("positionRatio"))-10;}}}}this.setPosition(B,C);this._fixShadow();this.fireEvent("onShowEvent");},hide:function(){this.component.hide();this._shadow.hide();this.fireEvent("onHideEvent");},_fixShadow:function(){var A=this.component.cumulativeOffset();this._shadow.setStyle({width:(this.component.getWidth())+"px",height:(this.component.getHeight())+"px",top:(A.top+this.cfg("shadowWidth")-1)+"px",left:(A.left+this.cfg("shadowWidth")-1)+"px"});},_fixPin:function(){var D=this.cfg("position"),C=0,B=0,A=this.component.getWidth();if("top-right"==D){C=this.component.getHeight()-2;B=A;}else{if("top-left"==D){C=this.component.getHeight()-2;B=Math.floor(5*A/6);}else{if("bottom-right"==D){C=-20;B=A;}else{if("bottom-left"==D){C=-20;B=Math.floor(5*A/6);}}}}this._pin.setStyle({top:C+"px",width:B+"px"});}});jPlex.extend("jplex.components.Tooltip",{TRIGGER_MOUSEOVER:"mouseover",TRIGGER_CLICK:"click",TRIGGER_CUSTOM:"custom"});';jPlex.src["jplex/xprototype/_module.js"]="";jPlex.src["jplex/xprototype/Core.js"]='Ajax.Base.defaultMethod="post";Ajax.Base.prototype.initialize=Ajax.Base.prototype.initialize.wrap(function(B,A){if(!A.method){A.method=Ajax.Base.defaultMethod;}B(A);});Object.extend(Prototype.Browser,{IE6:Prototype.Browser.IE&&navigator.userAgent.indexOf("MSIE 6.0")!=-1,IE7:Prototype.Browser.IE&&navigator.userAgent.indexOf("MSIE 7.0")!=-1,IE8:Prototype.Browser.IE&&navigator.userAgent.indexOf("MSIE 8.0")!=-1,IElt8:Prototype.Browser.IE6||Prototype.Browser.IE7});var console;Logger={error:function(A){if(console&&console.error){console.error("[%s] %s",A.name,A.message);}},warning:function(A){if(console&&console.warning){console.warning(A);}},log:function(A){if(console&&console.log){console.log(A);}}};';jPlex.src["jplex/xprototype/Date.js"]='Object.extend(Date,{YEAR_OFFSET:Prototype.Browser.IE||Prototype.Browser.Opera?0:1900});Object.extend(Date.prototype,{locale:function(A){return Locale.current("Date",A);},getMonthLength:function(){return this.lastDayOfMonth().getDate();},isLeapYear:function(){var A=this.getYear()+Date.YEAR_OFFSET;return A%4==0&&(A%100!=0||A%400==0);},firstDayOfMonth:function(){return new Date(Date.YEAR_OFFSET+this.getYear(),this.getMonth(),1);},lastDayOfMonth:function(){return new Date(Date.YEAR_OFFSET+this.getYear(),this.getMonth()+1,0,0);},setNextDay:function(){this.setDate(this.getDate()+1);return this;},setPreviousDay:function(){this.setDate(this.getDate()-1);return this;},compareTo:function(A){return this.getTime()-A.getTime();},format:function(C){var E=this;var B=new String(C);B=B.gsub(/\\\\./,"");B=B.gsub(/[^dDjlNSwzWFmMntLoYyaABgGhHisueIOPTZ]/,"");var D=$A(B.toArray()).uniq();var A={};D.each(function(H,F){switch(H){case"d":A.d=E.getDate().toString().lpad(2,"0");break;case"D":A.D=Locale.get("Date","en").get("DAYS")[E.getDay()];break;case"j":A.j=E.getDate().toString();break;case"l":A.l=Locale.get("Date","en").get("DAYS_SHORT")[E.getDay()];break;case"N":A.N=E.getDay()==0?7:E.getDay()+1;break;case"S":var G=E.getDate();switch(G){case 1:A.S="st";break;case 2:A.S="nd";break;case 3:A.S="rd";break;default:A.S="th";break;}break;case"w":A.w=E.getDay();break;case"z":var I=new Date(E.getFullYear(),0,1);A.z=Math.round((E.getTime()-I.getTime())/86400000+0.5,0);break;case"W":var I=new Date(E.getFullYear(),0,1);A.z=Math.round((E.getTime()-I.getTime())/86400000+I.getDay()/7,0);break;case"F":A.F=Locale.get("Date","en").get("MONTHS")[E.getMonth()];break;case"m":A.m=(E.getMonth()+1).toString().lpad(2,"0");break;case"M":A.M=Locale.get("Date","en").get("MONTHS_SHORT")[E.getMonth()];break;case"n":A.n=(E.getMonth()+1).toString();break;case"t":A.t=E.getMonthLength();break;case"L":A.L=E.isLeapYear()?"1":"0";break;case"o":throw"Unsupported option (not yet implemented)";break;case"Y":A.Y=E.getFullYear();break;case"y":A.y=E.getFullYear().toString().substring(2);break;case"a":A.a=E.getHours()<13&&E.getHours()>0?"am":"pm";break;case"A":A.A=E.getHours()<13&&E.getHours()>0?"AM":"PM";break;case"B":throw"Unsupported option (not yet implemented)";break;case"g":A.g=((11+E.getHours())%12+1).toString();break;case"G":A.G=E.getHours().toString();break;case"h":A.h=((11+E.getHours())%12+1).toString().lpad(2,"0");break;case"H":A.H=E.getHours().toString().lpad(2,"0");break;case"i":A.i=E.getMinutes().toString().lpad(2,"0");break;case"s":A.s=E.getSeconds().toString().lpad(2,"0");break;case"u":throw"Unsupported option (not yet implemented)";break;case"e":var H=E.toString();A.e=/GMT[+\\-0-9]+/.exec(H);break;case"I":case"0":case"P":case"T":case"Z":default:throw"Unsupported option (not yet implemented)";break;}});D.each(function(F){C=C.gsub(F,"##"+F+"##");});D.each(function(G,F){C=C.gsub("##"+G+"##",A[G]);});return C;}});';jPlex.src["jplex/xprototype/Element.js"]='Element.addMethods({appendChildren:function(A){$A(arguments).each(function(B){if(B==this){return;}if(Object.isArray(B)){$A(B).each(function(C){this.appendChild(C);}.bind(this));}else{this.appendChild(B);}}.bind(A));return A;},removeChildren:function(A){while(A.childNodes.length>0){A.removeChild(A.childNodes[0]);}return A;},isWithin:function(B,A,E){var C=B.cumulativeOffset();C=[A-C[0],E-C[1]];var D=B.getDimensions();return C[0]<D.width&&C[0]>=0&&C[1]<D.height&&C[1]>=0;},bindKey:function(E,D,F,C){E=$(E);if(!C){C={};}if(!E._keyHandlers){E._keyHandlers=$A([]);}var A={ctrl:false,shift:false,alt:false,preventDefault:false};C=Object.extend(A,C);var B=D;if(C){if(C.ctrl){B+="-ctrl";}if(C.alt){B+="-alt";}if(C.shift){B+="-shift";}}if(E._keyHandlers[B]){throw {name:"KeyEventOverride",message:"Key code \'"+D+"\' is already bound with modifiers "+Object.toJSON(C)};}E._keyHandlers[B]=function(G){F();return C.preventDefault;};if(E._keyEvents){E.stopObserving("keydown",E._keyEvents);}E._keyEvents=function(J,I){J=Event.extend(window.event?event:J);var G=J.keyCode;if(J.ctrlKey){G+="-ctrl";}if(J.altKey){G+="-alt";}if(J.shiftKey){G+="-shift";}if(E._keyHandlers[G]){var H=E._keyHandlers[G](J);if(H){J.stop();}}}.bindAsEventListener(E,F);E.observe("keydown",E._keyEvents);return E;},unbindKey:function(D,C,B){D=$(D);var A=C;if(B){if(B.ctrl){A+="-ctrl";}if(B.alt){A+="-alt";}if(B.shift){A+="-shift";}}D._keyHandlers[A]=null;return D;},IEFixCombobox:function(A){if(Prototype.Browser.IE6){A=$(A);var C=A.getStyle("z-index")||0;var B=new Element("iframe");B.setStyle({position:"absolute",top:"0px",left:"0px",width:"100%",zIndex:C-1}).setOpacity(0);A.appendChild(B);}}});Object.extend(document,{bindKey:Element.Methods.bindKey.methodize(),unbindKey:Element.Methods.unbindKey.methodize()});if(Prototype.Browser.IElt8){Element.addMethods({getOffsetParent:Element.Methods.getOffsetParent.wrap(function(B,A){var C=B(A);if(C.tagName.toLowerCase()=="html"){C=$(document.body);}return C;})});}';jPlex.src["jplex/xprototype/Event.js"]="Object.extend(Event,{Key:{BACKSPACE:8,TAB:9,ENTER:13,SPACE:32,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESCAPE:27,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT_ARROW:37,UP_ARROW:38,RIGHT_ARROW:39,DOWN_ARROW:40,INSERT:45,DELETE:46,K_0:48,K_1:49,K_2:50,K_3:51,K_4:52,K_5:53,K_6:54,K_7:55,K_8:56,K_9:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,LEFT_WINDOW:91,RIGHT_WINDOW:92,SELECT:93,NUMPAD_0:96,NUMPAD_1:97,NUMPAD_2:98,NUMPAD_3:99,NUMPAD_4:100,NUMPAD_5:101,NUMPAD_6:102,NUMPAD_7:103,NUMPAD_8:104,NUMPAD_9:105,NUMPAD_MULTIPLY:106,NUMPAD_ADD:107,NUMPAD_SUBTRACT:109,NUMPAD_POINT:110,NUMPAD_DIVIDE:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUM_LOCK:144,SCROLL_LOCK:145,SEMI_COLON:186,EQUAL_SIGN:187,COMMA:188,DASH:189,PERIOD:190,SLASH:191,GRAVE_ACCENT:192,OPEN_BRACKET:219,BACKSLASH:220,CLOSE_BRACKET:221,SINGLE_QUOTE:222},onElementReady:function(A,B){Event._readyStack.push({element:A,handler:B,tries:Event._ready_POLL_LIMIT});if(!Event._readyObserver){Event._readyObserver=new PeriodicalExecuter(Event._readyObserverHandler,Event._ready_POLL_INTERVAL);}},_ready_POLL_LIMIT:800,_ready_POLL_INTERVAL:0.05,_readyStack:$A(),_readyObserver:null,_readyObserverHandler:function(){Event._readyStack.each(function(C,B){if(!C){return;}var A=$(C.element);if(A){C.handler.bind(A)();Event._readyStack[B]=null;}else{C.tries--;if(C.tries==0){Event._readyStack[B]=null;}}});Event._readyStack=Event._readyStack.compact();if(Event._readyStack.length==0){Event._readyObserver.stop();delete Event._readyObserver;}}});";jPlex.src["jplex/xprototype/Object.js"]='Object.extendRecursive=function(A,C){for(var B in C){if(typeof(C[B])=="object"&&typeof(A[B])=="object"){A[B]=Object.extendRecursive(A[B],C[B]);}else{A[B]=C[B];}}return A;};';jPlex.src["jplex/xprototype/String.js"]='Object.extend(String.prototype,{lpad:function(A,C){var B=this;if(!A||A<=B.length){return this;}if(!C){C=" ";}while(B.length<A){B=C+""+B;}return B;},rpad:function(A,C){var B=this;if(!A||A<=B.length){return this;}if(!C){C=" ";}while(B.length<A){B+=C+"";}return B;}});';jPlex.src["jplex/xprototype/Xml.js"]="";jPlex.src['scrambles/AbstractScramble.js']="jPlex.provide(\"scrambles.AbstractScramble\",{initialize:function(){},colorList:new Array(\"y\",\"yellow\",\"yellow\",\"b\",\"blue\",\"blue\",\"r\",\"red\",\"red\",\"w\",\"white\",\"white\",\"g\",\"green\",\"green\",\"o\",\"#ffA040\",\"orange\",\"p\",\"purple\",\"purple\",\"0\",\"gray\",\"grey\"),setColor:function(A){this.colors=$A();for(var B=0;B<6;B++){this.colors[B]=this.colorList.length-3;for(var C=0;C<this.colorList.length;C+=3){if(A.charAt(B)==this.colorList[C]){this.colors[B]=C;break;}}}},scramble:function(){},scramblestring:function(){},imagestring:function(){},description:function(){}});";jPlex.src['scrambles/Clock.js']="jPlex.provide(\"scrambles.Clock\",\"scrambles.AbstractScramble\",{initialize:function(D,E,A,C){var B=new Array();B[0]=new Array(1,1,1,1,1,1,0,0,0,-1,0,-1,0,0,0,0,0,0);B[1]=new Array(0,1,1,0,1,1,0,1,1,-1,0,0,0,0,0,-1,0,0);B[2]=new Array(0,0,0,1,1,1,1,1,1,0,0,0,0,0,0,-1,0,-1);B[3]=new Array(1,1,0,1,1,0,1,1,0,0,0,-1,0,0,0,0,0,-1);B[4]=new Array(0,0,0,0,0,0,1,0,1,0,0,0,-1,-1,-1,-1,-1,-1);B[5]=new Array(1,0,0,0,0,0,1,0,0,0,-1,-1,0,-1,-1,0,-1,-1);B[6]=new Array(1,0,1,0,0,0,0,0,0,-1,-1,-1,-1,-1,-1,0,0,0);B[7]=new Array(0,0,1,0,0,0,0,0,1,-1,-1,0,-1,-1,0,-1,-1,0);B[8]=new Array(0,1,1,1,1,1,1,1,1,-1,0,0,0,0,0,-1,0,-1);B[9]=new Array(1,1,0,1,1,1,1,1,1,0,0,-1,0,0,0,-1,0,-1);B[10]=new Array(1,1,1,1,1,1,1,1,0,-1,0,-1,0,0,0,0,0,-1);B[11]=new Array(1,1,1,1,1,1,0,1,1,-1,0,-1,0,0,0,-1,0,0);B[12]=new Array(1,1,1,1,1,1,1,1,1,-1,0,-1,0,0,0,-1,0,-1);B[13]=new Array(1,0,1,0,0,0,1,0,1,-1,-1,-1,-1,-1,-1,-1,-1,-1);this.moves=B;},scramble:function(){var D=new Array(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);var A=new Array();var C,B;for(C=0;C<14;C++){A[C]=Math.floor(Math.random()*12)-5;}for(C=0;C<14;C++){for(B=0;B<18;B++){D[B]+=A[C]*this.moves[C][B];}}for(B=0;B<18;B++){D[B]%=12;while(D[B]<=0){D[B]+=12;}}this.seq=A;this.posit=D;},scramblestring:function(){var A=this.seq;var B=\"<table><tr valign='top'><td width='50'>&nbsp;</td><td><pre>\";B+=(\"UU  u=\"+A[0]+\"\\n\");B+=(\"dd  d=\"+A[4]+\"\\n\");B+=(\"\"+\"\\n\");B+=(\"dU  u=\"+A[1]+\"\\n\");B+=(\"dU  d=\"+A[5]+\"\\n\");B+=(\"\"+\"\\n\");B+=(\"dd  u=\"+A[2]+\"\\n\");B+=(\"UU  d=\"+A[6]+\"\\n\");B+=(\"\"+\"\\n\");B+=(\"Ud  u=\"+A[3]+\"\\n\");B+=(\"Ud  d=\"+A[7]+\"\\n\");B+=(\"</pre></td><td width='100'>&nbsp;</td><td><pre>\");B+=(\"dU  u=\"+A[8]+\"\\n\");B+=(\"UU\"+\"\\n\");B+=(\"\"+\"\\n\");B+=(\"Ud  u=\"+A[9]+\"\\n\");B+=(\"UU\"+\"\\n\");B+=(\"\"+\"\\n\");B+=(\"UU  u=\"+A[10]+\"\\n\");B+=(\"Ud\"+\"\\n\");B+=(\"\"+\"\\n\");B+=(\"UU  u=\"+A[11]+\"\\n\");B+=(\"dU\"+\"\\n\");B+=(\"</pre></td><td width='100'>&nbsp;</td><td><pre>\");B+=(\"UU  u=\"+A[12]+\"\\n\");B+=(\"UU\"+\"\\n\");B+=(\"\"+\"\\n\");B+=(\"dd  d=\"+A[13]+\"\\n\");B+=(\"dd\"+\"\\n\");B+=(\"\"+\"\\n\");B+=this.prtrndpin()+this.prtrndpin()+\"\\n\";B+=this.prtrndpin()+this.prtrndpin()+\"\\n\";B+=\"</pre></td></tr></table>\";return B;},imagestring:function(){posit=this.posit;s=(\"Front:\\n\");for(i=0;i<9;i++){s+=this.prt(posit[i]);if((i%3)==2){s+=(\"\\n\");}}s+=(\"Back:\\n\");for(i=0;i<9;i++){s+=this.prt(posit[i+9]);if((i%3)==2){s+=(\"\\n\");}}return\"<h1><pre>\"+s+\"</pre></h1>\";},prtrndpin:function(){return Math.floor(Math.random()*2)==0?\"U\":\"d\";},prt:function(B){var A=\"\";if(B<10){A+=(\" \");}A+=(B+\" \");return A;},description:function(){return\"Algorithm: Uniform Random-State Scramble with Random Pins. Author: Jaap Scherphuis\";}});";jPlex.src['scrambles/Cube.js']="jPlex.provide(\"scrambles.Cube\",\"scrambles.AbstractScramble\",{initialize:function(F,G,A,B){if(!B){B=\"yobwrg\";}this.size=F;this.mult=G;this.seqlen=A;var E;var D=new Array(12*F*F);for(E=0;E<D.length;E++){D[E]=-1;}for(E=0;E<F;E++){for(j=0;j<F;j++){D[4*F*(3*F-E-1)+F+j]=E*F+j;D[4*F*(F+E)+F-j-1]=(F+E)*F+j;D[4*F*(F+E)+4*F-j-1]=(2*F+E)*F+j;D[4*F*(E)+F+j]=(3*F+E)*F+j;D[4*F*(F+E)+2*F+j]=(4*F+E)*F+j;D[4*F*(F+E)+F+j]=(5*F+E)*F+j;}}this.flat2posit=D;var C=new Array();C[0]=new Array(0,1,2,3,4,5);C[1]=new Array(0,2,4,3,5,1);C[2]=new Array(0,4,5,3,1,2);C[3]=new Array(0,5,1,3,2,4);C[4]=new Array(1,0,5,4,3,2);C[5]=new Array(1,2,0,4,5,3);C[6]=new Array(1,3,2,4,0,5);C[7]=new Array(1,5,3,4,2,0);C[8]=new Array(2,0,1,5,3,4);C[9]=new Array(2,1,3,5,4,0);C[10]=new Array(2,3,4,5,0,1);C[11]=new Array(2,4,0,5,1,3);C[12]=new Array(3,1,5,0,4,2);C[13]=new Array(3,2,1,0,5,4);C[14]=new Array(3,4,2,0,1,5);C[15]=new Array(3,5,4,0,2,1);C[16]=new Array(4,0,2,1,3,5);C[17]=new Array(4,2,3,1,5,0);C[18]=new Array(4,3,5,1,0,2);C[19]=new Array(4,5,0,1,2,3);C[20]=new Array(5,0,4,2,3,1);C[21]=new Array(5,1,0,2,4,3);C[22]=new Array(5,3,1,2,0,4);C[23]=new Array(5,4,3,2,1,0);this.colorPerm=C;this.setColor(B);},scramble:function(){var I=this.size;if(this.mult||(this.size&1)!=0){I--;}var C=new Array(I);var E=new Array(0,0,0);var D;D=-1;seq=new Array();for(var G=0;G<I;G++){C[G]=0;}E[0]=E[1]=E[2]=0;var H=0;while(seq.length+H<this.seqlen){var A,F,B;do{do{A=Math.floor(Math.random()*3);F=Math.floor(Math.random()*I);B=Math.floor(Math.random()*3);}while(A==D&&C[F]!=0);}while(A==D&&!this.mult&&I==this.size&&(2*E[0]==I||2*E[1]==I||2*E[2]==I||(2*(E[B]+1)==I&&E[0]+E[1]+E[2]-E[B]>0)));if(A!=D){this.appendmoves(seq,C,I,D);for(var G=0;G<I;G++){C[G]=0;}E[0]=E[1]=E[2]=0;H=0;D=A;}E[B]++;H++;C[F]=B+1;}this.appendmoves(seq,C,I,D);seq[seq.length]=0;this.seq=seq;},scramblestring:function(){var D=\"\",B;for(var C=0;C<this.seq.length-1;C++){if(C!=0){D+=\" \";}var A=this.seq[C]>>2;B=A%6;A=(A-B)/6;if(A&&this.size<=5&&!this.mult){D+=\"dlburf\".charAt(B);}else{if(this.size<=5&&this.mult){D+=\"DLBURF\".charAt(B);if(A){D+=\"w\";}}else{if(A){D+=(A+1);}D+=\"DLBURF\".charAt(B);}}B=this.seq[C]&3;if(B!=0){D+=\" 2'\".charAt(B);}}return D;},appendmoves:function(E,H,D,G){for(var C=0;C<D;C++){if(H[C]){var F=H[C]-1;var B=G;var A=C;if(C+C+1>=D){B+=3;A=D-1-A;F=2-F;}E[E.length]=(A*6+B)*4+F;}}},doslice:function(I,J,A){var N=this.size;var L=this.posit;var G,E,C,B;var M=N*N;var K,H,F,D;if(I>5){I-=6;}for(D=0;D<A;D++){for(H=0;H<N;H++){if(I==0){G=6*M-N*J-N+H;E=2*M-N*J-1-H;C=3*M-N*J-1-H;B=5*M-N*J-N+H;}else{if(I==1){G=3*M+J+N*H;E=3*M+J-N*(H+1);C=M+J-N*(H+1);B=5*M+J+N*H;}else{if(I==2){G=3*M+J*N+H;E=4*M+N-1-J+N*H;C=J*N+N-1-H;B=2*M-1-J-N*H;}else{if(I==3){G=4*M+J*N+N-1-H;E=2*M+J*N+H;C=M+J*N+H;B=5*M+J*N+N-1-H;}else{if(I==4){G=6*M-1-J-N*H;E=N-1-J+N*H;C=2*M+N-1-J+N*H;B=4*M-1-J-N*H;}else{if(I==5){G=4*M-N-J*N+H;E=2*M-N+J-N*H;C=M-1-J*N-H;B=4*M+J+N*H;}}}}}}K=L[G];L[G]=L[E];L[E]=L[C];L[C]=L[B];L[B]=K;}if(J==0){for(H=0;H+H<N;H++){for(F=0;F+F<N-1;F++){G=I*M+H+F*N;C=I*M+(N-1-H)+(N-1-F)*N;if(I<3){E=I*M+(N-1-F)+H*N;B=I*M+F+(N-1-H)*N;}else{B=I*M+(N-1-F)+H*N;E=I*M+F+(N-1-H)*N;}K=L[G];L[G]=L[E];L[E]=L[C];L[C]=L[B];L[B]=K;}}}}},imagestring:function(){var I=this.size;var G=this.seq;var H=\"\",B,C,D=0,A;this.posit=$A();for(B=0;B<6;B++){for(C=0;C<I*I;C++){this.posit[D++]=B;}}for(B=0;B<G.length-1;B++){A=G[B]&3;C=G[B]>>2;D=0;while(C>5){C-=6;D++;}do{this.doslice(C,D,A+1);D--;}while(this.mult&&D>=0);}var F=G[G.length-1];D=0;H=\"<table border=0 cellpadding=0 cellspacing=0>\";for(B=0;B<3*I;B++){H+=\"<tr>\";for(C=0;C<4*I;C++){if(this.flat2posit[D]<0){H+=\"<td></td>\";}else{var E=this.colorPerm[F][this.posit[this.flat2posit[D]]];H+=\"<td bgcolor=\"+this.colorList[this.colors[E]+1]+\">\"+\"<div style='width:10px; height:10px; border: 1px solid black;'>&nbsp;</div></td>\";}D++;}H+=\"</tr>\";}H+=\"</table>\";return(H);},description:function(){s=\"Algorithm: Random Moves Generator. Parameters: size (\"+this.size+\"), length (\"+this.seqlen+\"). \";s+=\"Author: Jaap Scherphuis. \";if(this.size==3){s+=\"<br/><span style='color:red;'>Warning: \"+\"Official regulations stipulates that a 3x3x3 cube must be generated from a random \"+\"position and then solved by Cube Explorer (Kociemba).</span>\";}return s;}});";jPlex.src['scrambles/Megaminx.js']="jPlex.provide(\"scrambles.Megaminx\",\"scrambles.AbstractScramble\",{initialize:function(B,A){this.linelen=B;this.linenbr=A;},scramble:function(){this.seq=new Array();for(i=0;i<this.linenbr*this.linelen;i++){this.seq[i]=Math.floor(Math.random()*2);}},scramblestring:function(){seq=this.seq;linelen=this.linelen;linenbr=this.linenbr;var C=\"<br>&nbsp;&nbsp;\",B,A;for(A=0;A<linenbr;A++){for(B=0;B<linelen;B++){if(B%2){if(seq[A*linelen+B]){C+=\"D++ \";}else{C+=\"D-- \";}}else{if(seq[A*linelen+B]){C+=\"R++ \";}else{C+=\"R-- \";}}}if(seq[(A+1)*linelen-1]){C+=\"U<br>&nbsp;&nbsp;\";}else{C+=\"U'<br>&nbsp;&nbsp;\";}}return C;},description:function(){s=\"Algorithm: Random Moves Generator. Parameters: line length (\"+this.linelen+\"), lines (\"+this.linenbr+\"). \";s+=\"Author: Cl&eacute;ment Gallet, based on earlier work by Jaap Scherphuis. Idea by Stefan Pochmann. \";return s;}});";jPlex.src['scrambles/Pocket.js']="jPlex.provide(\"scrambles.Pocket\",\"scrambles.Cube\",{initialize:function($super){$super(2,false,0);var A=new Array();A[0]=new Array();A[1]=new Array();A[2]=new Array();A[3]=new Array();A[4]=new Array();A[5]=new Array();this.adj=A;mov2fc=new Array();mov2fc[0]=new Array(0,2,3,1,23,19,10,6,22,18,11,7);mov2fc[1]=new Array(4,6,7,5,12,20,2,10,14,22,0,8);mov2fc[2]=new Array(8,10,11,9,12,7,1,17,13,5,0,19);mov2fc[3]=new Array(12,13,15,14,8,17,21,4,9,16,20,5);mov2fc[4]=new Array(16,17,19,18,15,9,1,23,13,11,3,21);mov2fc[5]=new Array(20,21,23,22,14,16,3,6,15,18,2,4);this.mov2fc=mov2fc;this.sol=new Array();this.calcperm();},scramble:function(){this.posit=new Array(1,1,1,1,2,2,2,2,5,5,5,5,4,4,4,4,3,3,3,3,0,0,0,0);for(var A=0;A<500;A++){var B=Math.floor(Math.random()*3+3)+16*Math.floor(Math.random()*3);this.domove(B);}this.solve();this.seq=$A(this.sol).reverse();this.seq[this.seq.length]=0;},solved:function(){for(var B=0;B<24;B+=4){c=this.posit[B];for(var A=1;A<4;A++){if(this.posit[B+A]!=c){return(false);}}}return(true);},piece:new Array(15,16,16,21,21,15,13,9,9,17,17,13,14,20,20,4,4,14,12,5,5,8,8,12,3,23,23,18,18,3,1,19,19,11,11,1,2,6,6,22,22,2,0,10,10,7,7,0),calcadj:function(){var E=this.posit;var C=this.adj;var D=this.piece;var B,A;for(B=0;B<6;B++){for(A=0;A<6;A++){C[B][A]=0;}}for(B=0;B<48;B+=2){if(E[D[B]]<=5&&E[D[B+1]]<=5){C[E[D[B]]][E[D[B+1]]]++;}}},calctot:function(){this.tot=new Array(0,0,0,0,0,0,0);for(var A=0;A<24;A++){this.tot[this.posit[A]]++;}},domove:function(E){posit=this.posit;mov2fc=this.mov2fc;var C=1+(E>>4);var B=E&15;while(C){for(var A=0;A<mov2fc[B].length;A+=4){var D=posit[mov2fc[B][A]];posit[mov2fc[B][A]]=posit[mov2fc[B][A+3]];posit[mov2fc[B][A+3]]=posit[mov2fc[B][A+2]];posit[mov2fc[B][A+2]]=posit[mov2fc[B][A+1]];posit[mov2fc[B][A+1]]=D;}C--;}},solve:function(){this.calcadj();adj=this.adj;posit=this.posit;piece=this.piece;var E=new Array();for(I=0;I<6;I++){for(H=0;H<6;H++){if(I!=H&&adj[I][H]+adj[H][I]==0){E[I]=H;E[H]=I;}}}var A=new Array();var J=new Array();var I=0;for(var F=0;F<7;F++){var C=0;for(H=I;H<I+6;H+=2){if(posit[piece[H]]==posit[piece[42]]){C+=4;}if(posit[piece[H]]==posit[piece[44]]){C+=1;}if(posit[piece[H]]==posit[piece[46]]){C+=2;}}A[F]=C;if(posit[piece[I]]==posit[piece[42]]||posit[piece[I]]==E[posit[piece[42]]]){J[F]=0;}else{if(posit[piece[I+2]]==posit[piece[42]]||posit[piece[I+2]]==E[posit[piece[42]]]){J[F]=1;}else{J[F]=2;}}I+=6;}var B=0;for(var I=0;I<7;I++){var H=0;for(var G=0;G<7;G++){if(A[G]==I){break;}if(A[G]>I){H++;}}B=B*(7-I)+H;}var K=0;for(var I=5;I>=0;I--){K=K*3+J[I]-3*Math.floor(J[I]/3);}if(B!=0||K!=0){this.sol.length=0;this.other=$A();for(var D=this.seqlen;D<100;D++){if(this.search(0,B,K,D,-1)){break;}}}},search:function(E,A,H,D,F){if(D==0){if(A==0&&H==0){return(true);}}else{if(this.perm[A]>D||this.twst[H]>D){return(false);}var B,I,G,C;for(C=0;C<3;C++){if(C!=F){B=A;I=H;for(G=0;G<3;G++){B=this.permmv[B][C];I=this.twstmv[I][C];this.sol[E]=4*(C+3)+(2-G);if(this.search(E+1,B,I,D-1,C)){return(true);}}}}}return(false);},calcperm:function(){var F=new Array();var I=new Array();var H=new Array();var G=new Array();for(var B=0;B<5040;B++){F[B]=-1;H[B]=new Array();for(var D=0;D<3;D++){H[B][D]=this.getprmmv(B,D);}}F[0]=0;for(var E=0;E<=6;E++){var C=0;for(var B=0;B<5040;B++){if(F[B]==E){for(var D=0;D<3;D++){var A=B;for(var J=0;J<3;J++){var A=H[A][D];if(F[A]==-1){F[A]=E+1;C++;}}}}}}for(var B=0;B<729;B++){I[B]=-1;G[B]=new Array();for(var D=0;D<3;D++){G[B][D]=this.gettwsmv(B,D);}}I[0]=0;for(var E=0;E<=5;E++){var C=0;for(var B=0;B<729;B++){if(I[B]==E){for(var D=0;D<3;D++){var A=B;for(var J=0;J<3;J++){var A=G[A][D];if(I[A]==-1){I[A]=E+1;C++;}}}}}}this.perm=F;this.twst=I;this.permmv=H;this.twstmv=G;},getprmmv:function(E,B){var C,A,G,D;var F=new Array();D=E;for(C=1;C<=7;C++){A=D%C;D=(D-A)/C;for(G=C-1;G>=A;G--){F[G+1]=F[G];}F[A]=7-C;}if(B==0){G=F[0];F[0]=F[1];F[1]=F[3];F[3]=F[2];F[2]=G;}else{if(B==1){G=F[0];F[0]=F[4];F[4]=F[5];F[5]=F[1];F[1]=G;}else{if(B==2){G=F[0];F[0]=F[2];F[2]=F[6];F[6]=F[4];F[4]=G;}}}D=0;for(C=0;C<7;C++){A=0;for(G=0;G<7;G++){if(F[G]==C){break;}if(F[G]>C){A++;}}D=D*(7-C)+A;}return(D);},gettwsmv:function(E,B){var C,A,H,G,D;var F=new Array();D=E;G=0;for(C=0;C<=5;C++){H=Math.floor(D/3);A=D-3*H;D=H;F[C]=A;G-=A;if(G<0){G+=3;}}F[6]=G;if(B==0){H=F[0];F[0]=F[1];F[1]=F[3];F[3]=F[2];F[2]=H;}else{if(B==1){H=F[0];F[0]=F[4];F[4]=F[5];F[5]=F[1];F[1]=H;F[0]+=2;F[1]++;F[5]+=2;F[4]++;}else{if(B==2){H=F[0];F[0]=F[2];F[2]=F[6];F[6]=F[4];F[4]=H;F[2]+=2;F[0]++;F[4]+=2;F[6]++;}}}D=0;for(C=5;C>=0;C--){D=D*3+(F[C]%3);}return(D);},description:function(){s=\"Algorithm: Uniform Random-State Scramble. \";s+=\"Author: Tom van der Zanden, based on previous work by Jaap Scherphuis. \";return s;}});";jPlex.src['scrambles/Pyraminx.js']="jPlex.provide(\"scrambles.Pyraminx\",\"scrambles.AbstractScramble\",{initialize:function(A){if(!A){A=\"gryb\";}this.layout=new Array(1,2,1,2,1,0,2,0,1,2,1,2,1,0,1,2,1,0,2,1,2,0,1,2,1,0,0,0,1,0,2,1,2,1,2,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,1,2,1,0,0,0,0,0,0,0,0,0,1,2,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0);this.setColor(A);},scramble:function(){var F,E,B,G,H;this.seq=new Array();this.colmap=new Array(1,1,1,1,1,0,2,0,3,3,3,3,3,0,1,1,1,0,2,2,2,0,3,3,3,0,0,0,1,0,2,2,2,2,2,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,0,0,0,0,0,0,0,0,0,4,4,4,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0);F=0;var D=[[],[3,2,1,2,3,1,1,2,0,1,1,2,0,2],[3,2,1,2,0,2,1,1,0,2,3,1,0,2],[0,1,2,2,0,2,2,1,0,2,1,1,0,1,1,2],[1,1,0,2,3,2,0,1,3,1,1,2],[1,2,3,1,1,1,3,2],[0,2,3,2,1,1,0,2,3,1,0,2,1,2],[0,1,3,2,2,2,0,2,3,2,2,1,3,2],[1,1,0,1,1,2,0,2],[1,2,3,2,1,1,3,1],[0,2,3,2,1,1,0,2,3,1,1,2,0,2],[1,2,3,2,0,2,1,1,0,2,3,1,0,2],[3,1,1,2,3,2,1,1],[3,1,1,1,0,1,1,2,0,2,3,2],[0,1,3,2,0,1,1,2,3,1,0,1,1,1],[1,2,0,2,3,2,1,1,0,2,3,1,0,2],[0,1,1,1,0,2,1,2],[1,1,0,2,3,1,0,1,3,2,1,2],[3,2,0,2,1,1,0,2,3,1,0,2,1,2],[3,1,2,2,0,1,3,2,2,1,0,2],[0,1,3,1,0,1,1,1,3,2,0,1,1,2],[0,2,1,1,3,1,0,1,3,2,1,2],[3,1,1,1,0,2,3,2,1,2,0,1],[3,2,0,1,1,2,3,2,1,1,3,2,0,2],[0,2,1,1,3,2,0,1,3,1,1,2],[3,1,1,2,0,2,1,2,0,1,3,2,1,2],[2,2,1,1,0,2,2,1,0,1,1,2],[0,1,1,2,3,1,1,1,0,2,3,2],[0,2,1,1,0,2,1,2,0,2],[3,2,1,2,0,2,1,2,0,1,3,1,1,2],[0,1,1,1,3,2,1,1,3,1,1,1,0,2],[1,2,0,1,3,1,0,2,3,2,1,1],[1,2,0,2,1,2,0,1,1,2],[0,2,3,1,1,1,0,1,3,2,1,2],[0,1,3,2,1,2,3,1,1,1,0,2],[0,1,1,2,3,1,0,2,3,2,1,1],[0,2,1,1,0,1,1,2],[1,1,0,2,3,1,0,2,3,2,0,2,1,2],[0,1,3,2,1,2,3,1,1,2,0,2,1,2],[0,1,1,2,3,1,0,1,3,2,0,1,1,1],[0,1,1,1,3,2,0,1,3,1,0,1,1,2],[0,1,1,2,3,2,1,1,0,2,3,1],[1,1,3,1,0,2,1,2,0,1,3,2],[2,1,1,1,0,2,2,2,0,1,1,2],[0,1,3,2,0,2,3,1],[0,1,2,2,0,1,1,1,2,1,0,1,1,2],[3,2,0,1,1,1,3,1,1,2,0,2],[0,2,1,2,3,1,1,2,0,1,3,2,1,2],[1,1,0,1,3,2,1,2,0,2,3,1],[0,1,3,2,1,1,0,1,3,1,0,1,1,2],[1,2,3,1,0,2,1,2,3,2,0,1,1,2],[1,2,3,2,0,1,1,1,3,1,0,2],[0,1,3,2,0,2,1,2,3,1,1,1],[3,1,1,1,0,1,3,1,1,2,3,1,0,2],[3,1,0,2,1,2,0,1,3,2,1,1],[1,1,3,1,1,1,0,2,3,2,1,1,0,1],[0,1,1,1,3,2,0,2,3,1,1,2],[3,1,1,1,3,1,0,1,1,2,3,1,0,2],[3,2,0,1,1,1,3,1,0,2,1,2],[3,1,0,2,1,2,3,2,0,1,1,1],[0,1,1,1,0,1,1,2,0,1],[3,1,0,1,1,2,3,2,1,1,0,2],[1,1,3,2,0,2,1,2,3,1,0,1],[1,2,0,1,3,2,1,1,3,1,0,2],[3,1,0,1,3,2,0,2],[1,2,3,1,1,2,0,1,3,2,1,2,0,2],[0,1,3,2,1,1,3,1,1,2,0,2],[0,1,1,1,3,1,0,2,1,1,3,2,1,1],[1,1,3,2,0,1,3,1,1,2,0,2],[1,2,3,1,0,1,1,1,3,2,0,2],[0,2,3,2,0,2,1,1,3,1,0,2,1,2],[1,1,0,1,1,1,3,1,1,1,0,2,3,2],[1,2,3,1,0,1,3,2,1,2,0,2,1,2],[3,1,1,1,0,1,3,2,1,2,0,2],[3,2,0,2,1,2,3,1,0,1,1,1],[1,2,0,2,3,2,0,2,1,1,3,1,0,2],[3,1,0,1,1,1,3,2,0,2,1,2],[1,1,3,1,0,1,3,2,1,2,0,2],[0,1,3,2,1,1,3,1,0,2,1,2],[1,2,3,2,0,2,1,2,3,1,0,1,1,2],[1,1,0,2,1,1,0,1,1,1],[1,2,0,2,3,1,0,2,3,2,1,1,0,2],[0,1,3,1,1,1,0,1,3,2,0,1,1,2],[0,1,1,2,3,2,1,1,3,1,0,2],[0,2,1,2,0,1,1,1],[3,2,0,2,1,2,3,1,1,2,0,1,1,2],[0,1,3,1,0,2,3,2],[0,1,3,1,1,1,0,2,1,1,3,2,1,1],[0,1,3,2,1,1,0,1,3,1,1,2,0,1],[0,2,1,2,3,1,0,1,1,1,3,2],[1,1,3,2,0,1,1,2,3,1,0,2],[0,1,3,2,1,2,3,2,1,1,0,2,3,2],[0,2,1,2,0,1,1,2,0,1,1,2,0,2],[0,2,1,2,3,1,0,1,3,2,1,1],[1,1,0,1,3,2,1,2,3,1,0,2],[1,2,3,2,1,1,0,1,3,1,0,2],[0,2,1,2,0,2,1,2,0,2,1,2],[0,2,1,2,3,2,0,1,1,1,3,1],[0,1,3,1,1,1,0,2,3,2,1,2],[1,2,0,2,3,2,1,2,3,1,0,1,1,2],[1,1,0,2,1,2,0,1],[0,2,1,1,3,1,0,2,3,2,0,2,1,2],[1,1,0,1,3,1,0,1,3,2,0,1,1,2],[0,2,1,2,3,2,1,2,3,1,0,1,1,2],[1,2,0,2,1,1,0,1],[3,1,1,1,0,2,1,1,3,2,1,1,0,1],[3,2,1,1,0,1,3,1,0,2,1,2],[2,1,1,2,3,1,2,2,1,1,3,2],[3,1,1,2,0,2,3,2,1,1,0,1],[1,2,3,1,0,2,1,1,0,1,3,2],[3,2,1,1,0,1,3,1,1,2,0,2],[0,2,3,2,1,2,3,2,0,1,1,1,3,2],[1,1,0,1,1,1,0,1,1,1,0,1],[1,2,3,2,0,2,1,1,3,1,0,1],[1,1,0,1,3,1,1,2,0,2,3,2],[3,2,1,2,0,1,1,2,3,1,0,2,1,2],[3,1,1,2,3,2,0,2,1,1,0,1],[1,2,3,1,0,2,3,2,1,1,0,1],[0,2,3,2,1,2,3,1,0,1,1,1],[3,2,1,1,3,2,0,1,3,2,1,2,0,2]];var I=[[],[1,1,3,2,1,2,3,2,1,1,3,2,1,2],[1,1,3,1,1,2,3,1,1,1,3,1,1,2],[3,1,0,1,3,2,1,1,3,2,1,2,3,1,0,2],[1,2,3,1,0,2,3,1,0,1,3,2,1,1,3,2],[0,1,3,2,1,1,3,2,1,2,3,1,0,2,3,1],[0,1,3,1,1,1,3,2,1,2,0,2],[1,2,0,2,3,2,0,1,3,1,1,1],[2,2,1,2,3,2,1,1,3,1,2,1],[0,1,1,1,3,1,1,2,3,2,0,2],[1,2,3,2,0,2,3,1,0,1,1,1],[2,2,3,2,1,2,3,1,1,1,2,1],[1,1,0,2,3,1,0,1,3,2,0,1,1,2,0,2],[3,2,1,1,3,2,1,2,3,1,0,2,3,1,0,1],[0,2,1,1,3,2,1,2,3,1,1,2,0,1,1,1],[3,1,0,2,3,1,0,1,1,1,3,2,2,1,3,2,2,2,1,2],[3,2,0,2,2,2,3,1,2,2,0,2,2,2,0,2],[3,1,0,1,2,1,0,1,2,1,3,2,2,1,0,1],[1,1,3,2,1,2,0,2,3,2,0,1,3,2],[3,2,1,1,3,2,1,2,0,2,3,2,0,1],[3,1,1,1,3,2,1,2,0,2,3,2,0,1,3,1],[3,2,0,2,3,1,0,1,1,1,3,1,1,2,3,2],[3,1,0,2,3,1,0,1,1,1,3,1,1,2],[0,2,3,1,0,1,1,1,3,1,1,2,3,1],[3,2,0,2,2,2,3,1,2,1,0,1],[0,1,1,2,2,1,0,1,2,2,0,1,1,1],[3,1,1,2,0,1,1,1,0,1,3,2,0,1],[3,1,0,1,1,1,0,1,3,2,0,2,1,2,0,2],[3,1,0,2,3,2,0,1],[1,1,3,1,1,2,3,1,0,2,3,1,0,1],[0,1,1,2,0,2,1,1],[3,1,0,2,2,2,3,2,2,1,3,2,0,1,3,1],[3,2,0,2,3,1,0,1],[0,2,2,1,0,2,2,2,0,2],[3,1,1,1,3,2,1,2,3,1,0,2,3,2,0,1],[3,1,0,2,3,1,2,2,3,1,2,1,0,1],[0,2,3,1,0,1,1,1,3,2,1,2],[3,2,1,1,3,1,2,2,1,1,2,1,1,1],[3,2,1,1,3,1,1,2,3,1,1,1,3,2,1,2],[0,1,1,1,0,1,3,1,0,2,1,2,0,2,3,2],[1,1,3,2,1,2,3,1],[3,1,0,2,3,1,0,1,3,2,1,1,3,1,1,2,3,1],[3,1,0,1,2,1,0,1,2,2,0,1,3,2],[3,1,1,1,3,2,2,1,3,2,2,2,1,2,3,1],[3,1,1,1,3,1,1,2,3,1],[3,2,1,2,0,1,1,1,0,2,3,1],[1,2,2,2,1,2,2,2,3,2,2,2,1,2,3,1],[3,1,1,1,2,1,3,1,2,2,3,1,1,2],[3,2,1,1,3,1,1,2],[1,2,0,1,1,1,0,2],[0,2,3,2,0,1,3,2,1,1,3,2,1,2],[3,2,1,1,2,1,3,1,2,2,3,1,1,2,3,2],[3,1,1,1,2,1,3,2,2,2,1,2],[3,2,0,1,1,2,0,2,1,2,3,1,1,2],[1,2,0,1,2,2,1,2,2,1,1,2,0,2],[3,2,1,2,0,2,1,2,3,1,1,1,0,1,1,1],[3,1,1,1,3,2,1,2],[3,2,0,2,3,1,0,1,3,2,1,1,3,1,1,2],[1,1,2,2,1,1,2,1,1,1],[3,2,1,1,3,2,2,1,3,2,2,2,1,2],[0,2,3,1,0,1,3,2],[3,2,1,2,2,2,1,2,2,1,1,2,3,1],[3,2,1,1,3,2,1,2,3,1,0,2,3,2,0,1,3,2],[3,2,0,2,3,1,2,2,3,1,2,1,0,1,3,2],[1,1,3,2,1,2,0,2,3,1,0,1],[3,1,0,2,3,2,0,1,3,2,0,2,3,1,0,1],[3,1,0,2,3,2,2,1,0,2,2,2,0,2],[1,2,0,2,1,2,3,2,1,1,0,1,1,1,3,1],[3,2,0,2,3,2,0,1,3,2],[0,1,2,1,0,1,2,1,3,1,2,1,0,1,3,2],[3,1,0,1,1,2,0,2,1,1,3,2],[3,2,0,2,2,2,3,2,2,1,3,2,0,1],[3,2,1,1,3,2,1,2,3,2],[0,1,2,1,0,1,2,2,0,1],[0,1,1,1,2,2,1,1,0,1,2,1,0,1,1,1],[1,1,3,2,2,1,3,2,2,2,1,2,3,2],[1,1,3,1,1,2,3,2],[3,1,0,2,2,2,3,2,2,2,0,2,2,2,0,2],[3,1,1,2,0,1,1,1,0,2,3,2],[1,1,2,1,3,1,2,2,3,1,1,2,3,1],[3,1,1,1,3,2,1,1,0,1,1,1,0,2],[3,2,0,1,1,1,0,1,3,1,0,2,1,2,0,2],[3,2,0,2,2,2,3,2,2,1,0,1,3,2],[3,1,1,1,3,2,1,2,3,2,1,1,3,1,1,2],[0,2,3,2,0,1,3,1],[3,2,0,1,1,2,0,2,1,1,3,1],[3,2,1,1,2,1,3,1,2,1,1,1,2,1,1,1],[0,2,2,2,3,2,2,1,3,2,0,1,3,2],[3,1,0,2,3,1,0,1,3,1],[1,2,0,2,2,1,0,2,1,2,2,2,1,2,0,2],[1,2,2,2,1,2,2,1,1,2],[0,2,3,1,2,2,3,1,2,1,0,1,3,1],[3,2,0,2,3,1,0,2,1,2,0,2,1,1],[3,1,1,1,2,1,3,1,2,2,1,2,3,1],[3,1,1,2,0,2,1,2,3,2,1,1,0,1,1,1],[3,2,0,2,3,1,0,1,3,1,0,2,3,2,0,1]];var A=[3,1,0,2,7,5,4,6];seq=D[Math.floor(Math.random()*120)].concat(I[Math.floor(Math.random()*96)]);for(var F=0;F<8;F++){var C=Math.floor(Math.random()*3);if(C>0){seq=seq.concat([A[F],C]);}}this.seq=seq;this.scrambleColor();},scrambleColor:function(){seq=this.seq;for(var A=0;A<seq.length;A+=2){switch(seq[A]){case 0:this.rotate3(14,58,18,seq[A+1]);this.rotate3(15,57,31,seq[A+1]);this.rotate3(16,70,32,seq[A+1]);this.rotate3(30,28,56,seq[A+1]);break;case 1:this.rotate3(32,72,22,seq[A+1]);this.rotate3(33,59,23,seq[A+1]);this.rotate3(20,58,24,seq[A+1]);this.rotate3(34,60,36,seq[A+1]);break;case 2:this.rotate3(14,10,72,seq[A+1]);this.rotate3(1,11,71,seq[A+1]);this.rotate3(2,24,70,seq[A+1]);this.rotate3(0,12,84,seq[A+1]);break;case 3:this.rotate3(2,18,22,seq[A+1]);this.rotate3(3,19,9,seq[A+1]);this.rotate3(16,20,10,seq[A+1]);this.rotate3(4,6,8,seq[A+1]);break;case 4:this.rotate3(30,28,56,seq[A+1]);break;case 5:this.rotate3(34,60,36,seq[A+1]);break;case 6:this.rotate3(0,12,84,seq[A+1]);break;case 7:this.rotate3(4,6,8,seq[A+1]);break;}}},rotate3:function(E,D,C,A){var B;colmap=this.colmap;if(A==2){B=colmap[C];colmap[C]=colmap[D];colmap[D]=colmap[E];colmap[E]=B;}else{B=colmap[E];colmap[E]=colmap[D];colmap[D]=colmap[C];colmap[C]=B;}},scramblestring:function(){seq=this.seq;var B=\"\",A;for(A=0;A<seq.length;A+=2){B+=\"LRBUlrbu\".charAt(seq[A]);if(seq[A+1]==2){B+=\"'\";}B+=\" \";}do{}while(B!=(B=B.replace(/(.) \\1 /g,\"$1' \").replace(/(.)' \\1' /g,\"$1 \").replace(/(.)' \\1 /g,\"\").replace(/(.) \\1' /g,\"\")));return B;},draw_triangle:function(B,A,E){var D=\"\";if(B==1){D+=\"<table border=0 cellpadding=0 cellspacing=0>\";D+=\"<tr><td colspan=12 width=12 height=2 bgcolor=\"+this.colorList[this.colors[A]+2]+\">\"+E+\"</td></tr>\";for(var C=1;C<=5;C++){D+=\"<tr>\";D+=\"<td colspan=\"+C+\" width=\"+C+\" height=2 bgcolor=white></td>\";D+=\"<td colspan=\"+(12-C*2)+\" width=\"+(12-C*2)+\" height=2 bgcolor=\"+this.colorList[this.colors[A]+2]+\"></td>\";D+=\"<td colspan=\"+C+\" width=\"+C+\" height=2 bgcolor=white></td>\";D+=\"</tr>\";}D+=\"</table>\";}else{if(B==2){D+=\"<table border=0 cellpadding=0 cellspacing=0>\";for(var C=5;C>=1;C--){D+=\"<tr>\";D+=\"<td colspan=\"+C+\" width=\"+C+\" height=2 bgcolor=white></td>\";D+=\"<td colspan=\"+(12-C*2)+\" width=\"+(12-C*2)+\" height=2 bgcolor=\"+this.colorList[this.colors[A]+2]+\"></td>\";D+=\"<td colspan=\"+C+\" width=\"+C+\" height=2 bgcolor=white></td>\";D+=\"</tr>\";}D+=\"<tr><td colspan=12 width=12 height=2 bgcolor=\"+this.colorList[this.colors[A]+2]+\">\"+E+\"</td></tr>\";D+=\"</table>\";}else{D+=\"&nbsp;\";}}return D;},imagestring:function(){var A,C;var B=\"<table border=0 cellpadding=0 cellspacing=0>\";for(var C=0;C<7;C++){B+=\"<tr>\";for(var A=0;A<13;A++){B+=\"<td>\";B+=this.draw_triangle(this.layout[C*13+A],this.colmap[C*13+A],\"\");B+=\"</td>\";}B+=\"</tr>\";}B+=\"</table>\";return B;},description:function(){s=\"Algorithm: Uniform Random-State Scramble. \";s+=\"Author: Jaap Scherphuis, Syoji Takamatsu, Lucas Garron and Michael Gottlieb. \";return s;}});";jPlex.src['scrambles/ScrambleFactory.js']="jPlex.provide(\"scrambles.ScrambleFactory\",{});jPlex.extend(\"scrambles.ScrambleFactory\",{_scramblerInstances:[],get:function(A){if(!this._scramblerInstances[A]){this._scramblerInstances[A]=this._createNew(A);}return this._scramblerInstances[A];},_createNew:function(A){var B=null;switch(A){case -1:jPlex.include(\"scrambles.Clock\",true);B=new scrambles.Clock();break;case -2:jPlex.include(\"scrambles.Megaminx\",true);B=new scrambles.Megaminx(10,7);break;case -3:jPlex.include(\"scrambles.Square1\",true);B=new scrambles.Square1(40);break;case -4:jPlex.include(\"scrambles.Pyraminx\",true);B=new scrambles.Pyraminx();break;case 2:jPlex.include(\"scrambles.Pocket\",true);B=new scrambles.Pocket();break;case 3:jPlex.include(\"scrambles.Cube\",true);B=new scrambles.Cube(3,false,25);break;case 4:case 5:case 6:case 7:jPlex.include(\"scrambles.Cube\",true);B=new scrambles.Cube(A,true,A*20-40);break;default:alert(\"Yet to be implemented\");break;}return B;}});";jPlex.src['scrambles/Square1.js']="jPlex.provide(\"scrambles.Square1\",\"scrambles.AbstractScramble\",{initialize:function(A){this.seqlen=A;},scramble:function(){this.posit=new Array(0,0,1,2,2,3,4,4,5,6,6,7,8,9,9,10,11,11,12,13,13,14,15,15);ls=-1;this.seq=new Array();f=0;for(i=0;i<this.seqlen;i++){do{if(ls==0){j=Math.floor(Math.random()*22)-11;if(j>=0){j++;}}else{if(ls==1){j=Math.floor(Math.random()*12)-11;}else{if(ls==2){j=0;}else{j=Math.floor(Math.random()*23)-11;}}}}while((f>1&&j>=-6&&j<0)||this.domove(j));if(j>0){ls=1;}else{if(j<0){ls=2;}else{ls=0;f++;}}this.seq[i]=j;}},domove:function(A){var C,E,B,D=A;posit=this.posit;if(D==0){for(C=0;C<6;C++){E=posit[C+12];posit[C+12]=posit[C+6];posit[C+6]=E;}}else{if(D>0){D=12-D;if(posit[D]==posit[D-1]){return true;}if(D<6&&posit[D+6]==posit[D+5]){return true;}if(D>6&&posit[D-6]==posit[D-7]){return true;}if(D==6&&posit[0]==posit[11]){return true;}B=new Array();for(C=0;C<12;C++){B[C]=posit[C];}E=D;for(C=0;C<12;C++){posit[C]=B[E];if(E==11){E=0;}else{E++;}}}else{if(D<0){D=-D;if(posit[D+12]==posit[D+11]){return true;}if(D<6&&posit[D+18]==posit[D+17]){return true;}if(D>6&&posit[D+6]==posit[D+5]){return true;}if(D==6&&posit[12]==posit[23]){return true;}B=new Array();for(C=0;C<12;C++){B[C]=posit[C+12];}E=D;for(C=0;C<12;C++){posit[C+12]=B[E];if(E==11){E=0;}else{E++;}}}}}return false;},scramblestring:function(){var D=\"\",C,B,A=-1;for(C=0;C<this.seq.length;C++){B=this.seq[C];if(B==0){if(A==-1){D+=\"(0,0)  \";}if(A==1){D+=\"0)  \";}if(A==2){D+=\")  \";}A=0;}else{if(B>0){D+=\"(\"+(B>6?B-12:B)+\",\";A=1;}else{if(B<0){if(A<=0){D+=\"(0,\";}D+=(B<=-6?B+12:B);A=2;}}}}if(A==1){D+=\"0\";}if(A!=0){D+=\")\";}return D+\"<br><br>\";},description:function(){s=\"Algorithm: Random Moves Generator. Parameters: length (\"+this.seqlen+\"). \";s+=\"Author: Jaap Scherphuis. \";return s;}});";</script>
</head>
<body style="font-family:Arial">
<table border="0" width="100%">
    <tr>
        <td id="puzzle" width="50%"><h1>Puzzle : <form method="get" action="#"><select name="type" id="type">
            <option value="2">2x2x2</option>
            <option value="3" selected="selected">3x3x3</option>
            <option value="4">4x4x4</option>
            <option value="5">5x5x5</option>
            <option value="6">6x6x6</option>
            <option value="7">7x7x7</option>
            <option value="-1">Clock</option>
            <option value="-2">Megaminx</option>
            <option value="-3">Square-1</option>
            <option value="-4">Pyraminx</option>
        </select></form></h1></td>
        <td width="50%" align="right">
            <h1>Simple WCA-Approved Scrambler</h1>
        </td>
    </tr><tr><td colspan='2' id="desc" align="center">&nbsp;</td></tr>
</table>
<table id="scrambletab" border=0 cellpadding=0 cellspacing=0 width="100%">
    <tr>
        <td id="scramblestring" style="font-family:courier,serif;"></td>
        <td id="scrambleimage" align="right"></td>
    </tr>
</table>
<script type="text/javascript">
    jPlex.include('jplex.xprototype.*');
    document.bindKey(Event.Key.SPACE, next);
    $('type').observe('change', next);
    $('scrambletab').observe('click', next);

    jPlex.include('scrambles.ScrambleFactory');
    function next() {
        type = parseInt($F('type'));
        //alert(type);
        var scr = ScrambleFactory.get(type);
        $("desc").update(scr.description());
        scr.scramble();
        $('scramblestring').update("<h1>" + scr.scramblestring() + "</h1>");
        $('scrambleimage').update(scr.imagestring());
    }
    next();
</script>

<div style="text-align:center; width:100%; font-size:2em;">Press SPACE bar to re-scramble</div><br/>
<div style="text-align:center; width:100%;">Written by Loic Petit (tls.wydd ~a~ free dot fr)<br/><a href="http://jplex.googlecode.com">Powered by jPlex</a></div>
</body>
</html>